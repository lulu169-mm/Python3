{"ID":"20241017085117-oxs97ch","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f695","id":"20241017085117-oxs97ch","scroll":"\u0026#123;\u0026quot;rootId\u0026quot;:\u0026quot;20241017085117-oxs97ch\u0026quot;,\u0026quot;startId\u0026quot;:\u0026quot;20241017085117-8tu4ksi\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20241017085117-8tu4ksi\u0026quot;,\u0026quot;scrollTop\u0026quot;:0,\u0026quot;focusId\u0026quot;:\u0026quot;20241017085117-8tu4ksi\u0026quot;,\u0026quot;focusStart\u0026quot;:0,\u0026quot;focusEnd\u0026quot;:0\u0026#125;","title":"Linux入侵排查","updated":"20241017200026"},"Children":[{"ID":"20241017091908-mjxfngr","Type":"NodeParagraph","Properties":{"id":"20241017091908-mjxfngr"}},{"ID":"20241017085117-8tu4ksi","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241017085117-8tu4ksi","updated":"20241017091903"},"Children":[{"Type":"NodeText","Data":"1.账号安全"}]},{"ID":"20241017182728-6exgas1","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017182728-6exgas1","updated":"20241017182734"},"Children":[{"Type":"NodeText","Data":"基本使用"}]},{"ID":"20241017091909-3d4mlee","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017091909-3d4mlee","updated":"20241017182452"},"Children":[{"Type":"NodeText","Data":"1)用户信息文件 /etc/passwd"}]},{"ID":"20241017092130-7h7n1pf","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092130-7h7n1pf","updated":"20241017092130"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017092130-fjdsjxf.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017092052-e9gl80h","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092052-e9gl80h","updated":"20241017092124"},"Children":[{"Type":"NodeText","Data":"用户：密码：用户ID：组ID：用户说明：用户家目录：登录shell"}]},{"ID":"20241017092132-nqr7eqh","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092132-nqr7eqh","updated":"20241017182625"},"Children":[{"Type":"NodeText","Data":"PS："},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"密码为空不能远程登录，只能本机登录"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，X是占位符，存在在shadow文件中"}]},{"ID":"20241017092125-c8p78lz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092125-c8p78lz"}},{"ID":"20241017092216-dnj8pkk","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092216-dnj8pkk","updated":"20241017182508"},"Children":[{"Type":"NodeText","Data":"2)/etc/shadow文件"}]},{"ID":"20241017092300-7f4f742","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092300-7f4f742","updated":"20241017092300"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017092300-46u6a92.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017092302-d5myvfz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092302-d5myvfz","updated":"20241017092529"},"Children":[{"Type":"NodeText","Data":"用户名：加密密码：密码最后一次修改日期：两次密码修改的间隔时间：密码有效期：密码到期警告天数：宽限天数：账号失效的时间：预留"}]},{"ID":"20241017092731-gbxxy3u","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092731-gbxxy3u"}},{"ID":"20241017092732-ms4tktf","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092732-ms4tktf","updated":"20241017092740"},"Children":[{"Type":"NodeText","Data":"查看当前登录用户状态"}]},{"ID":"20241017182545-gy98dbr","Type":"NodeBlockquote","Properties":{"fold":"1","heading-fold":"1","id":"20241017182545-gy98dbr","updated":"20241017182607"},"Children":[{"ID":"20241017182546-zakvrhh","Type":"NodeParagraph","Properties":{"id":"20241017182546-zakvrhh","updated":"20241017182607"},"Children":[{"Type":"NodeText","Data":"who 查看当前登录的用户    "},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"pts远程登录    pty本地登录"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241017182546-5l2tyci","Type":"NodeParagraph","Properties":{"id":"20241017182546-5l2tyci","updated":"20241017182546"},"Children":[{"Type":"NodeText","Data":"w 查看系统信息 记录用户登录时间和交互方式"}]},{"ID":"20241017182546-fwniw7m","Type":"NodeParagraph","Properties":{"id":"20241017182546-fwniw7m","updated":"20241017182546"},"Children":[{"Type":"NodeText","Data":"uptime 查看登录多久，有多少用户，系统负载状态"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241017092743-xk8ep7h","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092743-xk8ep7h","updated":"20241017092743"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017092743-nj3grov.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017092931-wn68xli","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092931-wn68xli"}},{"ID":"20241017092935-hesi38x","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092935-hesi38x","updated":"20241017182854"},"Children":[{"Type":"NodeText","Data":"入侵排查"}]},{"ID":"20241017092947-mrqc8fw","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092947-mrqc8fw","updated":"20241017182903"},"Children":[{"Type":"NodeText","Data":"1）是否存在特权用户"}]},{"ID":"20241017093022-d3s4o42","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017093022-d3s4o42","updated":"20241017093234"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"awk -F: '$3==0{print $1}' /etc/passwd    #uid=0--》root\n关注root之外的用户\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017093155-o7gg0uc","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017093155-o7gg0uc","updated":"20241017093155"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017093155-unos5k7.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017092949-ovjxn07","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092949-ovjxn07","updated":"20241017182915"},"Children":[{"Type":"NodeText","Data":"2）是否有远程登录用户"}]},{"ID":"20241017093238-6pomzkb","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017093238-6pomzkb","updated":"20241017093639"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"awk '/\\$1|\\$6/{print $1}' /etc/shadow\n#关注密码字段的存储方式中指定$6的密码字段，$6是指可以远程登录的\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017093559-ich89v7","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017093559-ich89v7","updated":"20241017093559"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017093559-i3pcpky.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017092956-fhyees5","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092956-fhyees5","updated":"20241017183007"},"Children":[{"Type":"NodeText","Data":"3）哪些用户可以访问sudo权限，普通用户非管理需要应删除sudo权限"}]},{"ID":"20241017094044-wtblo8a","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017094044-wtblo8a","updated":"20241017183121"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost ~]# more /etc/sudoers |grep -v \"^#\\|^$\" |grep \"ALL=(ALL)\"\nroot\tALL=(ALL) \tALL\n%wheel\tALL=(ALL)\tALL\n\n#正常情况来说，不能设置wheel组\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017094141-jsp6pn4","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017094141-jsp6pn4","updated":"20241017094141"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017094141-9f6sz3r.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017094225-k649ahr","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017094225-k649ahr"}},{"ID":"20241017093008-p1j31vt","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017093008-p1j31vt","updated":"20241017183035"},"Children":[{"Type":"NodeText","Data":"4）删除或禁用可以账号（注意:发现存在意思用户后，要先去禁用核查，然后在确定是否删除）"}]},{"ID":"20241017094303-awdiw8o","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017094303-awdiw8o","updated":"20241017183333"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"usermod -L username  #禁用username，在用户前添加！\nuserdel username     #仅删除用户\nuserdel -r username\t #删除用户及其家目录\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017183357-ijask18","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017183357-ijask18","updated":"20241017183357"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017183357-y7oyv1d.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017183356-0ciemt4","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017183356-0ciemt4"}},{"ID":"20241017094827-wfhsqoy","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241017094827-wfhsqoy","updated":"20241017183417"},"Children":[{"Type":"NodeText","Data":"2.历史命令"}]},{"ID":"20241017184423-1dlzzb1","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017184423-1dlzzb1","updated":"20241017184456"},"Children":[{"Type":"NodeText","Data":".bash history的文件记录着这个用户都执行过什么命令;主要分析"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"是否有账户执行过恶意操作"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241017183435-e3lyjdf","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017183435-e3lyjdf","updated":"20241017183437"},"Children":[{"Type":"NodeText","Data":"基本使用"}]},{"ID":"20241017094846-t68ahr2","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017094846-t68ahr2","updated":"20241017183446"},"Children":[{"Type":"NodeText","Data":"1）root用户的历史命令 /root/.bash_history"}]},{"ID":"20241017094830-tj75c5i","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017094830-tj75c5i","updated":"20241017094906"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"history 查看\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017094628-9yj7cxr","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017094628-9yj7cxr","updated":"20241017183817"},"Children":[{"Type":"NodeText","Data":"2）普通用户的历史命令，存在普通用户的/home目录下的.bash_history"}]},{"ID":"20241017095916-7cmnipo","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017095916-7cmnipo","updated":"20241017100103"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"history 普通用户权限查看\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017095903-i39l8h3","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017095903-i39l8h3","updated":"20241017183826"},"Children":[{"Type":"NodeText","Data":"2.1）给history配置记录多少条命令"}]},{"ID":"20241017100130-qbll2y8","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017100130-qbll2y8","updated":"20241017100132"},"Children":[{"Type":"NodeText","Data":"法一："}]},{"ID":"20241017100133-njdqfmg","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017100133-njdqfmg","updated":"20241017184313"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"\n[root@localhost ~]# sed -i 's/^HISTSIZE=1000/HISTSIZE=10000/g' /etc/profile\n[root@localhost ~]# cat /etc/profile |grep HISTSIZE\nHISTSIZE=10000\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017184948-5vowqts","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017184948-5vowqts","updated":"20241017184948"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017184948-7om095h.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017100111-newymon","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017100111-newymon","updated":"20241017184345"},"Children":[{"Type":"NodeText","Data":"法二：将以下内容加入/etc/profile即可"}]},{"ID":"20241017184327-kjmw307","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017184327-kjmw307","updated":"20241017184518"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"USER_IP=`who -u am i 2\u003e/dev/null | awk '{print $NF}' | sed -e 's/[()]//g'`\nif [ \"$USER_IP\" = \"\" ]\nthen\nUSER_IP=`hostname`\nfi\nexport HISTTIMEFORMAT=\"%F %T $USER_IP `whoami` \"\nshopt -s histappend\nexport PROMPT_COMMAND=\"history -a\"\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017101719-kqwnbg9","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017101719-kqwnbg9"}},{"ID":"20241017185133-r18pt41","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017185133-r18pt41","updated":"20241017185133"},"Children":[{"Type":"NodeText","Data":"入侵排查"}]},{"ID":"20241017185133-1g2ulqe","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017185133-1g2ulqe","updated":"20241017185133"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"将命令记录文件导出之后分析，导出方法如下："}]},{"ID":"20241017185122-390v5kc","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017185122-390v5kc","updated":"20241017185146"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"1、进入用户目录\ncat .bash_history \u003e\u003e history.txt \n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017185122-xs3ekl6","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241017185122-xs3ekl6","updated":"20241017185200"},"Children":[{"Type":"NodeText","Data":"3.异常端口"}]},{"ID":"20241017185211-3iesfes","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017185211-3iesfes","updated":"20241017185241"},"Children":[{"Type":"NodeText","Data":"查看端口装填，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"分析可疑"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"的端口和IP以及"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"PID追朔"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"其运行文件源头"}]},{"ID":"20241017190737-ah6mj5f","Type":"NodeList","ListData":{},"Properties":{"fold":"1","heading-fold":"1","id":"20241017190737-ah6mj5f","updated":"20241017190744"},"Children":[{"ID":"20241017190737-a89p71c","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241017190737-a89p71c","updated":"20241017190741"},"Children":[{"ID":"20241017190712-3qkzhsh","Type":"NodeParagraph","Properties":{"id":"20241017190712-3qkzhsh","updated":"20241017190741"},"Children":[{"Type":"NodeText","Data":"netstat 网络连接命令  查看服务器"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"是否有未被授权的端口被监听"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]}]},{"ID":"20241017190737-cmk9heh","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241017190737-cmk9heh","updated":"20241017190744"},"Children":[{"ID":"20241017190731-1n39xvk","Type":"NodeParagraph","Properties":{"id":"20241017190731-1n39xvk","updated":"20241017190744"},"Children":[{"Type":"NodeText","Data":"检查服务器"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"是否存在恶意进程"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，恶意进程往往会开启监听端口，与外部控制机器进行连接"}]}]}]},{"ID":"20241017101720-v88nq5j","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017101720-v88nq5j","updated":"20241017191411"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"netstat -antlp            #查看进程ID和端口状态\nls -l /proc/\u003cPID\u003e/exe\t  #定位其运行的文件路径\nfile /proc/\u003cPID\u003e/exe    \n\n判断文件路径是否是软链或bash文件\n根据获取的路径查看，如下图ls -al /user/bin/ |grep mongod\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017185743-g6xrpg9","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017185743-g6xrpg9","updated":"20241017185743"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017185743-fuuxez7.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017185741-g2iarcf","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017185741-g2iarcf"}},{"ID":"20241017185741-f1scmt3","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241017185741-f1scmt3","updated":"20241017185824"},"Children":[{"Type":"NodeText","Data":"4.检查进程"}]},{"ID":"20241017191426-qfh92s3","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017191426-qfh92s3","updated":"20241017191511"},"Children":[{"Type":"NodeText","Data":"如果发现有"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"名称不断变化"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"的"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"非授权"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"进程占用"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"大量系统CPU"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"或"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"内存资源"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"时，则可能为恶意程序\n确认该进程为恶意进程后，可以使用 "},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"kill -g 进程名"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":" 命令结束，或使用"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"防火墙"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"限制进程外联"}]},{"ID":"20241017185741-nejxym7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017185741-nejxym7","updated":"20241017185844"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"netstat -antlp  #获取进程ID\nps -aux | grep 《PID》\t#获取当前可疑进程使用的启动命令，可以定位路径\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017190507-mquwf02","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017190507-mquwf02","updated":"20241017190507"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017190507-pp9ts7i.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017185742-m4nrcjs","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017185742-m4nrcjs"}},{"ID":"20241017101720-unkj8m6","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241017101720-unkj8m6","updated":"20241017191012"},"Children":[{"Type":"NodeText","Data":"5.开机启动项目"}]},{"ID":"20241017101840-dkt1ghh","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017101840-dkt1ghh","updated":"20241017101846"},"Children":[{"Type":"NodeText","Data":"基本姿势："}]},{"ID":"20241017101848-epswqx7","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017101848-epswqx7","updated":"20241017101852"},"Children":[{"Type":"NodeText","Data":"运行级别runlevel"}]},{"ID":"20241017101911-goo4uer","Type":"NodeTable","TableAligns":[0,0],"Properties":{"colgroup":"min-width: 60px;|min-width: 60px;","fold":"1","heading-fold":"1","id":"20241017101911-goo4uer","updated":"20241017102047"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"级别"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"定义"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"0"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"关机"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"1"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"单用户模式，相当与Windows安全模式"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"2"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"不完全的命令行模式，没有NFS"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"3"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"完全的命令行模式"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"4"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"系统保留"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"5"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"图形化"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"6"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"重启"}]}]}]},{"ID":"20241017102212-j2i95kt","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017102212-j2i95kt"}},{"ID":"20241017102213-kb0l8b4","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017102213-kb0l8b4","updated":"20241017191147"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"默认配置级别文件   /etc/inittab"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241017102221-txr169x","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017102221-txr169x","updated":"20241017191114"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost ~]# cat /etc/inittab\n# inittab is no longer used when using systemd.\n#\n# ADDING CONFIGURATION HERE WILL HAVE NO EFFECT ON YOUR SYSTEM.\n#\n# Ctrl-Alt-Delete is handled by /usr/lib/systemd/system/ctrl-alt-del.target\n#\n# systemd uses 'targets' instead of runlevels. By default, there are two main targets:\n#\n# multi-user.target: analogous to runlevel 3\n# graphical.target: analogous to runlevel 5\n#\n# To view current default target, run:\n# systemctl get-default\n#\n# To set a default target, run:\n# systemctl set-default TARGET.target\n#\n[root@localhost ~]# more /etc/rc.local\n#!/bin/bash\n# THIS FILE IS ADDED FOR COMPATIBILITY PURPOSES\n#\n# It is highly advisable to create own systemd services or udev rules\n# to run scripts during boot instead of using this file.\n#\n# In contrast to previous versions due to parallel execution during boot\n# this script will NOT be run after all other services.\n#\n# Please note that you must run 'chmod +x /etc/rc.d/rc.local' to ensure\n# that this script will be executed during boot.\n\ntouch /var/lock/subsys/local"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017102255-abgxykd","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017102255-abgxykd"}},{"ID":"20241017102259-kjthgd7","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017102259-kjthgd7","updated":"20241017191205"},"Children":[{"Type":"NodeText","Data":"开启自启动配置文件"}]},{"ID":"20241017191230-bwfca0q","Type":"NodeBlockquote","Properties":{"fold":"1","heading-fold":"1","id":"20241017191230-bwfca0q","updated":"20241017191241"},"Children":[{"ID":"20241017112507-14ptx5m","Type":"NodeParagraph","Properties":{"id":"20241017112507-14ptx5m","updated":"20241017191241"},"Children":[{"Type":"NodeText","Data":"默认位置："},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"/etc/rc.d"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"\t#0-6共计7个级别的启动文件，完全命令行默认在rc3.d文件内\n创建自启动文件方式：\n"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"ln -s /etc/init.d/tomcat /etc/rc.d/rc3.d/s100tomcat"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"\t#创建软链自启动tomcat\ns：自启动\nK：代表启动加载时会关闭"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241017191723-h45t736","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017191723-h45t736","updated":"20241017191723"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017191723-lgnv52x.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017112507-4lirx6u","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017112507-4lirx6u"}},{"ID":"20241017112619-2hhnxsl","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017112619-2hhnxsl","updated":"20241017191800"},"Children":[{"Type":"NodeText","Data":"入侵排查"}]},{"ID":"20241017192034-swn5szz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017192034-swn5szz","updated":"20241017192205"},"Children":[{"Type":"NodeText","Data":"使用chkconfig --list（systemctl list-unit-files）和ls -alt /etc/init.d/ 命令查看开机启动项中是否有异常的启动服务"}]},{"ID":"20241017192140-wt5p5uz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017192140-wt5p5uz","updated":"20241017192141"},"Children":[{"Type":"NodeText","Data":"恶意程序往往会添加在系统的启动项，在用户关机重启后再次运行\n如果发现有恶意进程，可使用 chkconfig 服务名 off 命令关闭(CentOs7下为: systemctl disable postfix.service)"}]},{"ID":"20241017192120-lxh0i33","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017192120-lxh0i33","updated":"20241017192120"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017192120-cvrvu2y.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017192034-jzlgeeq","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017192034-jzlgeeq"}},{"ID":"20241017191818-zgd5g8l","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017191818-zgd5g8l","updated":"20241017191825"},"Children":[{"Type":"NodeText","Data":"启动文件"}]},{"ID":"20241017191830-d3nbu1l","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017191830-d3nbu1l","updated":"20241017191840"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"more /etc/rc.local\nls -al /etc/rc.d/rc[0,1,2,3,4,5,6].d\n\n#需要关注恶意的启动脚本或敏感路径\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017192309-xeibfdz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017192309-xeibfdz","updated":"20241017192309"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017192309-wq00xst.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017112620-r1vjiks","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017112620-r1vjiks"}},{"ID":"20241017112620-30go40u","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241017112620-30go40u","updated":"20241017192344"},"Children":[{"Type":"NodeText","Data":"6.计划任务-定时启动"}]},{"ID":"20241017192659-gf2r8uf","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241017192659-gf2r8uf","updated":"20241017192704"},"Children":[{"Type":"NodeText","Data":"基本使用"}]},{"ID":"20241017192347-gni2ho5","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241017192347-gni2ho5","updated":"20241017192402"},"Children":[{"Type":"NodeText","Data":"1）查看方式"}]},{"ID":"20241017192405-bfxuodt","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017192405-bfxuodt","updated":"20241017192419"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"crontab -l\t#查看当前用户的计划任务\ncrontab -u username -l #查看指定的username用户的计划任务\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017192417-p1nd75m","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241017192417-p1nd75m","updated":"20241017192429"},"Children":[{"Type":"NodeText","Data":"2）怎么创建"}]},{"ID":"20241017192432-dl4tpve","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017192432-dl4tpve","updated":"20241017192439"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"crontab -e -u root\t#给root用户创建\n* * * * * echo \"hello\" \u003e\u003e /tmp/1.txt\t#每分钟将hello输出在/tmp/1.txt\n[root@localhost cron]# crontab -l -u root\n* * * * * echo \"hello\" \u003e\u003e /tmp/1.txt\n[root@localhost cron]# cat /tmp/1.txt \nhello\nhello\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017192432-oqudp0a","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241017192432-oqudp0a","updated":"20241017192518"},"Children":[{"Type":"NodeText","Data":"3）删除计划任务"}]},{"ID":"20241017112522-nfhyyse","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017112522-nfhyyse","updated":"20241017192529"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost cron]# crontab -r -u root\t#会删除所有计划任务，谨慎使用\n[root@localhost cron]# crontab -l\nno crontab for root\n[root@localhost cron]# "},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017112601-o8v28k3","Type":"NodeParagraph","Properties":{"id":"20241017112601-o8v28k3"}},{"ID":"20241017192716-m49mbnk","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241017192716-m49mbnk","updated":"20241017192719"},"Children":[{"Type":"NodeText","Data":"入侵排查"}]},{"ID":"20241017192712-hwhe8tx","Type":"NodeParagraph","Properties":{"id":"20241017192712-hwhe8tx","updated":"20241017192732"},"Children":[{"Type":"NodeText","Data":"重点关注是否在以下目录中"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"存在恶意脚本"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241017192811-1bdpdop","Type":"NodeBlockquote","Properties":{"id":"20241017192811-1bdpdop","updated":"20241017192812"},"Children":[{"ID":"20241017112910-m8ofcif","Type":"NodeParagraph","Properties":{"id":"20241017112910-m8ofcif","updated":"20241017192812"},"Children":[{"Type":"NodeText","Data":"进入 cron 文件目录，查看是否存在非法定时任务脚本\n注意查看:/etc/crontab /etc/cron.d /etc/cron.daily cron.hourly/ cron.monthly cron.weekly\n如果发现有不认识的计划任务，可以定位脚本确认是否是正常业务脚本\n如果是非正常业务脚本，直接注释掉任务内容或删除脚本"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241017113150-lwjfmhw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017113150-lwjfmhw","updated":"20241017193046"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost cron]# ls /var/spool/cron/\t#关注用户的计划任务\n[root@localhost cron]# more /etc/crontab\t#命令内写入的计划任务\nSHELL=/bin/bash\nPATH=/sbin:/bin:/usr/sbin:/usr/bin\nMAILTO=root\n\n# For details see man 4 crontabs\n\n# Example of job definition:\n# .---------------- minute (0 - 59)\n# |  .------------- hour (0 - 23)\n# |  |  .---------- day of month (1 - 31)\n# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...\n# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat\n# |  |  |  |  |\n# *  *  *  *  * user-name  command to be executed\n\n\n[root@localhost cron]# ls -al /etc/cron.d/\t#计划任务目录\ntotal 16\ndrwxr-xr-x.  2 root root   21 Jun 12  2021 .\ndrwxr-xr-x. 77 root root 8192 Oct 14 23:32 ..\n-rw-r--r--.  1 root root  128 Aug  9  2019 0hourly\n[root@localhost cron]# ls -al /etc/cron.daily/\t\t#每天的计划任务列表目录\ntotal 20\ndrwxr-xr-x.  2 root root   42 Jun 12  2021 .\ndrwxr-xr-x. 77 root root 8192 Oct 14 23:32 ..\n-rwx------.  1 root root  219 Apr  1  2020 logrotate\n-rwxr-xr-x.  1 root root  618 Oct 30  2018 man-db.cron\n[root@localhost cron]# ls -al /etc/cron.hourly/\t\t#每个小时的计划任务列表目录\ntotal 16\ndrwxr-xr-x.  2 root root   22 Jun 10  2014 .\ndrwxr-xr-x. 77 root root 8192 Oct 14 23:32 ..\n-rwxr-xr-x.  1 root root  392 Aug  9  2019 0anacron\n[root@localhost cron]# ls -al /etc/cron.monthly/\t#每个月\ntotal 12\ndrwxr-xr-x.  2 root root    6 Jun 10  2014 .\ndrwxr-xr-x. 77 root root 8192 Oct 14 23:32 ..\n[root@localhost cron]# ls -al /etc/cron.weekly/\t#每周\ntotal 12\ndrwxr-xr-x.  2 root root    6 Jun 10  2014 .\ndrwxr-xr-x. 77 root root 8192 Oct 14 23:32 ..\n[root@localhost cron]# ls -al /etc/anacrontab \t#计划任务列表\n-rw-------. 1 root root 541 Aug  9  2019 /etc/anacrontab\t\t#计划任务列表\n[root@localhost cron]# ls -al /etc/spool/anacron/ \nls: cannot access /etc/spool/anacron/: No such file or directory\n[root@localhost cron]# \n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193056-1y23w52","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241017193056-1y23w52","updated":"20241017200023"},"Children":[{"Type":"NodeText","Data":"7 .检查服务"}]},{"ID":"20241017193056-k2o366z","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017193056-k2o366z","updated":"20241017193115"},"Children":[{"Type":"NodeText","Data":"​服务自启动​"}]},{"ID":"20241017193056-rytbg6e","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193056-rytbg6e","updated":"20241017193117"},"Children":[{"Type":"NodeText","Data":"默认的以下服务的配置文件："}]},{"ID":"20241017193056-s5g5l2g","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017193056-s5g5l2g","updated":"20241017193157"},"Children":[{"Type":"NodeText","Data":"网卡的配置文件：/etc/sysconfig/network-scripts/ifcfg-eth0​​"}]},{"ID":"20241017193054-hskpznr","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193054-hskpznr","updated":"20241017193127"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost network-scripts]# pwd\n/etc/sysconfig/network-scripts/ifcfg-eth0\t\t#eth0网卡配置\n\n\n[root@localhost network-scripts]# more ./ifcfg-eth0 \nTYPE=Ethernet\nPROXY_METHOD=none\nBROWSER_ONLY=no\nBOOTPROTO=static\t\t#或者是dhcp\nDEFROUTE=yes\nIPV4_FAILURE_FATAL=no\nIPV6INIT=yes\nIPV6_AUTOCONF=yes\nIPV6_DEFROUTE=yes\nIPV6_FAILURE_FATAL=no\nIPV6_ADDR_GEN_MODE=stable-privacy\nNAME=eth0\nUUID=bc62cee8-5ab3-43fc-aa8e-381dac793a3b\nDEVICE=eth0\nONBOOT=yes\nIPADDR=172.16.12.2\nNETMASK=255.255.255.0\nGETWAY=172.16.12.1\nDNS1=114.114.114.114\nDNS2=8.8.8.8\nPREFIX=24\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193055-zbj0e84","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017193055-zbj0e84"}},{"ID":"20241017193132-eahw2pv","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017193132-eahw2pv","updated":"20241017193147"},"Children":[{"Type":"NodeText","Data":"DNS配置文件路径/etc/resolv.conf"}]},{"ID":"20241017193138-4yvyj35","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193138-4yvyj35","updated":"20241017193142"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost network-scripts]# more /etc/resolv.conf \n#Generated by NetworkManager\nnameserver 114.114.114.114\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193206-par7q5e","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193206-par7q5e","updated":"20241017193211"},"Children":[{"Type":"NodeText","Data":"修改自启动"}]},{"ID":"20241017193212-ql2adj4","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017193212-ql2adj4"},"Children":[{"Type":"NodeText","Data":"方法1："}]},{"ID":"20241017193130-sy5561j","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193130-sy5561j","updated":"20241017193214"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost network-scripts]# chkconfig --level 2345 httpd.service on\t#指定级别，默认2345\nNote: Forwarding request to 'systemctl enable httpd.service'.\n\nchkconfig  httpd on#其他写法，不指定级别\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193130-u24pqfb","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017193130-u24pqfb","updated":"20241017193221"},"Children":[{"Type":"NodeText","Data":"法2"}]},{"ID":"20241017193222-xoxkkez","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193222-xoxkkez","updated":"20241017193226"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"修改：/etc/rc.d/rc.local\n添加服务启动：\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193130-5fquihs","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017193130-5fquihs","updated":"20241017193232"},"Children":[{"Type":"NodeText","Data":"其他"}]},{"ID":"20241017193233-43za5us","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193233-43za5us","updated":"20241017193237"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost network-scripts]# ntsysv\n-bash: ntsysv: command not fou\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193230-h60nji5","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017193230-h60nji5"}},{"ID":"20241017193253-lyowm22","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193253-lyowm22","updated":"20241017193256"},"Children":[{"Type":"NodeText","Data":"入侵排查"}]},{"ID":"20241017193230-2f64z9x","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193230-2f64z9x","updated":"20241017193325"},"Children":[{"Type":"NodeText","Data":"1）查看安装​了哪些服务：chkconfig --list|grep \"3:on|5:on\""}]},{"ID":"20241017193230-7msfkkw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193230-7msfkkw","updated":"20241017193338"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost network-scripts]# chkconfig --list\t#查看所有服务，不管是否启动\n\nNote: This output shows SysV services only and does not include native\n      systemd services. SysV configuration data might be overridden by native\n      systemd configuration.\n\n      If you want to list systemd services use 'systemctl list-unit-files'.\n      To see services enabled on particular target use\n      'systemctl list-dependencies [target]'.\n\nnetconsole     \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:off\nnetwork        \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:off\ntomcat         \t0:off\t1:on\t2:on\t3:on\t4:on\t5:on\t6:off\n\n[root@localhost network-scripts]# chkconfig --list|grep \"3:on\\|5:on\"\t#查看命令行和图形化两个级别下启动的终端里的自启动服务\n\nNote: This output shows SysV services only and does not include native\n      systemd services. SysV configuration data might be overridden by native\n      systemd configuration.\n\n      If you want to list systemd services use 'systemctl list-unit-files'.\n      To see services enabled on particular target use\n      'systemctl list-dependencies [target]'.\n\nnetwork        \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:off\ntomcat         \t0:off\t1:on\t2:on\t3:on\t4:on\t5:on\t6:off\n[root@localhost network-scripts]# chkconfig --list|grep \"3:启动\\|5:启动\"\t#或者中文标识的\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193332-1tipfyf","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017193332-1tipfyf"}},{"ID":"20241017193332-d0bib1t","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017193332-d0bib1t","updated":"20241017193351"},"Children":[{"Type":"NodeText","Data":"配合ps -aux |grep tomcat#去查看tomcat启动服务的命令和路径文件(如果是恶意启动，也能查到)"}]},{"ID":"20241017193332-jhiavqs","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193332-jhiavqs","updated":"20241017193357"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost network-scripts]# ps -aux |grep tomcat\nroot        994  0.3 10.4 3765176 194992 ?      Sl   Oct14   3:37 /usr/local/java/jdk-11/bin/java -Djava.util.logging.config.file=/usr/local/tomcat9/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -server -XX:PermSize=256M -XX:MaxPermSize=1024m -Xms512M -Xmx1024M -XX:MaxNewSize=256m -Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK=0027 -Dignore.endorsed.dirs= -classpath /usr/local/tomcat9/bin/bootstrap.jar:/usr/local/tomcat9/bin/tomcat-juli.jar -Dcatalina.base=/usr/local/tomcat9 -Dcatalina.home=/usr/local/tomcat9 -Djava.io.tmpdir=/usr/local/tomcat9/temp org.apache.catalina.startup.Bootstrap start\nroot      65054  0.0  0.0 112808   968 pts/2    R+   01:18   0:00 grep --color=auto tomcat\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193332-3bugu8i","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193332-3bugu8i","updated":"20241017193413"},"Children":[{"Type":"NodeText","Data":"2)查看服务安装位置文件中的启动文件是否存在/etc/rc.d/init.d/"}]},{"ID":"20241017193416-8jas9e7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193416-8jas9e7","updated":"20241017193423"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost network-scripts]# cd /etc/rc.d/init.d/\n[root@localhost init.d]# ls\nfunctions  netconsole  network  README  tomcat\n[root@localhost init.d]# \n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193416-seogf76","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017193416-seogf76"}},{"ID":"20241017193416-sg50ruh","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241017193416-sg50ruh","updated":"20241017193438"},"Children":[{"Type":"NodeText","Data":"8.异常启动文件"}]},{"ID":"20241017193454-r57tv7x","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017193454-r57tv7x","updated":"20241017193507"},"Children":[{"Type":"NodeText","Data":"1）敏感目录：/tmp     ..  （隐藏文件夹）"}]},{"ID":"20241017193454-ozrczec","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017193454-ozrczec","updated":"20241017193508"},"Children":[{"Type":"NodeText","Data":"2）webshell    ---web目录  关注文件时间"}]},{"ID":"20241017193454-3kmva38","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193454-3kmva38","updated":"20241017193454"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"atime       最后一次访问时间\nctime       最后一次改变文件的时间（目录、权限、属性）\nmtime       最后一次修改的时间\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193454-sybkdbp","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017193454-sybkdbp","updated":"20241017193513"},"Children":[{"Type":"NodeText","Data":"查看以上3种时间的方法：stat filename"}]},{"ID":"20241017193454-h2p96vy","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193454-h2p96vy","updated":"20241017193454"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"[root@localhost tmp]# stat 1.txt \n  File: ‘1.txt’\n  Size: 198         Blocks: 8          IO Block: 4096   regular file\nDevice: fd00h/64768d    Inode: 2645950     Links: 1\nAccess: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)\nAccess: 2024-10-15 01:00:07.825891237 +0800\nModify: 2024-10-15 01:00:01.298891539 +0800\nChange: 2024-10-15 01:00:01.298891539 +0800\n Birth: -\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193454-grwvtuu","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017193454-grwvtuu","updated":"20241017193518"},"Children":[{"Type":"NodeText","Data":"查看前一天访问的文件方法："}]},{"ID":"20241017193454-j9augvq","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017193454-j9augvq","updated":"20241017193454"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":" find /tmp -iname \"*\" -atime 1 -type f\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193454-4o9y21f","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241017193454-4o9y21f","updated":"20241017200026"},"Children":[{"Type":"NodeText","Data":"9.日志文件"}]},{"ID":"20241017193454-jriql66","Type":"NodeParagraph","Properties":{"id":"20241017193454-jriql66","updated":"20241017193454"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"默认存放路径：/var/log/"}]},{"ID":"20241017193454-3m5cq4r","Type":"NodeParagraph","Properties":{"id":"20241017193454-3m5cq4r","updated":"20241017193454"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"日志设置的配置文件：/etc/rsyslog.conf"}]},{"ID":"20241017193454-rynqh2c","Type":"NodeParagraph","Properties":{"id":"20241017193454-rynqh2c","updated":"20241017193454"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"详细部分见《linux日志审计部分》"}]},{"ID":"20241017193332-hnzgm0o","Type":"NodeParagraph","Properties":{"id":"20241017193332-hnzgm0o"}},{"ID":"20241017144415-n4lc5a9","Type":"NodeParagraph","Properties":{"id":"20241017144415-n4lc5a9","updated":"20241017144415"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017144414-84r52iu.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017150303-ztnvy32","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20241017150303-ztnvy32","updated":"20241017150313"},"Children":[{"Type":"NodeText","Data":"常用工具"}]},{"ID":"20241017150317-paeff5n","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241017150317-paeff5n"},"Children":[{"Type":"NodeText","Data":"rootkit查杀"}]},{"ID":"20241017150322-bko24t8","Type":"NodeParagraph","Properties":{"id":"20241017150322-bko24t8"},"Children":[{"Type":"NodeText","Data":"rootkit是特殊恶意文件，功能是隐藏自身或者进程，文件，网络链接。。。。rootkit一般和木马后门联合使用"}]},{"ID":"20241017150334-88qg0wd","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241017150334-88qg0wd","updated":"20241017150351"},"Children":[{"Type":"NodeText","Data":"两种类型:"}]},{"ID":"20241017150353-a8ftbaf","Type":"NodeParagraph","Properties":{"id":"20241017150353-a8ftbaf"},"Children":[{"Type":"NodeText","Data":"文件级别的修改重要文件，隐藏在文件内。如:ipconfig find ls pa login等"}]},{"ID":"20241017150355-mnsyd1n","Type":"NodeParagraph","Properties":{"id":"20241017150355-mnsyd1n","updated":"20241017150358"},"Children":[{"Type":"NodeText","Data":"内核级别的修改系统的内同"}]},{"ID":"20241017150409-ug7wqf0","Type":"NodeParagraph","Properties":{"id":"20241017150409-ug7wqf0"}},{"ID":"20241017150410-i9a9k44","Type":"NodeParagraph","Properties":{"id":"20241017150410-i9a9k44"}},{"ID":"20241017150410-kb8ok2u","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241017150410-kb8ok2u","updated":"20241017150512"},"Children":[{"Type":"NodeText","Data":"chkrookit"}]},{"ID":"20241017152932-uo2po5y","Type":"NodeParagraph","Properties":{"id":"20241017152932-uo2po5y","updated":"20241017152935"},"Children":[{"Type":"NodeText","Data":"下载"}]},{"ID":"20241017152936-lsmyl09","Type":"NodeParagraph","Properties":{"id":"20241017152936-lsmyl09","updated":"20241017152948"},"Children":[{"Type":"NodeText","Data":"https://www.chkrootkit.org/download"}]},{"ID":"20241017152950-clpcfsh","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017152950-clpcfsh","updated":"20241017153010"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"下载命令:wget ftp://ftp.chkrootkit.org/pub/seg/pac/chkrootkit.tar.gz\ntar -zxvf chkrootkit.tar.gz\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017153236-wwnzww4","Type":"NodeParagraph","Properties":{"id":"20241017153236-wwnzww4","updated":"20241017153236"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017153236-c4pliao.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017153237-gl0cahf","Type":"NodeParagraph","Properties":{"id":"20241017153237-gl0cahf","updated":"20241017153247"},"Children":[{"Type":"NodeText","Data":"2.rkhunter"}]},{"ID":"20241017153247-nhzfz1u","Type":"NodeParagraph","Properties":{"id":"20241017153247-nhzfz1u","updated":"20241017153257"},"Children":[{"Type":"NodeText","Data":"https://sourceforge.net/projects/rkhunter/files/rkhunter/1.4.6/"}]},{"ID":"20241017153611-9w5n56h","Type":"NodeParagraph","Properties":{"id":"20241017153611-9w5n56h","updated":"20241017153611"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017153611-0sb861o.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017154004-0vhih8i","Type":"NodeParagraph","Properties":{"id":"20241017154004-0vhih8i"}},{"ID":"20241017160734-a949emw","Type":"NodeParagraph","Properties":{"id":"20241017160734-a949emw"}},{"ID":"20241017160734-esnvwlt","Type":"NodeParagraph","Properties":{"id":"20241017160734-esnvwlt","updated":"20241017160737"},"Children":[{"Type":"NodeText","Data":"安全脚本"}]},{"ID":"20241017160847-gxer28o","Type":"NodeParagraph","Properties":{"id":"20241017160847-gxer28o","updated":"20241017160852"},"Children":[{"Type":"NodeText","Data":"CheckList"}]},{"ID":"20241017193536-j5fxrnh","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241017193536-j5fxrnh","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"1、rootkit查杀"}]},{"ID":"20241017193536-by1p38l","Type":"NodeParagraph","Properties":{"id":"20241017193536-by1p38l","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**\t"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"rootkit是特殊恶意文件，功能是隐藏自身或者进程，文件，网络链接。。。。rootkit一般和木马后门联合使用"},{"Type":"NodeText","Data":"\t**"}]},{"ID":"20241017193536-kxld0pp","Type":"NodeParagraph","Properties":{"id":"20241017193536-kxld0pp","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**\t\t**两种类型："}]},{"ID":"20241017193536-rzvvsqf","Type":"NodeParagraph","Properties":{"id":"20241017193536-rzvvsqf","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**\t\t\t**1、文件级别的"}]},{"ID":"20241017193536-8siryj4","Type":"NodeParagraph","Properties":{"id":"20241017193536-8siryj4","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**\t\t\t\t\t\t**修改重要文件，隐藏在文件内。如：ipconfig  find  ls pa  login等"}]},{"ID":"20241017193536-dol5t1l","Type":"NodeParagraph","Properties":{"id":"20241017193536-dol5t1l","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**\t\t\t**2、内核级别的"}]},{"ID":"20241017193536-7obqi8a","Type":"NodeParagraph","Properties":{"id":"20241017193536-7obqi8a","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**\t\t\t\t\t\t**修改系统的内核，主要依附在系统内核上，不对系统文件进行修改。"}]},{"ID":"20241017193536-dmtv110","Type":"NodeParagraph","Properties":{"id":"20241017193536-dmtv110","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**1.1 chkrookit  **"}]},{"ID":"20241017193536-xcg1j7n","Type":"NodeParagraph","Properties":{"id":"20241017193536-xcg1j7n","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**\t**下载："},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://www.chkrootkit.org/download/","TextMarkTextContent":"https://www.chkrootkit.org/download/"}]},{"ID":"20241017193536-6nsio8n","Type":"NodeParagraph","Properties":{"id":"20241017193536-6nsio8n","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"下载命令：wget ftp://ftp.chkrootkit.org/pub/seg/pac/chkrootkit.tar.gz"}]},{"ID":"20241017193536-5bxynpa","Type":"NodeParagraph","Properties":{"id":"20241017193536-5bxynpa","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"tar -zxvf chkrootkit.tar.gz"}]},{"ID":"20241017193536-mrgqth9","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193536-mrgqth9","updated":"20241017193536"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"cd chkrootkit-0.58b/\n[root@localhost chkrootkit-0.58b]# ls\nACKNOWLEDGMENTS  check_wtmpx.c  chkdirs.c  chklastlog.c  chkproc.c  chkrootkit  chkrootkit.lsm  chkutmp.c  chkwtmp.c  COPYRIGHT  ifpromisc.c  Makefile  README  README.chklastlog  README.chkwtmp  strings.c\n[root@localhost chkrootkit-0.58b]# ./chkrootkit \n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193536-z48bgqw","Type":"NodeParagraph","Properties":{"id":"20241017193536-z48bgqw","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"1.2 rkhunter"}]},{"ID":"20241017193536-vsn71ug","Type":"NodeParagraph","Properties":{"id":"20241017193536-vsn71ug","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"下载地址："}]},{"ID":"20241017193536-p9gdv38","Type":"NodeParagraph","Properties":{"id":"20241017193536-p9gdv38","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://sourceforge.net/projects/rkhunter/files/rkhunter/1.4.6/","TextMarkTextContent":"https://sourceforge.net/projects/rkhunter/files/rkhunter/1.4.6/"}]},{"ID":"20241017193536-lqy5una","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193536-lqy5una","updated":"20241017193536"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"wget https://sourceforge.net/projects/rkhunter/files/rkhunter/1.4.6/rkhunter-1.4.6.tar.gz\ntar -zxvf \u003c名称\u003e\nCd 目录\n./rkhunter-1.4.6\n./installer.sh --install\n使用：\nrkhunter -c\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193536-5xk4nfv","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241017193536-5xk4nfv","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"2 病毒查杀"}]},{"ID":"20241017193536-7gzffe6","Type":"NodeParagraph","Properties":{"id":"20241017193536-7gzffe6","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**2.1 clamav **"}]},{"ID":"20241017193536-ylebpl9","Type":"NodeParagraph","Properties":{"id":"20241017193536-ylebpl9","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"安装方法1：在线安装"}]},{"ID":"20241017193536-yng27n7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193536-yng27n7","updated":"20241017193536"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"yum install -y clamav\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193536-v0h38tj","Type":"NodeParagraph","Properties":{"id":"20241017193536-v0h38tj","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"检查安装成功："}]},{"ID":"20241017193536-lo9sos5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193536-lo9sos5","updated":"20241017193536"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"[root@iZas03lubteipyZ ~]# clamscan\nLibClamAV Error: cli_loaddbdir(): No supported database files found in /var/lib/clamav\nERROR: Can't open file or directory\n\n----------- SCAN SUMMARY -----------\nKnown viruses: 0\nEngine version: 0.103.11\nScanned directories: 0\nScanned files: 0\nInfected files: 0\nData scanned: 0.00 MB\nData read: 0.00 MB (ratio 0.00:1)\nTime: 0.004 sec (0 m 0 s)\nStart Date: 2024:10:17 15:37:34\nEnd Date:   2024:10:17 15:37:34\n[root@iZas03lubteipyZ ~]# \n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193536-i90g7d2","Type":"NodeParagraph","Properties":{"id":"20241017193536-i90g7d2","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"更新病毒库"}]},{"ID":"20241017193536-tysgmoe","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193536-tysgmoe","updated":"20241017193536"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"[root@iZas03lubteipyZ ~]# freshclam\nClamAV update process started at Thu Oct 17 15:38:19 2024\nWARNING: Your ClamAV installation is OUTDATED!\nWARNING: Local version: 0.103.11 Recommended version: 0.103.12\nDON'T PANIC! Read https://docs.clamav.net/manual/Installing.html\ndaily database available for download (remote version: 27429)\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193536-j0vd1ju","Type":"NodeParagraph","Properties":{"id":"20241017193536-j0vd1ju","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"只扫描"}]},{"ID":"20241017193536-v6ov1uz","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193536-v6ov1uz","updated":"20241017193536"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"clamscan -r /var --max-dir-recursion=5 -l /root/var_scan.log        #-r  指定路径    -l指定日志保存路径\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193536-0v8q09t","Type":"NodeParagraph","Properties":{"id":"20241017193536-0v8q09t","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"扫描并查杀病毒"}]},{"ID":"20241017193536-uj8x271","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193536-uj8x271","updated":"20241017193536"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"clamscan -r --remove /var   #最后指定扫描的目录\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193536-2qlw4cs","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20241017193536-2qlw4cs","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"webshell查杀"}]},{"ID":"20241017193536-g7bvw5t","Type":"NodeParagraph","Properties":{"id":"20241017193536-g7bvw5t","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://www.shellpub.com/","TextMarkTextContent":"https://www.shellpub.com/"}]},{"ID":"20241017193536-j971uai","Type":"NodeParagraph","Properties":{"id":"20241017193536-j971uai","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"linux版本离线安装"}]},{"ID":"20241017193536-ijmxyq0","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241017193536-ijmxyq0","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"命令替换检查  RPM check"}]},{"ID":"20241017193536-f21ffnk","Type":"NodeParagraph","Properties":{"id":"20241017193536-f21ffnk","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"linux系统自带的rpm检查校验rpm方式获取的安装包是否被替换和更改；如果正常，则不会有输出"}]},{"ID":"20241017193536-lp9enyd","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193536-lp9enyd","updated":"20241017193536"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"[root@localhost ~]# rpm -Va \u003e /var/log/rpm.log\n[root@localhost ~]# more /var/log/rpm.log \nS.5....T.  c /etc/profile\nS.5....T.  c /etc/redis.conf\n.......T.  c /etc/rc.d/rc.local\n.......T.  c /etc/ssh/sshd_config\n.M.......    /etc/httpd\n.M.......  c /etc/httpd/conf.modules.d/01-cgi.conf\nSM5....T.  c /etc/httpd/conf/httpd.conf\n.M.......  c /etc/httpd/conf.modules.d/00-ssl.conf\nS.5....T.  c /etc/my.cnf\nS.5....T.  c /etc/php.ini\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193536-vihy8lc","Type":"NodeParagraph","Properties":{"id":"20241017193536-vihy8lc","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"检查结果查看，返回8位特征，每个位置的特征代表以下含义："}]},{"ID":"20241017193536-clym83c","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193536-clym83c","updated":"20241017193536"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"证内容中的8个信息的具体内容如下：\n        S         文件大小是否改变\n        M         文件的类型或文件的权限（rwx）是否被改变\n        5         文件MD5校验是否改变（可以看成文件内容是否改变）\n        D         设备中，从代码是否改变\n        L         文件路径是否改变\n        U         文件的属主（所有者）是否改变\n        G         文件的属组是否改变\n        T         文件的修改时间是否改变\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193536-yr91qhp","Type":"NodeParagraph","Properties":{"id":"20241017193536-yr91qhp","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"如果被替换，可以还原："}]},{"ID":"20241017193536-wf55t17","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193536-wf55t17","updated":"20241017193536"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"rpm -qf /etc/httpd  #查他属于哪个软件包\nmv /etc/httpd /tmp  #临时移除放置在tmp目录\nrpm2cpio httpd-2.4.6-97.el7.centos.x86_64    |cpio -idv ./bin/httpd #提取rpm包中的命令httpd到/etc/httpd目录\ncp ./bin/httpd /etc/    #用目前新提出的httpd命令到原始目录/etc   \n\n\n或者：直接使用rpm重新安装\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193536-gx1z53o","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20241017193536-gx1z53o","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"安全检查的脚本"}]},{"ID":"20241017193536-psebw4h","Type":"NodeParagraph","Properties":{"id":"20241017193536-psebw4h","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"1、GScan"}]},{"ID":"20241017193536-5y1n5m1","Type":"NodeParagraph","Properties":{"id":"20241017193536-5y1n5m1","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"[GitHub - grayddq/GScan: 本程序旨在为安全应急响应人员对Linux主机排查时提供便利，实现主机侧Checklist的自动全面化检测，根据检测结果自动数据聚合，进行黑客攻击路径溯源。"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://github.com/grayddq/GScan","TextMarkTextContent":"https://github.com/grayddq/GScan"}]},{"ID":"20241017193536-l6fd31o","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193536-l6fd31o","updated":"20241017193536"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"[1]+  Stopped                 python ./GScan.py\n[root@localhost GScan-master]# python ./GScan.py  -h\n\n  _______      _______.  ______      ___      .__   __. \n /  _____|    /       | /      |    /   \\     |  \\ |  |    {version:v0.1}\n|  |  __     |   (----`|  ,----'   /  ^  \\    |   \\|  | \n|  | |_ |     \\   \\    |  |       /  /_\\  \\   |  . `  |    {author:咚咚呛}\n|  |__| | .----)   |   |  `----. /  _____  \\  |  |\\   | \n \\______| |_______/     \\______|/__/     \\__\\ |__| \\__|    http://grayddq.top\n                                                            \n    \nUsage: GScan.py [options]\n\nOptions:\n  -h, --help     show this help message and exit\n  --version      当前程序版本\n\n  Mode:\n    GScan running mode options\n\n    --overseas   境外模式，此参数将不进行境外ip的匹配\n    --full       完全模式，此参数将启用完全扫描\n    --debug      调试模式，进行程序的调试数据输出\n    --dif        差异模式，比对上一次的结果，输出差异结果信息。\n    --sug        排查建议，用于对异常点的手工排查建议\n    --pro        处理方案，根据异常风险生成初步的处理方案\n\n  Optimization:\n    Optimization options\n\n    --time=TIME  搜索指定时间内主机改动过的所有文件，demo: --time='2019-05-07\n                 00:00:00~2019-05-07 23:00:00'\n    --job        添加定时任务，用于定时执行程序（默认每天零点执行一次）\n    --hour=HOUR  定时任务，每N小时执行一次\n    --log        打包当前系统的所有安全日志（暂不支持）\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193536-k865046","Type":"NodeParagraph","Properties":{"id":"20241017193536-k865046","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"2、[GitHub - T0xst/linux: linux安全检查]("},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://github.com/T0xst/linux","TextMarkTextContent":"https://github.com/T0xst/linux"}]},{"ID":"20241017193536-er1ufiz","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193536-er1ufiz","updated":"20241017193536"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"cd linux-mater\nchmod 755 linuxcheck.sh\n./linuxcheck.sh\n\n扫描结果保存在：/tmp/linuxcheck_192.168.188.135_time\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193536-1eehg79","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20241017193536-1eehg79","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"webshell查杀"}]},{"ID":"20241017193536-zbf5qs2","Type":"NodeParagraph","Properties":{"id":"20241017193536-zbf5qs2","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"在线查杀木马，以及沙箱检测："}]},{"ID":"20241017193536-cq7mzim","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193536-cq7mzim","updated":"20241017193536"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"      \u003c!-- 沙箱在线检测 --\u003e\n        \u003cdiv class=\"popup-box\" id=\"popup5\"\u003e\n        \u003cdiv class=\"button-container\"\u003e\n          \u003ca href=\"https://habo.qq.com/\" target=\"_blank\"\u003e\u003cbutton class=\"button\"\u003e\u003cspan\u003e腾讯哈勃分析系统\u003c/span\u003e\u003c/button\u003e\u003c/a\u003e\n              \u003ca href=\"https://zhuanlan.zhihu.com/p/530639612\" target=\"_blank\"\u003e\u003cbutton class=\"button\"\u003e\u003cspan\u003e分析工具推荐\u003c/span\u003e\u003c/button\u003e\u003c/a\u003e\n          \u003ca href=\"https://opentip.kaspersky.com/\" target=\"_blank\"\u003e\u003cbutton class=\"button\"\u003e\u003cspan\u003e卡巴斯基威胁情报门户\u003c/span\u003e\u003c/button\u003e\u003c/a\u003e\n          \u003ca href=\"https://www.virscan.org/\" target=\"_blank\"\u003e\u003cbutton class=\"button\"\u003e\u003cspan\u003eVirSCAN多引擎在线病毒扫描\u003c/span\u003e\u003c/button\u003e\u003c/a\u003e\n          \u003ca href=\"https://www.virustotal.com/gui/home/upload\" target=\"_blank\"\u003e\u003cbutton class=\"button\"\u003e\u003cspan\u003eVirusTotal在线病毒扫描\u003c/span\u003e\u003c/button\u003e\u003c/a\u003e\n          \u003ca href=\"https://virusscan.jotti.org/\" target=\"_blank\"\u003e\u003cbutton class=\"button\"\u003e\u003cspan\u003eJotti的恶意软件扫描系统\u003c/span\u003e\u003c/button\u003e\u003c/a\u003e\n          \u003ca href=\"https://s.threatbook.com/\" target=\"_blank\"\u003e\u003cbutton class=\"button\"\u003e\u003cspan\u003e微步在线云沙箱\u003c/span\u003e\u003c/button\u003e\u003c/a\u003e\n              \u003ca href=\"https://ata.360.net/report/517970239223808\" target=\"_blank\"\u003e\u003cbutton class=\"button\"\u003e\u003cspan\u003e360沙箱云\u003c/span\u003e\u003c/button\u003e\u003c/a\u003e\n          \u003ca href=\"https://poma.nsfocus.com/\" target=\"_blank\"\u003e\u003cbutton class=\"button\"\u003e\u003cspan\u003e绿盟沙箱分析\u003c/span\u003e\u003c/button\u003e\u003c/a\u003e\n          \u003ca href=\"https://tria.ge/login?return_to=%2Fdashboard\" target=\"_blank\"\u003e\u003cbutton class=\"button\"\u003e\u003cspan\u003eRecorded Future Triage云沙箱\u003c/span\u003e\u003c/button\u003e\u003c/a\u003e\n          \u003ca href=\"https://www.hybrid-analysis.com/\" target=\"_blank\"\u003e\u003cbutton class=\"button\"\u003e\u003cspan\u003eHybrid Analysis在线沙箱\u003c/span\u003e\u003c/button\u003e\u003c/a\u003e\n          \u003ca href=\"https://n.shellpub.com/\" target=\"_blank\"\u003e\u003cbutton class=\"button\"\u003e\u003cspan\u003e河马在线查杀\u003c/span\u003e\u003c/button\u003e\u003c/a\u003e\n        \u003c/div\u003e\n      \u003c/div\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193536-fmnhokh","Type":"NodeParagraph","Properties":{"id":"20241017193536-fmnhokh","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"离线的："}]},{"ID":"20241017193536-5i93n3b","Type":"NodeParagraph","Properties":{"id":"20241017193536-5i93n3b","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"D盾"}]},{"ID":"20241017193536-nimltpe","Type":"NodeParagraph","Properties":{"id":"20241017193536-nimltpe","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"http://www.d99net.net/","TextMarkTextContent":"http://www.d99net.net"}]},{"ID":"20241017193536-c78zmeq","Type":"NodeParagraph","Properties":{"id":"20241017193536-c78zmeq","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"河马查杀"}]},{"ID":"20241017193536-hqvs9kj","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241017193536-hqvs9kj","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"如果遇到免杀的脚本"}]},{"ID":"20241017193536-0z623mc","Type":"NodeParagraph","Properties":{"id":"20241017193536-0z623mc","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"1、检查md5校验"}]},{"ID":"20241017193536-btqgi51","Type":"NodeParagraph","Properties":{"id":"20241017193536-btqgi51","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"2、文件内容比较，notepad++做逐行比较"}]},{"ID":"20241017193536-0u49cmb","Type":"NodeParagraph","Properties":{"id":"20241017193536-0u49cmb","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"工具：beyong compare"}]},{"ID":"20241017193536-74hdt18","Type":"NodeParagraph","Properties":{"id":"20241017193536-74hdt18","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://www.beyondcomparepro.com/download","TextMarkTextContent":"https://www.beyondcomparepro.com/download"}]},{"ID":"20241017193536-mnzi4t8","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241017193536-mnzi4t8","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"勒索病毒"}]},{"ID":"20241017193536-o20uk9e","Type":"NodeParagraph","Properties":{"id":"20241017193536-o20uk9e","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"将文件给锁掉，让你添加他给他赚钱然后给你一个“密钥”。。。"}]},{"ID":"20241017193536-6ojwdpq","Type":"NodeParagraph","Properties":{"id":"20241017193536-6ojwdpq","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"防范方法："},{"Type":"NodeText","Data":" **\t**定期备份---中了病毒就恢复数据"}]},{"ID":"20241017193536-cgom8gu","Type":"NodeParagraph","Properties":{"id":"20241017193536-cgom8gu","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"在线检测一些勒索病毒："}]},{"ID":"20241017193536-f1vy4fx","Type":"NodeParagraph","Properties":{"id":"20241017193536-f1vy4fx","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"1、360的：[安全卫士勒索病毒专题:文件恢复"},{"Type":"NodeTextMark","TextMarkType":"em","TextMarkTextContent":"安全卫士离线救灾版"},{"Type":"NodeText","Data":"文档卫士 (360.cn)]("},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://lesuobingdu.360.cn/","TextMarkTextContent":"https://lesuobingdu.360.cn/"}]},{"ID":"20241017193536-oq9nkry","Type":"NodeParagraph","Properties":{"id":"20241017193536-oq9nkry","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"2、腾讯的离线检测：[勒索病毒拦截|文件恢复_文档守护者保护文档安全 - 腾讯电脑管家 (qq.com)]("},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://guanjia.qq.com/pr/ls/","TextMarkTextContent":"https://guanjia.qq.com/pr/ls/"}]},{"ID":"20241017193536-vtsglou","Type":"NodeParagraph","Properties":{"id":"20241017193536-vtsglou","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"3、奇安信在线：[勒索病毒搜索 (qianxin.com)]("},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://lesuobingdu.qianxin.com/","TextMarkTextContent":"https://lesuobingdu.qianxin.com/"}]},{"ID":"20241017193536-rslzawb","Type":"NodeParagraph","Properties":{"id":"20241017193536-rslzawb","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"4、深信服在线检测：[深信服EDR (sangfor.com.cn)]("},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://edr.sangfor.com.cn/#/information/ransom_search","TextMarkTextContent":"https://edr.sangfor.com.cn/#/information/ransom_search"}]},{"ID":"20241017193536-ez3e1f7","Type":"NodeParagraph","Properties":{"id":"20241017193536-ez3e1f7","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"检测的工具："}]},{"ID":"20241017193536-iu6ybj3","Type":"NodeParagraph","Properties":{"id":"20241017193536-iu6ybj3","updated":"20241017193536"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"安全厂家提供的解密工具："}]},{"ID":"20241017193536-fwnya03","Type":"NodeParagraph","Properties":{"id":"20241017193536-fwnya03","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**【腾讯哈勃】勒索软件专杀工具 官网： **"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://habo.qq.com/tool","TextMarkTextContent":"https://habo.qq.com/tool"}]},{"ID":"20241017193536-vqwq65x","Type":"NodeParagraph","Properties":{"id":"20241017193536-vqwq65x","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**【金山毒霸】勒索病毒免疫工具 官网： **"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"http://www.duba.net/dbt/wannacry.html","TextMarkTextContent":"http://www.duba.net/dbt/wannacry.html"}]},{"ID":"20241017193536-onza4vo","Type":"NodeParagraph","Properties":{"id":"20241017193536-onza4vo","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**【火绒】安全工具下载 官网： **"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"http://bbs.huorong.cn/forum-55-1.html","TextMarkTextContent":"http://bbs.huorong.cn/forum-55-1.html"}]},{"ID":"20241017193536-l6ogdmy","Type":"NodeParagraph","Properties":{"id":"20241017193536-l6ogdmy","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**【瑞星】解密工具下载 官网： **"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"http://it.rising.com.cn/fanglesuo/index.html","TextMarkTextContent":"http://it.rising.com.cn/fanglesuo/index.html"}]},{"ID":"20241017193536-x8q1wzp","Type":"NodeParagraph","Properties":{"id":"20241017193536-x8q1wzp","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**【nomoreransom】勒索软件解密工具集 官网： **"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://www.nomoreransom.org/zh/index.html","TextMarkTextContent":"https://www.nomoreransom.org/zh/index.html"}]},{"ID":"20241017193536-7fc16ur","Type":"NodeParagraph","Properties":{"id":"20241017193536-7fc16ur","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**【MalwareHunterTeam】勒索软件解密工具集 官网： **"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://id-ransomware.malwarehunterteam.com/","TextMarkTextContent":"https://id-ransomware.malwarehunterteam.com"}]},{"ID":"20241017193536-1fvv2z8","Type":"NodeParagraph","Properties":{"id":"20241017193536-1fvv2z8","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**【卡巴斯基】免费勒索解密器 官网： **"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://noransom.kaspersky.com/","TextMarkTextContent":"https://noransom.kaspersky.com"}]},{"ID":"20241017193536-vfm8tpb","Type":"NodeParagraph","Properties":{"id":"20241017193536-vfm8tpb","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**【Avast】免费勒索软件解密工具 官网： **"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://www.avast.com/zh-cn/ransomware-decryption-tools","TextMarkTextContent":"https://www.avast.com/zh-cn/ransomware-decryption-tools"}]},{"ID":"20241017193536-ylyokxg","Type":"NodeParagraph","Properties":{"id":"20241017193536-ylyokxg","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**【Emsisoft】免费勒索软件解密工具 官网： **"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://www.emsisoft.com/ransomware-decryption-tools/free-download","TextMarkTextContent":"https://www.emsisoft.com/ransomware-decryption-tools/free-download"}]},{"ID":"20241017193536-sxqxt65","Type":"NodeParagraph","Properties":{"id":"20241017193536-sxqxt65","updated":"20241017193536"},"Children":[{"Type":"NodeText","Data":"**【GitHub 项目】勒索病毒解密工具收集汇总 官网： **"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://github.com/jiansiting/Decryption-Tools","TextMarkTextContent":"https://github.com/jiansiting/Decryption-Tools"}]},{"ID":"20241017193536-pwrkq50","Type":"NodeParagraph","Properties":{"id":"20241017193536-pwrkq50","updated":"20241017193539"}},{"ID":"20241017193537-frznc1w","Type":"NodeParagraph","Properties":{"id":"20241017193537-frznc1w"}}]}