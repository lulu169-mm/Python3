{"ID":"20240919084900-68jkpqd","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240919084900-68jkpqd","scroll":"\u0026#123;\u0026quot;rootId\u0026quot;:\u0026quot;20240919084900-68jkpqd\u0026quot;,\u0026quot;startId\u0026quot;:\u0026quot;20240919084900-7kg1ozu\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20240919142235-pwza2tw\u0026quot;,\u0026quot;scrollTop\u0026quot;:2080,\u0026quot;focusId\u0026quot;:\u0026quot;20240919084900-7kg1ozu\u0026quot;,\u0026quot;focusStart\u0026quot;:0,\u0026quot;focusEnd\u0026quot;:0\u0026#125;","title":"XXE外部实体注入漏洞","updated":"20240919142334"},"Children":[{"ID":"20240919084900-7kg1ozu","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240919084900-7kg1ozu","updated":"20240919091701"},"Children":[{"Type":"NodeText","Data":"XML"}]},{"ID":"20240919091729-enn276n","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240919091729-enn276n","updated":"20240919091731"},"Children":[{"Type":"NodeText","Data":"概述"}]},{"ID":"20240919091724-35q60k0","Type":"NodeBlockquote","Properties":{"id":"20240919091724-35q60k0","updated":"20240919091902"},"Children":[{"ID":"20240919091713-klu9xx3","Type":"NodeParagraph","Properties":{"id":"20240919091713-klu9xx3","updated":"20240919091745"},"Children":[{"Type":"NodeText","Data":"XML是可扩展标记语言"}]},{"ID":"20240919091745-zlhoo8i","Type":"NodeParagraph","Properties":{"id":"20240919091745-zlhoo8i","updated":"20240919091756"},"Children":[{"Type":"NodeText","Data":"像html的一种标记语言"}]},{"ID":"20240919091757-xgtpd0c","Type":"NodeParagraph","Properties":{"id":"20240919091757-xgtpd0c","updated":"20240919091819"},"Children":[{"Type":"NodeText","Data":"html是为了显示数据，xml是为了传输数据的"}]},{"ID":"20240919091821-z0wubak","Type":"NodeParagraph","Properties":{"id":"20240919091821-z0wubak","updated":"20240919091854"},"Children":[{"Type":"NodeText","Data":"标签没有被定义，需要自行定义"}]},{"ID":"20240919091856-t2l7j5f","Type":"NodeParagraph","Properties":{"id":"20240919091856-t2l7j5f","updated":"20240919091902"},"Children":[{"Type":"NodeText","Data":"自我描述性"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20240919092038-91gndre","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240919092038-91gndre","updated":"20240919092214"},"Children":[{"Type":"NodeText","Data":"特性"}]},{"ID":"20240919092216-eved2w4","Type":"NodeParagraph","Properties":{"id":"20240919092216-eved2w4","updated":"20240919092303"},"Children":[{"Type":"NodeText","Data":"需要根节点"}]},{"ID":"20240919092229-ygssycu","Type":"NodeParagraph","Properties":{"id":"20240919092229-ygssycu","updated":"20240919092240"},"Children":[{"Type":"NodeText","Data":"标签需要一一对应，并且闭合"}]},{"ID":"20240919092241-csq8i2o","Type":"NodeParagraph","Properties":{"id":"20240919092241-csq8i2o","updated":"20240919092307"},"Children":[{"Type":"NodeText","Data":"xml声明（可选）"}]},{"ID":"20240919092356-ze4m7ie","Type":"NodeParagraph","Properties":{"id":"20240919092356-ze4m7ie","updated":"20240919092437"},"Children":[{"Type":"NodeText","Data":"大小写敏感"}]},{"ID":"20240919092438-0v0er95","Type":"NodeParagraph","Properties":{"id":"20240919092438-0v0er95","updated":"20240919092447"},"Children":[{"Type":"NodeText","Data":"标签不使用xml开头"}]},{"ID":"20240919092448-mask32i","Type":"NodeParagraph","Properties":{"id":"20240919092448-mask32i","updated":"20240919092502"},"Children":[{"Type":"NodeText","Data":"名称不能有空格、特殊字符"}]},{"ID":"20240919092558-0tibq5w","Type":"NodeHeading","HeadingLevel":2,"Properties":{"fold":"1","id":"20240919092558-0tibq5w","updated":"20240919092604"},"Children":[{"Type":"NodeText","Data":"作用"}]},{"ID":"20240919092605-12gvoth","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240919092605-12gvoth","updated":"20240919092619"},"Children":[{"Type":"NodeText","Data":"传输数据、存储数据"}]},{"ID":"20240919092629-1g3mu7u","Type":"NodeHeading","HeadingLevel":2,"Properties":{"fold":"1","id":"20240919092629-1g3mu7u","updated":"20240919092629"},"Children":[{"Type":"NodeText","Data":"语法结构"}]},{"ID":"20240919092629-m37hagl","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240919092629-m37hagl","updated":"20240919093134"},"Children":[{"Type":"NodeText","Data":"两部分：标签定义部分、标签解释部分"}]},{"ID":"20240919092629-r2qk6vu","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20240919092629-r2qk6vu","updated":"20240919092629"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"\u003e\n\n\u003caa\u003e\n\t\u003cb\u003esfsdf\u003c/b\u003e\n\t\u003cc\u003esfsfw\u003c/c\u003e\n\u003c/aa\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919093113-26k9gfq","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240919093113-26k9gfq"}},{"ID":"20240919092636-qtznt0t","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240919092636-qtznt0t","updated":"20240919092727"},"Children":[{"Type":"NodeText","Data":"标签定义部分：DTD（document type definition）文档类型定义"}]},{"ID":"20240919092737-jybtuag","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","heading-fold":"1","id":"20240919092737-jybtuag","updated":"20240919092758"},"Children":[{"Type":"NodeText","Data":"内部dtd"}]},{"ID":"20240919092802-kuy79nn","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20240919092802-kuy79nn","updated":"20240919100926"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e   //xml声明\n\n#!DOCTYPE定义此文档为user类型的文档\n\u003c!DOCTYPE user[                     //user类型文档\n\n#！ELEMENT user()声明user中的元素，可声明，可不声明\n\u003c!ELEMENT user (username,password)\u003e\n\n#!ELEMENT username (#PCDATA)声明元素类型，定义可被解析器解析\n//#CDATA不会被解析 \n\u003c!ELEMENT username (#PCDATA)\u003e\n\u003c!ELEMENT password (#CDATA)\u003e //容易解析错误\n\n]\u003e    \n\n\u003cuser\u003e\n\u003cusername\u003e\u003c/username\u003e\n\u003cpassword\u003e\u003c/password\u003e\n\u003c/user\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919093028-kb6pot7","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","heading-fold":"1","id":"20240919093028-kb6pot7","updated":"20240919094945"},"Children":[{"Type":"NodeText","Data":"外部dtd"}]},{"ID":"20240919093038-pfy7ejs","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20240919093038-pfy7ejs","updated":"20240919095403"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE user SYSTEM \"1.dtd\"\u003e\n\u003cuser\u003e\n\u003cuname\u003eghj\u003c/uname\u003e\n\u003cpasswd\u003e\u003c/passwd\u003e\n\u003c/user\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919095255-86m100w","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20240919095255-86m100w","updated":"20240919095737"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"#声明元素名称\n\u003c!ELEMENT user (uname,passwd)\u003e\n\n#声明类型，这里面的PCDATA和CDATA都可以被解析出来\n\u003c!ELEMENT user (#PCDATA)\u003e\n\u003c!ELEMENT user (#PCDATA)\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919095801-trpjkw0","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240919095801-trpjkw0"}},{"ID":"20240919095802-322etc8","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240919095802-322etc8"}},{"ID":"20240919095802-t53oww4","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240919095802-t53oww4","updated":"20240919095807"},"Children":[{"Type":"NodeText","Data":"XML实体"}]},{"ID":"20240919095849-yukjqb7","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240919095849-yukjqb7","updated":"20240919095852"},"Children":[{"Type":"NodeText","Data":"概念"}]},{"ID":"20240919100004-sy7by4h","Type":"NodeParagraph","Properties":{"id":"20240919100004-sy7by4h","updated":"20240919100012"},"Children":[{"Type":"NodeText","Data":"$a 变量名称"}]},{"ID":"20240919100012-uls1cs1","Type":"NodeParagraph","Properties":{"id":"20240919100012-uls1cs1","updated":"20240919100023"},"Children":[{"Type":"NodeText","Data":"$a=1 变量的值1"}]},{"ID":"20240919100024-jtx0as1","Type":"NodeParagraph","Properties":{"id":"20240919100024-jtx0as1","updated":"20240919100148"},"Children":[{"Type":"NodeText","Data":"xml实体是xml语言的变量，和php语言变量一样，有变量名（实体名）、变量值（实体值）；xml中通过\u0026（取地址符）/%来引用变量"}]},{"ID":"20240919100148-lgqgxa7","Type":"NodeParagraph","Properties":{"id":"20240919100148-lgqgxa7"}},{"ID":"20240919100149-dm3wcln","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240919100149-dm3wcln","updated":"20240919100155"},"Children":[{"Type":"NodeText","Data":"实体类型"}]},{"ID":"20240919100202-zyhteob","Type":"NodeParagraph","Properties":{"id":"20240919100202-zyhteob","updated":"20240919100218"},"Children":[{"Type":"NodeText","Data":"普通实体：预定义好的"}]},{"ID":"20240919100256-hrroo68","Type":"NodeParagraph","Properties":{"id":"20240919100256-hrroo68","updated":"20240919100328"},"Children":[{"Type":"NodeText","Data":"\t内部实体：定义在xml中的变量"}]},{"ID":"20240919100328-0wriodq","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240919100328-0wriodq","updated":"20240919101115"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE student[\n\u003c!ELEMENT student (name,age)\u003e   //定义元素\n\u003c!ELEMENT name (#PCDATA)\u003e       //定义元素类型\n\u003c!ELEMEMT age (#PCDATA)\u003e\n\n#定义实体\n\u003c!ENTITY aa \"zhangsan\"\u003e\n\u003c!ENTITY bb \"16\"\u003e\n]\u003e\n\u003cstudent\u003e\n\t\u003cname\u003e\u0026aa;\u003c/name\u003e     //\u0026实体名称;\n\t\u003cage\u003e\u0026bb;\u003c/age\u003e\n\u003c/student\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919101126-uq2hkxb","Type":"NodeParagraph","Properties":{"id":"20240919101126-uq2hkxb","updated":"20240919101140"},"Children":[{"Type":"NodeText","Data":"不定义元素，直接实体"}]},{"ID":"20240919101140-okghijo","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240919101140-okghijo","updated":"20240919101202"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE student[\n\n#定义实体\n\u003c!ENTITY aa \"zhangsan\"\u003e\n\u003c!ENTITY bb \"16\"\u003e\n]\u003e\n\u003cstudent\u003e\n\t\u003cname\u003e\u0026aa;\u003c/name\u003e     //\u0026实体名称;\n\t\u003cage\u003e\u0026bb;\u003c/age\u003e\n\u003c/student\u003e\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919101126-k608mye","Type":"NodeParagraph","Properties":{"id":"20240919101126-k608mye","updated":"20240919101216"},"Children":[{"Type":"NodeText","Data":"\t外部dtd实体"}]},{"ID":"20240919101250-l5pn1ar","Type":"NodeParagraph","Properties":{"id":"20240919101250-l5pn1ar","updated":"20240919101252"},"Children":[{"Type":"NodeText","Data":"语法"}]},{"ID":"20240919101340-5780v26","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240919101340-5780v26","updated":"20240919101436"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003c!DOCTYPE dd-element[\n\u003c!ELEMENT 实体名称 \u003e\n]\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919101340-lpva517","Type":"NodeParagraph","Properties":{"id":"20240919101340-lpva517"}},{"ID":"20240919101348-ba261y0","Type":"NodeParagraph","Properties":{"id":"20240919101348-ba261y0","updated":"20240919101359"},"Children":[{"Type":"NodeText","Data":"任意文档类型"}]},{"ID":"20240919101359-274cdw5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240919101359-274cdw5","updated":"20240919101413"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003c!DOCTYPE ANY[]\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919101340-wyz7jc0","Type":"NodeParagraph","Properties":{"id":"20240919101340-wyz7jc0"}},{"ID":"20240919101545-32qo6pk","Type":"NodeParagraph","Properties":{"id":"20240919101545-32qo6pk","updated":"20240919102350"},"Children":[{"Type":"NodeText","Data":"举个🌰(前提，得有解析器)"}]},{"ID":"20240919101217-b7pq977","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240919101217-b7pq977","updated":"20240919102239"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE user[\n\u003c!ENTITY a SYSTEM “file://路径/win.ini”\u003e   \n]\u003e\n\u003cstudent\u003e\n\t\u003cuname\u003e\u0026a;\u003c/uname\u003e  \n\u003c/student\u003e\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919101126-hjswbd4","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240919101126-hjswbd4","updated":"20240919102245"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919101126-34upzee","Type":"NodeParagraph","Properties":{"id":"20240919101126-34upzee"}},{"ID":"20240919100206-lmk7aft","Type":"NodeParagraph","Properties":{"id":"20240919100206-lmk7aft","updated":"20240919100229"},"Children":[{"Type":"NodeText","Data":"参数实体：有变量"}]},{"ID":"20240919100942-0hkszps","Type":"NodeParagraph","Properties":{"id":"20240919100942-0hkszps","updated":"20240919102453"},"Children":[{"Type":"NodeText","Data":"格式"}]},{"ID":"20240919102453-ov5pby1","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240919102453-ov5pby1","updated":"20240919102549"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003c!ENTITY % 实体名称 “实体值”\u003e\n\u003c!ENTITY % 实体名称 SYSTEM \"资源位置URI\"\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919102628-jpzuia0","Type":"NodeParagraph","Properties":{"id":"20240919102628-jpzuia0"}},{"ID":"20240919102629-4kn8piv","Type":"NodeParagraph","Properties":{"id":"20240919102629-4kn8piv","updated":"20240919102639"},"Children":[{"Type":"NodeText","Data":"举个🌰"}]},{"ID":"20240919102640-zvzn2sc","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240919102640-zvzn2sc","updated":"20240919105426"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE ANY[\n\u003c!ENTITY % a SYSTEM \"路径/2.dtd\"\u003e\n%a;\n]\u003e\n\n\u003cuser\u003e\n\u003cname\u003e\u0026b;\u003c/name\u003e\n\u003c/user\u003e\n\n\n2.dtd\n\u003c!ENTITY b SYSTEM \"file://路径/文件\"\u003e\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919102904-gsnikn9","Type":"NodeParagraph","Properties":{"id":"20240919102904-gsnikn9"}},{"ID":"20240919105428-ssybqqw","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240919105428-ssybqqw","updated":"20240919105431"},"Children":[{"Type":"NodeText","Data":"常用协议"}]},{"ID":"20240919105450-wswv2jr","Type":"NodeParagraph","Properties":{"id":"20240919105450-wswv2jr","updated":"20240919105457"},"Children":[{"Type":"NodeText","Data":"file:// 读文件"}]},{"ID":"20240919105457-c3qxzfm","Type":"NodeParagraph","Properties":{"id":"20240919105457-c3qxzfm","updated":"20240919105506"},"Children":[{"Type":"NodeText","Data":"php://filter"}]},{"ID":"20240919105510-xi7b0hm","Type":"NodeParagraph","Properties":{"id":"20240919105510-xi7b0hm","updated":"20240919105610"},"Children":[{"Type":"NodeText","Data":"expect:// 执行系统命令，利用xml漏洞，若命令存在空格，可使用$(IFS)替换空格"}]},{"ID":"20240919105620-0cigrpg","Type":"NodeParagraph","Properties":{"id":"20240919105620-0cigrpg","updated":"20240919105620"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240919105620-pbuw1ny.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240919105710-1c5718j","Type":"NodeParagraph","Properties":{"id":"20240919105710-1c5718j"}},{"ID":"20240919105711-lhh09bi","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240919105711-lhh09bi","updated":"20240919105718"},"Children":[{"Type":"NodeText","Data":"XXE漏洞"}]},{"ID":"20240919105718-1sxxwq0","Type":"NodeParagraph","Properties":{"id":"20240919105718-1sxxwq0","updated":"20240919105728"},"Children":[{"Type":"NodeText","Data":"xml外部实体注入"}]},{"ID":"20240919105729-v0dblku","Type":"NodeParagraph","Properties":{"id":"20240919105729-v0dblku","updated":"20240919105736"},"Children":[{"Type":"NodeText","Data":"前置条件："}]},{"ID":"20240919105736-e86eqtv","Type":"NodeParagraph","Properties":{"id":"20240919105736-e86eqtv","updated":"20240919105751"},"Children":[{"Type":"NodeText","Data":"1.xml语句能够被解析器解析"}]},{"ID":"20240919105758-eqqjdaf","Type":"NodeParagraph","Properties":{"id":"20240919105758-eqqjdaf","updated":"20240919105809"},"Children":[{"Type":"NodeText","Data":"2.没有禁止外部实体加载"}]},{"ID":"20240919105825-nwx8y84","Type":"NodeParagraph","Properties":{"id":"20240919105825-nwx8y84"}},{"ID":"20240919105826-5e0c497","Type":"NodeParagraph","Properties":{"id":"20240919105826-5e0c497","updated":"20240919105841"},"Children":[{"Type":"NodeText","Data":"产生：上传的、插入的xml文件没有进行过滤"}]},{"ID":"20240919105902-hz3dwa0","Type":"NodeParagraph","Properties":{"id":"20240919105902-hz3dwa0"}},{"ID":"20240919105902-9xb2pzm","Type":"NodeParagraph","Properties":{"id":"20240919105902-9xb2pzm","updated":"20240919105916"},"Children":[{"Type":"NodeText","Data":"危害："}]},{"ID":"20240919105916-1k7sk9u","Type":"NodeParagraph","Properties":{"id":"20240919105916-1k7sk9u","updated":"20240919105919"},"Children":[{"Type":"NodeText","Data":"1.读文件"}]},{"ID":"20240919105927-bx3b42g","Type":"NodeParagraph","Properties":{"id":"20240919105927-bx3b42g","updated":"20240919105939"},"Children":[{"Type":"NodeText","Data":"2.执行系统命令"}]},{"ID":"20240919105939-nc7vg9f","Type":"NodeParagraph","Properties":{"id":"20240919105939-nc7vg9f","updated":"20240919110002"},"Children":[{"Type":"NodeText","Data":"3.通过协议dict://扫描内网端口或服务"}]},{"ID":"20240919110004-06po7xt","Type":"NodeParagraph","Properties":{"id":"20240919110004-06po7xt","updated":"20240919110011"},"Children":[{"Type":"NodeText","Data":"4.攻击内网其他网站"}]},{"ID":"20240919110027-7vh86ng","Type":"NodeParagraph","Properties":{"id":"20240919110027-7vh86ng"}},{"ID":"20240919110105-phzrzfv","Type":"NodeParagraph","Properties":{"id":"20240919110105-phzrzfv","updated":"20240919110224"},"Children":[{"Type":"NodeText","Data":"防御"}]},{"ID":"20240919110226-zqvjqjt","Type":"NodeParagraph","Properties":{"id":"20240919110226-zqvjqjt"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-theme-background); font-family: var(--b3-font-family); color: var(--b3-theme-on-background);"},"TextMarkType":"text","TextMarkTextContent":"1.过滤xml语句的特征（\u0026lt;!ENTITY\u0026gt;、\u0026lt;!DOCTYPE SYSTEM\u0026gt;、expect://、 file:// data:// phar://协议\u0026gt;"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-theme-background); font-family: var(--b3-font-family); color: var(--b3-theme-on-background);\"}"}]},{"ID":"20240919110107-87n721i","Type":"NodeParagraph","Properties":{"id":"20240919110107-87n721i","updated":"20240919110223"},"Children":[{"Type":"NodeText","Data":"1.过滤xml语句的特征（\u003c!ENTITY\u003e、\u003c!DOCTYPE 》caretreplacement\u003e"}]},{"ID":"20240919110152-twtaql4","Type":"NodeParagraph","Properties":{"id":"20240919110152-twtaql4","updated":"20240919111154"},"Children":[{"Type":"NodeText","Data":"2.禁用外部实体，libxml_disable_entity_loader（true）配置"}]},{"ID":"20240919111041-t8hs69j","Type":"NodeParagraph","Properties":{"id":"20240919111041-t8hs69j"}},{"ID":"20240919111041-r9ixsua","Type":"NodeParagraph","Properties":{"id":"20240919111041-r9ixsua"}},{"ID":"20240919111041-le7hot8","Type":"NodeParagraph","Properties":{"id":"20240919111041-le7hot8","updated":"20240919111044"},"Children":[{"Type":"NodeText","Data":"流程"}]},{"ID":"20240919111045-pza8ip4","Type":"NodeParagraph","Properties":{"id":"20240919111045-pza8ip4","updated":"20240919111101"},"Children":[{"Type":"NodeText","Data":"1.判断是否使用了xml进行数据传递"}]},{"ID":"20240919111102-9dzlfvd","Type":"NodeParagraph","Properties":{"id":"20240919111102-9dzlfvd","updated":"20240919111120"},"Children":[{"Type":"NodeText","Data":"标签、Accept：application/xml，text/xml"}]},{"ID":"20240919111122-16ndho6","Type":"NodeParagraph","Properties":{"id":"20240919111122-16ndho6","updated":"20240919111131"},"Children":[{"Type":"NodeText","Data":"2.确定回显位置，或无回显"}]},{"ID":"20240919111203-cswfdhd","Type":"NodeParagraph","Properties":{"id":"20240919111203-cswfdhd","updated":"20240919111207"},"Children":[{"Type":"NodeText","Data":"3.配置漏洞"}]},{"ID":"20240919111230-qea71e2","Type":"NodeParagraph","Properties":{"id":"20240919111230-qea71e2"}},{"ID":"20240919111231-doj2mo4","Type":"NodeParagraph","Properties":{"id":"20240919111231-doj2mo4","updated":"20240919111853"},"Children":[{"Type":"NodeText","Data":"具体实操"}]},{"ID":"20240919111903-atcoh77","Type":"NodeParagraph","Properties":{"id":"20240919111903-atcoh77","updated":"20240919111906"},"Children":[{"Type":"NodeText","Data":"1.读文件"}]},{"ID":"20240919111907-i7okt2m","Type":"NodeParagraph","Properties":{"id":"20240919111907-i7okt2m","updated":"20240919111907"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240919111236-h245h1w.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240919111907-d2s4sri","Type":"NodeParagraph","Properties":{"id":"20240919111907-d2s4sri","updated":"20240919111907"}},{"ID":"20240919111907-ptrfw1c","Type":"NodeParagraph","Properties":{"id":"20240919111907-ptrfw1c","updated":"20240919111907"},"Children":[{"Type":"NodeText","Data":"外部实体"}]},{"ID":"20240919111907-j0qua1d","Type":"NodeParagraph","Properties":{"id":"20240919111907-j0qua1d","updated":"20240919111907"},"Children":[{"Type":"NodeText","Data":"payload："}]},{"ID":"20240919111907-vuf9ray","Type":"NodeParagraph","Properties":{"id":"20240919111907-vuf9ray","updated":"20240919111907"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240919111543-bn6i023.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240919111907-pec19p9","Type":"NodeParagraph","Properties":{"id":"20240919111907-pec19p9","updated":"20240919111907"}},{"ID":"20240919111907-cikfssj","Type":"NodeParagraph","Properties":{"id":"20240919111907-cikfssj","updated":"20240919111907"},"Children":[{"Type":"NodeText","Data":"1.dtd"}]},{"ID":"20240919111907-dijvy74","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240919111907-dijvy74","updated":"20240919111907"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003c!ENTITY xxe SYSTEM \"file://etc/passwd\"\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919111907-nmy6n1e","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240919111907-nmy6n1e","updated":"20240919111907"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"CMD：\n开启web服务：python3 -m http.server\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919111910-2agjddo","Type":"NodeParagraph","Properties":{"id":"20240919111910-2agjddo"}},{"ID":"20240919111911-i1rkftj","Type":"NodeParagraph","Properties":{"id":"20240919111911-i1rkftj","updated":"20240919112246"},"Children":[{"Type":"NodeText","Data":"2.探测端口是否开放"}]},{"ID":"20240919112247-lp1tcwt","Type":"NodeParagraph","Properties":{"id":"20240919112247-lp1tcwt","updated":"20240919112256"},"Children":[{"Type":"NodeText","Data":"通过回显长度或页面特征判断"}]},{"ID":"20240919112257-et32pww","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240919112257-et32pww","updated":"20240919112257"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919112303-4m226zd","Type":"NodeParagraph","Properties":{"id":"20240919112303-4m226zd","updated":"20240919112303"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240919112303-3ksfr3v.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240919112308-zcxv385","Type":"NodeParagraph","Properties":{"id":"20240919112308-zcxv385","updated":"20240919112321"},"Children":[{"Type":"NodeText","Data":"3.命令执行（前提：需要php环境）"}]},{"ID":"20240919112443-dym43gs","Type":"NodeParagraph","Properties":{"id":"20240919112443-dym43gs","updated":"20240919112443"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240919112443-afaxouk.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240919112601-wy2x7r1","Type":"NodeParagraph","Properties":{"id":"20240919112601-wy2x7r1","updated":"20240919112601"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240919112601-5ny9n20.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240919112602-jddltg2","Type":"NodeParagraph","Properties":{"id":"20240919112602-jddltg2","updated":"20240919112616"},"Children":[{"Type":"NodeText","Data":"4.没有回显的XXE"}]},{"ID":"20240919140018-vps6iew","Type":"NodeParagraph","Properties":{"id":"20240919140018-vps6iew"}},{"ID":"20240919142136-bkvkcij","Type":"NodeParagraph","Properties":{"id":"20240919142136-bkvkcij"}},{"ID":"20240919142136-x6xznu4","Type":"NodeParagraph","Properties":{"id":"20240919142136-x6xznu4"}},{"ID":"20240919142136-mysy539","Type":"NodeParagraph","Properties":{"id":"20240919142136-mysy539"}},{"ID":"20240919142136-huok2s0","Type":"NodeParagraph","Properties":{"id":"20240919142136-huok2s0"}},{"ID":"20240919142136-3vumgqz","Type":"NodeParagraph","Properties":{"id":"20240919142136-3vumgqz","updated":"20240919142150"},"Children":[{"Type":"NodeText","Data":"XXE漏洞代码审计方法"}]},{"ID":"20240919142150-dzrvibe","Type":"NodeParagraph","Properties":{"id":"20240919142150-dzrvibe"}},{"ID":"20240919142150-0mu5fuo","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240919142150-0mu5fuo","updated":"20240919142334"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"simplexml_load_string()\nsimplexml_import_dom()实例化xml文档函数\nlibxml_disable_entity_loader(false)开启引用外部实体\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919142235-pwza2tw","Type":"NodeParagraph","Properties":{"id":"20240919142235-pwza2tw","updated":"20240919142329"}}]}