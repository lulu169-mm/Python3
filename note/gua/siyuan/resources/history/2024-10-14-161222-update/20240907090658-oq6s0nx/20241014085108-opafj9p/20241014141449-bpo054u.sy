{"ID":"20241014141449-bpo054u","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f945","id":"20241014141449-bpo054u","title":"Linux安全加固","updated":"20241014160951"},"Children":[{"ID":"20241014141657-2opo5m2","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241014141657-2opo5m2","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"账户"}]},{"ID":"20241014141657-52l5xbc","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241014141657-52l5xbc","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"1.查看是否存在UID为0的特权账号"}]},{"ID":"20241014141657-cg8c5zn","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241014141657-cg8c5zn","updated":"20241014141657"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bGludXg="},{"Type":"NodeCodeBlockCode","Data":"cat /etc/passwd\nawk -F: '($3==0)' /etc/passwd   //查看是否有多的root权限。\n//用来查找 /etc/passwd 文件中第三个字段（以冒号为分隔符）值为0的记录。/etc/passwd 是一个在类Unix系统中用于存储用户账户信息的文件。字段值为0通常表示该账户是一个特殊账户，比如root用户。\n\npasswd -l xxxx    锁定账户,建议如果存在多个UID为0用户,先锁定再去排查，最后在确实是否删除或解除\nuserdel xxxx      删除用户\npasswd -u xxxx    解锁账户 \n\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241014141657-ldwd069","Type":"NodeParagraph","Properties":{"id":"20241014141657-ldwd069","updated":"20241014141657"}},{"ID":"20241014141657-u6dyz7c","Type":"NodeParagraph","Properties":{"id":"20241014141657-u6dyz7c","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241014103119-8ebkfri.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241014141657-9m8odsi","Type":"NodeParagraph","Properties":{"id":"20241014141657-9m8odsi","updated":"20241014141657"}},{"ID":"20241014141657-d5tqx3t","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241014141657-d5tqx3t","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"2.检查空口令-密码"}]},{"ID":"20241014141657-8fle91k","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241014141657-8fle91k","updated":"20241014141657"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bGludXg="},{"Type":"NodeCodeBlockCode","Data":"cat /etc/shadow\nawk -F: '($2==\"\")' /etc/shadow   // 查看是否有空口令，如果没有添加\n\n有空口令，设置\npasswd username #增加密码\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241014141657-7l98g1r","Type":"NodeParagraph","Properties":{"id":"20241014141657-7l98g1r","updated":"20241014141657"}},{"ID":"20241014141657-898yyox","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241014141657-898yyox","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"3.限制某些用户可以su到root（用于控制哪些用户可以使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"su"},{"Type":"NodeText","Data":"​ 命令来切换到其他用户账户。）"}]},{"ID":"20241014141657-pd5cbw5","Type":"NodeParagraph","Properties":{"id":"20241014141657-pd5cbw5","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"/etc/pam.d/su su命令的配置文件："}]},{"ID":"20241014141657-juwvr5u","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241014141657-juwvr5u","updated":"20241014141657"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bGludXg="},{"Type":"NodeCodeBlockCode","Data":"cat /etc/pam.d/su\n\nvim /etc/pam.d/su\n在以下内容添加\nauth required pam_wheel.so group=test   //设置用户组\nauth required pam_wheel.so test         //设置用户\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241014141657-htpwvmg","Type":"NodeParagraph","Properties":{"id":"20241014141657-htpwvmg","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241014103803-zxzvmp1.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241014141657-ijcpm8h","Type":"NodeParagraph","Properties":{"id":"20241014141657-ijcpm8h","updated":"20241014141657"}},{"ID":"20241014141657-sx427c7","Type":"NodeParagraph","Properties":{"id":"20241014141657-sx427c7","updated":"20241014141657"}},{"ID":"20241014141657-uqp5frr","Type":"NodeParagraph","Properties":{"id":"20241014141657-uqp5frr","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"禁止root用户直接登录（PS：危险配置，操作之前，一定要新建一个小号来远程登录）"}]},{"ID":"20241014141657-o6wo1jx","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241014141657-o6wo1jx","updated":"20241014141657"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bGludXg="},{"Type":"NodeCodeBlockCode","Data":"cat /etc/ssh/sshd_config | grep PermitRootLogin  //查看root用户是否可以直接远程登录\n\n重启生效\nsystemctl restart sshd /Service sshd restart\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241014141657-xvk5u4b","Type":"NodeParagraph","Properties":{"id":"20241014141657-xvk5u4b","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"修改为no--危险配置项"}]},{"ID":"20241014141657-p1v9liu","Type":"NodeParagraph","Properties":{"id":"20241014141657-p1v9liu","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241014104302-6ydzi6b.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241014141657-89ny0ey","Type":"NodeParagraph","Properties":{"id":"20241014141657-89ny0ey","updated":"20241014141657"}},{"ID":"20241014141657-9tvzyzw","Type":"NodeParagraph","Properties":{"id":"20241014141657-9tvzyzw","updated":"20241014141657"}},{"ID":"20241014141657-np5kc05","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241014141657-np5kc05","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"服务"}]},{"ID":"20241014141657-nnlhzxo","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241014141657-nnlhzxo","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"关闭不必要的服务"}]},{"ID":"20241014141657-kpncg8a","Type":"NodeParagraph","Properties":{"id":"20241014141657-kpncg8a","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"CentOS6等老系统禁用方法不一样：chkconfig --level \u003c级别\u003e \u003c服务名称\u003e off  //设置服务在某个几倍用户开机时不启动"}]},{"ID":"20241014141657-6nash3i","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241014141657-6nash3i","updated":"20241014141657"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bGludXg="},{"Type":"NodeCodeBlockCode","Data":"netstat -ntlp       //用来显示当前系统网络连接、路由表、接口统计信息、伪装连接以及网络接口设置的命令\n#这里查看相关服务\nsystemctl disable  服务名称  //关闭某服务不开启开机自动启动\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241014141657-jvk36dy","Type":"NodeParagraph","Properties":{"id":"20241014141657-jvk36dy","updated":"20241014141657"}},{"ID":"20241014141657-8ii1ad4","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241014141657-8ii1ad4","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"ssh服务配置"}]},{"ID":"20241014141657-5gmssda","Type":"NodeParagraph","Properties":{"id":"20241014141657-5gmssda","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"/etc/ssh/ssh-config"}]},{"ID":"20241014141657-m2tczea","Type":"NodeParagraph","Properties":{"id":"20241014141657-m2tczea","updated":"20241014141657"}},{"ID":"20241014141657-oidlxz7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241014141657-oidlxz7","updated":"20241014141657"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bGludXg="},{"Type":"NodeCodeBlockCode","Data":"vim /etc/ssh/ssh-config\n\nProtocol 2 #修改ssh使用协议版本2， 1.0,1.1,1.2,2.0\nMaxAuthTries 6    #默认关闭，且为6，可根据实际情况更改\n\n同需要重启服务\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241014141657-9p5f7hg","Type":"NodeParagraph","Properties":{"id":"20241014141657-9p5f7hg","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241014105226-uffxfvo.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"限制尝试密码的次数，"}]},{"ID":"20241014141657-ubrjds2","Type":"NodeParagraph","Properties":{"id":"20241014141657-ubrjds2","updated":"20241014141657"}},{"ID":"20241014141657-v3rj9ss","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241014141657-v3rj9ss","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"日志"}]},{"ID":"20241014141657-u580xy8","Type":"NodeParagraph","Properties":{"id":"20241014141657-u580xy8","updated":"20241014141657"}},{"ID":"20241014141657-77kq2es","Type":"NodeBlockquote","Properties":{"id":"20241014141657-77kq2es","updated":"20241014141657"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20241014141657-4jzj58g","Type":"NodeParagraph","Properties":{"id":"20241014141657-4jzj58g","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"syslogd负责接收、记录和转发系统日志消息的守护进程。"}]}]},{"ID":"20241014141657-cdv6npc","Type":"NodeParagraph","Properties":{"id":"20241014141657-cdv6npc","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"日志路径：/var/log"}]},{"ID":"20241014141657-t9y5i47","Type":"NodeParagraph","Properties":{"id":"20241014141657-t9y5i47","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"\t系统日志(默认)：/var/log/messages"}]},{"ID":"20241014141657-1uwkwgy","Type":"NodeParagraph","Properties":{"id":"20241014141657-1uwkwgy","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"\t计划任务日志（默认）：/var/log/cron"}]},{"ID":"20241014141657-fq4ppbc","Type":"NodeParagraph","Properties":{"id":"20241014141657-fq4ppbc","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"\t安全日志（默认）：/var/log/secure"}]},{"ID":"20241014141657-816ralm","Type":"NodeParagraph","Properties":{"id":"20241014141657-816ralm","updated":"20241014141657"}},{"ID":"20241014141657-qdn70nj","Type":"NodeParagraph","Properties":{"id":"20241014141657-qdn70nj","updated":"20241014141657"},"Children":[{"Type":"NodeText","Data":"检查是否开启 cat /etc/logrotate.d/syslog"}]},{"ID":"20241014141657-b5midfp","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241014141657-b5midfp","updated":"20241014141657"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bGludXg="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost 1og]# cat /etc/logrotate.d/syslog\n/var/log/cron\n/var/1og/mai11og\n/var/1og/messages\n/var/log/secure\n/var/1og/spooler\n{\n\tmissingok\n\tsharedscripts\n\tpostrotate\n\t/bin/ki11 -HUP `cat /var/run/syslogd.pid 2\u003e /dev/nu11` 2\u003e /dev/nu11 || true\n\tendscript\n}\n[root@localhost 1og]#\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241014141657-6jbyv4k","Type":"NodeParagraph","Properties":{"id":"20241014141657-6jbyv4k","updated":"20241014141657"}}]}