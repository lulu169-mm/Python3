{"ID":"20241014141703-4u62noj","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f945","id":"20241014141703-4u62noj","title":"安全加固-MYSQL","updated":"20241014151859"},"Children":[{"ID":"20241014141742-7ywi2n5","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241014141742-7ywi2n5","updated":"20241014142117"},"Children":[{"Type":"NodeText","Data":"1.账号安全"}]},{"ID":"20241014142120-7ozccva","Type":"NodeParagraph","Properties":{"id":"20241014142120-7ozccva","updated":"20241014142142"},"Children":[{"Type":"NodeText","Data":"/etc/my.cnf 配置文件默认路径，在文件mysqld下添加："}]},{"ID":"20241014142143-s7m5lfe","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241014142143-s7m5lfe","updated":"20241014142149"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"user=mysql\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241014142206-ok3b520","Type":"NodeParagraph","Properties":{"id":"20241014142206-ok3b520","updated":"20241014142206"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241014142206-vvi0d1z.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241014142222-24gmtcw","Type":"NodeParagraph","Properties":{"id":"20241014142222-24gmtcw"}},{"ID":"20241014141855-s370vpm","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241014141855-s370vpm","updated":"20241014142245"},"Children":[{"Type":"NodeText","Data":"创建普通用户方法"}]},{"ID":"20241014142725-za7nif0","Type":"NodeParagraph","Properties":{"id":"20241014142725-za7nif0","updated":"20241014142806"},"Children":[{"Type":"NodeText","Data":"PS：如果要更改root用户只能localhost访问，一定要先设置普通用户可以通过%方式登录"}]},{"ID":"20241014141947-oj7mcdx","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241014141947-oj7mcdx","updated":"20241014143654"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"MarinaDB[(none)]\u003egrant all on *.* to stsafe@'%' identified by '123456';  #创建一个名称为etsafe：123456，可以通过任意主机登录管理数据库\n\n#grant关键字用于授予权限，*.*数据库和表的通配符--任意，stsafe指用户名\n#%表示同门用户可以通过任意主机登录，如果过localhost则是使用的本机登录\n\nMarinaDB[(none)]\u003eflush privileges #刷新权限\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241014141751-pzkw6xv","Type":"NodeParagraph","Properties":{"id":"20241014141751-pzkw6xv"}},{"ID":"20241014141751-ful89o9","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","id":"20241014141751-ful89o9","updated":"20241014142541"},"Children":[{"Type":"NodeText","Data":"普通用户登录"}]},{"ID":"20241014142543-09ptxyt","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241014142543-09ptxyt","updated":"20241014142919"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"mysql -h ip -uetsafe -p #普通用户登录\nMarinaDB[(none)]\u003eexit #登陆成功后退出\n\nmysql -u root -p #切换到root用户\nMarinaDB[(none)]\u003edrop user etsafe #删除普通用户\nMarinaDB[(none)]\u003eexit\nmysql -h ip -uetsafe -p #普通用户登录则失效了\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241014141703-5rihwtx","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241014141703-5rihwtx","updated":"20241014141703"}},{"ID":"20241014142928-so4a36j","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241014142928-so4a36j","updated":"20241014143235"},"Children":[{"Type":"NodeText","Data":"2.口令安全"}]},{"ID":"20241014142940-pclf500","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241014142940-pclf500","updated":"20241014143422"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"#登录root：root\nMarinaDB[(none)]\u003euse mysql\nMarinaDB[(none)]\u003eupdate user set password=password('ETsafe666') where user='root';\n\nMarinaDB[(none)]\u003eflush privileges;   //刷新权限\nMarinaDB[(none)]\u003eexit\n\nmysql -u root -p #重新登陆，此次密码是ETsafe666\nMarinaDB[(none)]\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241014143732-8823t6q","Type":"NodeParagraph","Properties":{"id":"20241014143732-8823t6q"}},{"ID":"20241014143733-5vxqcix","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241014143733-5vxqcix","updated":"20241014145645"},"Children":[{"Type":"NodeText","Data":"3.不限制IP登录"}]},{"ID":"20241014143733-fe4860m","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241014143733-fe4860m","updated":"20241014144528"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"mysql -u root -p      #登录mysql root:root\nMarinaDB[(none)]\u003egrant all on *.* to etsafe@'%' identified by '123456';  #创建拥有所有权限的etsafe@'%'用户密码为123456\nMarinaDB[(none)]\u003eflush privileges;   //刷新权限\nMarinaDB[(none)]\u003eshow grants for etsafe@'%';   #查看用户etsafe@'%'的权限\n\n+--------------------------------------------------------+\n| Grants for etsafe@%                                    |\n+--------------------------------------------------------+\n| GRANT ALL PRIVILEGES ON *.* TO 'etsafe'@'%'            |\n| WITH GRANT OPTION                                      |\n+--------------------------------------------------------+\n\n\n#使用revoke回收部分危险权限，然后刷新新的权限。revoke关键字用于撤销之前授予的权限。\nMarinaDB[(none)]\u003erevoke insert,update,alter,delete,create,drop,shutdown on *.* from etsafe@'%';\nMarinaDB[(none)]\u003eflush privileges;\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241014145119-8musv9l","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241014145119-8musv9l","updated":"20241014145525"},"Children":[{"Type":"NodeText","Data":"4.允许本地连接：将%改为localhost"}]},{"ID":"20241014145207-13lrpv5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241014145207-13lrpv5","updated":"20241014145301"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"mysql -u root -p      #登录mysql root:root\nMarinaDB[(none)]\u003egrant all on *.* to etsafe@'localhost' identified by '123456';  #创建拥有所有权限的etsafe@'%'用户密码为123456\nMarinaDB[(none)]\u003eflush privileges;   //刷新权限\n\nlocalhost是\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241014145159-qq8ou3c","Type":"NodeParagraph","Properties":{"id":"20241014145159-qq8ou3c"},"Children":[{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241014145119-pp3xb1x.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241014145649-l5mk77l","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241014145649-l5mk77l","updated":"20241014145653"},"Children":[{"Type":"NodeText","Data":"5.日志安全"}]},{"ID":"20241014145656-3y8n4sw","Type":"NodeParagraph","Properties":{"id":"20241014145656-3y8n4sw","updated":"20241014145700"},"Children":[{"Type":"NodeText","Data":"查询日志"}]},{"ID":"20241014145700-pmgwgay","Type":"NodeParagraph","Properties":{"id":"20241014145700-pmgwgay","updated":"20241014145702"},"Children":[{"Type":"NodeText","Data":"慢日志"}]},{"ID":"20241014151151-oz4dqko","Type":"NodeParagraph","Properties":{"id":"20241014151151-oz4dqko","updated":"20241014151156"},"Children":[{"Type":"NodeText","Data":"二进制日志"}]},{"ID":"20241014145702-wd1tt1k","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241014145702-wd1tt1k","updated":"20241014151730"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":" vim /var/log/my.cnf\n\n1og=/var/log/mariadb/mariadb-log.log#查询日志\n\n1og-slow-queries=/var/log/mariadb/slow.log #慢日志\n\n\n1og-bin=/var/log/mariadb/bin.log #二进制\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241014151549-h4syqk9","Type":"NodeParagraph","Properties":{"id":"20241014151549-h4syqk9","updated":"20241014151549"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241014151549-a7u5y4w.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241014151552-16r18rp","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241014151552-16r18rp","updated":"20241014151606"},"Children":[{"Type":"NodeText","Data":"6.链接数量设置"}]},{"ID":"20241014151607-qfxrcu4","Type":"NodeParagraph","Properties":{"id":"20241014151607-qfxrcu4","updated":"20241014151709"},"Children":[{"Type":"NodeText","Data":"编辑配置文件 /etc/my.cnf"}]},{"ID":"20241014151638-atab842","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241014151638-atab842","updated":"20241014151656"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"max_connections = 1000 #添加\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241014151628-uq2pkur","Type":"NodeParagraph","Properties":{"id":"20241014151628-uq2pkur","updated":"20241014151650"}},{"ID":"20241014151659-0l7sopg","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241014151659-0l7sopg","updated":"20241014151722"},"Children":[{"Type":"NodeText","Data":"7.禁止远程链接"}]},{"ID":"20241014151834-kfe5q1d","Type":"NodeParagraph","Properties":{"id":"20241014151834-kfe5q1d","updated":"20241014151845"},"Children":[{"Type":"NodeText","Data":"编辑配置文件，添加以下内容"}]},{"ID":"20241014151847-ad3bhue","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241014151847-ad3bhue","updated":"20241014151859"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"skip-networking #添加即可\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}