{"ID":"20241017085117-oxs97ch","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f695","id":"20241017085117-oxs97ch","scroll":"\u0026#123;\u0026quot;rootId\u0026quot;:\u0026quot;20241017085117-oxs97ch\u0026quot;,\u0026quot;startId\u0026quot;:\u0026quot;20241017085117-8tu4ksi\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20241017085117-8tu4ksi\u0026quot;,\u0026quot;scrollTop\u0026quot;:0,\u0026quot;focusId\u0026quot;:\u0026quot;20241017085117-8tu4ksi\u0026quot;,\u0026quot;focusStart\u0026quot;:0,\u0026quot;focusEnd\u0026quot;:0\u0026#125;","title":"Linux入侵排查","updated":"20241017191241"},"Children":[{"ID":"20241017091908-mjxfngr","Type":"NodeParagraph","Properties":{"id":"20241017091908-mjxfngr"}},{"ID":"20241017085117-8tu4ksi","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241017085117-8tu4ksi","updated":"20241017091903"},"Children":[{"Type":"NodeText","Data":"1.账号安全"}]},{"ID":"20241017182728-6exgas1","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017182728-6exgas1","updated":"20241017182734"},"Children":[{"Type":"NodeText","Data":"基本使用"}]},{"ID":"20241017091909-3d4mlee","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017091909-3d4mlee","updated":"20241017182452"},"Children":[{"Type":"NodeText","Data":"1)用户信息文件 /etc/passwd"}]},{"ID":"20241017092130-7h7n1pf","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092130-7h7n1pf","updated":"20241017092130"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017092130-fjdsjxf.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017092052-e9gl80h","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092052-e9gl80h","updated":"20241017092124"},"Children":[{"Type":"NodeText","Data":"用户：密码：用户ID：组ID：用户说明：用户家目录：登录shell"}]},{"ID":"20241017092132-nqr7eqh","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092132-nqr7eqh","updated":"20241017182625"},"Children":[{"Type":"NodeText","Data":"PS："},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"密码为空不能远程登录，只能本机登录"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，X是占位符，存在在shadow文件中"}]},{"ID":"20241017092125-c8p78lz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092125-c8p78lz"}},{"ID":"20241017092216-dnj8pkk","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092216-dnj8pkk","updated":"20241017182508"},"Children":[{"Type":"NodeText","Data":"2)/etc/shadow文件"}]},{"ID":"20241017092300-7f4f742","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092300-7f4f742","updated":"20241017092300"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017092300-46u6a92.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017092302-d5myvfz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092302-d5myvfz","updated":"20241017092529"},"Children":[{"Type":"NodeText","Data":"用户名：加密密码：密码最后一次修改日期：两次密码修改的间隔时间：密码有效期：密码到期警告天数：宽限天数：账号失效的时间：预留"}]},{"ID":"20241017092731-gbxxy3u","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092731-gbxxy3u"}},{"ID":"20241017092732-ms4tktf","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092732-ms4tktf","updated":"20241017092740"},"Children":[{"Type":"NodeText","Data":"查看当前登录用户状态"}]},{"ID":"20241017182545-gy98dbr","Type":"NodeBlockquote","Properties":{"fold":"1","heading-fold":"1","id":"20241017182545-gy98dbr","updated":"20241017182607"},"Children":[{"ID":"20241017182546-zakvrhh","Type":"NodeParagraph","Properties":{"id":"20241017182546-zakvrhh","updated":"20241017182607"},"Children":[{"Type":"NodeText","Data":"who 查看当前登录的用户    "},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"pts远程登录    pty本地登录"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241017182546-5l2tyci","Type":"NodeParagraph","Properties":{"id":"20241017182546-5l2tyci","updated":"20241017182546"},"Children":[{"Type":"NodeText","Data":"w 查看系统信息 记录用户登录时间和交互方式"}]},{"ID":"20241017182546-fwniw7m","Type":"NodeParagraph","Properties":{"id":"20241017182546-fwniw7m","updated":"20241017182546"},"Children":[{"Type":"NodeText","Data":"uptime 查看登录多久，有多少用户，系统负载状态"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241017092743-xk8ep7h","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092743-xk8ep7h","updated":"20241017092743"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017092743-nj3grov.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017092931-wn68xli","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092931-wn68xli"}},{"ID":"20241017092935-hesi38x","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092935-hesi38x","updated":"20241017182854"},"Children":[{"Type":"NodeText","Data":"入侵排查"}]},{"ID":"20241017092947-mrqc8fw","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092947-mrqc8fw","updated":"20241017182903"},"Children":[{"Type":"NodeText","Data":"1）是否存在特权用户"}]},{"ID":"20241017093022-d3s4o42","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017093022-d3s4o42","updated":"20241017093234"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"awk -F: '$3==0{print $1}' /etc/passwd    #uid=0--》root\n关注root之外的用户\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017093155-o7gg0uc","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017093155-o7gg0uc","updated":"20241017093155"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017093155-unos5k7.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017092949-ovjxn07","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092949-ovjxn07","updated":"20241017182915"},"Children":[{"Type":"NodeText","Data":"2）是否有远程登录用户"}]},{"ID":"20241017093238-6pomzkb","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017093238-6pomzkb","updated":"20241017093639"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"awk '/\\$1|\\$6/{print $1}' /etc/shadow\n#关注密码字段的存储方式中指定$6的密码字段，$6是指可以远程登录的\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017093559-ich89v7","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017093559-ich89v7","updated":"20241017093559"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017093559-i3pcpky.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017092956-fhyees5","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092956-fhyees5","updated":"20241017183007"},"Children":[{"Type":"NodeText","Data":"3）哪些用户可以访问sudo权限，普通用户非管理需要应删除sudo权限"}]},{"ID":"20241017094044-wtblo8a","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017094044-wtblo8a","updated":"20241017183121"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost ~]# more /etc/sudoers |grep -v \"^#\\|^$\" |grep \"ALL=(ALL)\"\nroot\tALL=(ALL) \tALL\n%wheel\tALL=(ALL)\tALL\n\n#正常情况来说，不能设置wheel组\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017094141-jsp6pn4","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017094141-jsp6pn4","updated":"20241017094141"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017094141-9f6sz3r.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017094225-k649ahr","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017094225-k649ahr"}},{"ID":"20241017093008-p1j31vt","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017093008-p1j31vt","updated":"20241017183035"},"Children":[{"Type":"NodeText","Data":"4）删除或禁用可以账号（注意:发现存在意思用户后，要先去禁用核查，然后在确定是否删除）"}]},{"ID":"20241017094303-awdiw8o","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017094303-awdiw8o","updated":"20241017183333"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"usermod -L username  #禁用username，在用户前添加！\nuserdel username     #仅删除用户\nuserdel -r username\t #删除用户及其家目录\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017183357-ijask18","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017183357-ijask18","updated":"20241017183357"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017183357-y7oyv1d.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017183356-0ciemt4","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017183356-0ciemt4"}},{"ID":"20241017094827-wfhsqoy","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241017094827-wfhsqoy","updated":"20241017183417"},"Children":[{"Type":"NodeText","Data":"2.历史命令"}]},{"ID":"20241017184423-1dlzzb1","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017184423-1dlzzb1","updated":"20241017184456"},"Children":[{"Type":"NodeText","Data":".bash history的文件记录着这个用户都执行过什么命令;主要分析"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"是否有账户执行过恶意操作"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241017183435-e3lyjdf","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017183435-e3lyjdf","updated":"20241017183437"},"Children":[{"Type":"NodeText","Data":"基本使用"}]},{"ID":"20241017094846-t68ahr2","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017094846-t68ahr2","updated":"20241017183446"},"Children":[{"Type":"NodeText","Data":"1）root用户的历史命令 /root/.bash_history"}]},{"ID":"20241017094830-tj75c5i","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017094830-tj75c5i","updated":"20241017094906"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"history 查看\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017094628-9yj7cxr","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017094628-9yj7cxr","updated":"20241017183817"},"Children":[{"Type":"NodeText","Data":"2）普通用户的历史命令，存在普通用户的/home目录下的.bash_history"}]},{"ID":"20241017095916-7cmnipo","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017095916-7cmnipo","updated":"20241017100103"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"history 普通用户权限查看\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017095903-i39l8h3","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017095903-i39l8h3","updated":"20241017183826"},"Children":[{"Type":"NodeText","Data":"2.1）给history配置记录多少条命令"}]},{"ID":"20241017100130-qbll2y8","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017100130-qbll2y8","updated":"20241017100132"},"Children":[{"Type":"NodeText","Data":"法一："}]},{"ID":"20241017100133-njdqfmg","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017100133-njdqfmg","updated":"20241017184313"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"\n[root@localhost ~]# sed -i 's/^HISTSIZE=1000/HISTSIZE=10000/g' /etc/profile\n[root@localhost ~]# cat /etc/profile |grep HISTSIZE\nHISTSIZE=10000\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017184948-5vowqts","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017184948-5vowqts","updated":"20241017184948"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017184948-7om095h.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017100111-newymon","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017100111-newymon","updated":"20241017184345"},"Children":[{"Type":"NodeText","Data":"法二：将以下内容加入/etc/profile即可"}]},{"ID":"20241017184327-kjmw307","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017184327-kjmw307","updated":"20241017184518"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"USER_IP=`who -u am i 2\u003e/dev/null | awk '{print $NF}' | sed -e 's/[()]//g'`\nif [ \"$USER_IP\" = \"\" ]\nthen\nUSER_IP=`hostname`\nfi\nexport HISTTIMEFORMAT=\"%F %T $USER_IP `whoami` \"\nshopt -s histappend\nexport PROMPT_COMMAND=\"history -a\"\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017101719-kqwnbg9","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017101719-kqwnbg9"}},{"ID":"20241017185133-r18pt41","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017185133-r18pt41","updated":"20241017185133"},"Children":[{"Type":"NodeText","Data":"入侵排查"}]},{"ID":"20241017185133-1g2ulqe","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017185133-1g2ulqe","updated":"20241017185133"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"将命令记录文件导出之后分析，导出方法如下："}]},{"ID":"20241017185122-390v5kc","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017185122-390v5kc","updated":"20241017185146"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"1、进入用户目录\ncat .bash_history \u003e\u003e history.txt \n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017185122-xs3ekl6","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241017185122-xs3ekl6","updated":"20241017185200"},"Children":[{"Type":"NodeText","Data":"3.异常端口"}]},{"ID":"20241017185211-3iesfes","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017185211-3iesfes","updated":"20241017185241"},"Children":[{"Type":"NodeText","Data":"查看端口装填，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"分析可疑"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"的端口和IP以及"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"PID追朔"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"其运行文件源头"}]},{"ID":"20241017190737-ah6mj5f","Type":"NodeList","ListData":{},"Properties":{"fold":"1","heading-fold":"1","id":"20241017190737-ah6mj5f","updated":"20241017190744"},"Children":[{"ID":"20241017190737-a89p71c","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241017190737-a89p71c","updated":"20241017190741"},"Children":[{"ID":"20241017190712-3qkzhsh","Type":"NodeParagraph","Properties":{"id":"20241017190712-3qkzhsh","updated":"20241017190741"},"Children":[{"Type":"NodeText","Data":"netstat 网络连接命令  查看服务器"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"是否有未被授权的端口被监听"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]}]},{"ID":"20241017190737-cmk9heh","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241017190737-cmk9heh","updated":"20241017190744"},"Children":[{"ID":"20241017190731-1n39xvk","Type":"NodeParagraph","Properties":{"id":"20241017190731-1n39xvk","updated":"20241017190744"},"Children":[{"Type":"NodeText","Data":"检查服务器"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"是否存在恶意进程"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，恶意进程往往会开启监听端口，与外部控制机器进行连接"}]}]}]},{"ID":"20241017101720-v88nq5j","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017101720-v88nq5j","updated":"20241017185304"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"netstat -antlp            #查看进程ID和端口状态\nls -l /proc/\u003cPID\u003e/exe\t  #定位其运行的文件路径\n\n判断文件路径是否是软链或bash文件\n根据获取的路径查看，如下图ls -al /user/bin/ |grep mongod\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017185743-g6xrpg9","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017185743-g6xrpg9","updated":"20241017185743"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017185743-fuuxez7.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017185741-g2iarcf","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017185741-g2iarcf"}},{"ID":"20241017185741-f1scmt3","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241017185741-f1scmt3","updated":"20241017185824"},"Children":[{"Type":"NodeText","Data":"4.检查进程"}]},{"ID":"20241017185741-nejxym7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017185741-nejxym7","updated":"20241017185844"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"netstat -antlp  #获取进程ID\nps -aux | grep 《PID》\t#获取当前可疑进程使用的启动命令，可以定位路径\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017190507-mquwf02","Type":"NodeParagraph","Properties":{"id":"20241017190507-mquwf02","updated":"20241017190507"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017190507-pp9ts7i.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017185742-m4nrcjs","Type":"NodeParagraph","Properties":{"id":"20241017185742-m4nrcjs"}},{"ID":"20241017101720-unkj8m6","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241017101720-unkj8m6","updated":"20241017191012"},"Children":[{"Type":"NodeText","Data":"5.开机启动项目"}]},{"ID":"20241017101840-dkt1ghh","Type":"NodeParagraph","Properties":{"id":"20241017101840-dkt1ghh","updated":"20241017101846"},"Children":[{"Type":"NodeText","Data":"基本姿势："}]},{"ID":"20241017101848-epswqx7","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241017101848-epswqx7","updated":"20241017101852"},"Children":[{"Type":"NodeText","Data":"运行级别runlevel"}]},{"ID":"20241017101911-goo4uer","Type":"NodeTable","TableAligns":[0,0],"Properties":{"colgroup":"min-width: 60px;|min-width: 60px;","id":"20241017101911-goo4uer","updated":"20241017102047"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"级别"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"定义"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"0"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"关机"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"1"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"单用户模式，相当与Windows安全模式"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"2"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"不完全的命令行模式，没有NFS"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"3"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"完全的命令行模式"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"4"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"系统保留"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"5"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"图形化"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"6"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"重启"}]}]}]},{"ID":"20241017102212-j2i95kt","Type":"NodeParagraph","Properties":{"id":"20241017102212-j2i95kt"}},{"ID":"20241017102213-kb0l8b4","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241017102213-kb0l8b4","updated":"20241017191147"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"默认配置级别文件   /etc/inittab"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241017102221-txr169x","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017102221-txr169x","updated":"20241017191114"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost ~]# cat /etc/inittab\n# inittab is no longer used when using systemd.\n#\n# ADDING CONFIGURATION HERE WILL HAVE NO EFFECT ON YOUR SYSTEM.\n#\n# Ctrl-Alt-Delete is handled by /usr/lib/systemd/system/ctrl-alt-del.target\n#\n# systemd uses 'targets' instead of runlevels. By default, there are two main targets:\n#\n# multi-user.target: analogous to runlevel 3\n# graphical.target: analogous to runlevel 5\n#\n# To view current default target, run:\n# systemctl get-default\n#\n# To set a default target, run:\n# systemctl set-default TARGET.target\n#\n[root@localhost ~]# more /etc/rc.local\n#!/bin/bash\n# THIS FILE IS ADDED FOR COMPATIBILITY PURPOSES\n#\n# It is highly advisable to create own systemd services or udev rules\n# to run scripts during boot instead of using this file.\n#\n# In contrast to previous versions due to parallel execution during boot\n# this script will NOT be run after all other services.\n#\n# Please note that you must run 'chmod +x /etc/rc.d/rc.local' to ensure\n# that this script will be executed during boot.\n\ntouch /var/lock/subsys/local"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017102255-abgxykd","Type":"NodeParagraph","Properties":{"id":"20241017102255-abgxykd"}},{"ID":"20241017102259-kjthgd7","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241017102259-kjthgd7","updated":"20241017191205"},"Children":[{"Type":"NodeText","Data":"开启自启动配置文件"}]},{"ID":"20241017191230-bwfca0q","Type":"NodeBlockquote","Properties":{"id":"20241017191230-bwfca0q","updated":"20241017191241"},"Children":[{"ID":"20241017112507-14ptx5m","Type":"NodeParagraph","Properties":{"id":"20241017112507-14ptx5m","updated":"20241017191241"},"Children":[{"Type":"NodeText","Data":"默认位置："},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"/etc/rc.d"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"\t#0-6共计7个级别的启动文件，完全命令行默认在rc3.d文件内\n创建自启动文件方式：\n"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"ln -s /etc/init.d/tomcat /etc/rc.d/rc3.d/s100tomcat"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"\t#创建软链自启动tomcat\ns：自启动\nK：代表启动加载时会关闭"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241017112507-prtusmf","Type":"NodeParagraph","Properties":{"id":"20241017112507-prtusmf"}},{"ID":"20241017112507-4lirx6u","Type":"NodeParagraph","Properties":{"id":"20241017112507-4lirx6u"}},{"ID":"20241017112619-2hhnxsl","Type":"NodeParagraph","Properties":{"id":"20241017112619-2hhnxsl"}},{"ID":"20241017112620-y3v2nwl","Type":"NodeParagraph","Properties":{"id":"20241017112620-y3v2nwl"}},{"ID":"20241017112620-r1vjiks","Type":"NodeParagraph","Properties":{"id":"20241017112620-r1vjiks"}},{"ID":"20241017112620-92gjc6l","Type":"NodeParagraph","Properties":{"id":"20241017112620-92gjc6l"}},{"ID":"20241017112620-3ki8txw","Type":"NodeParagraph","Properties":{"id":"20241017112620-3ki8txw"}},{"ID":"20241017112620-b6g0vj4","Type":"NodeParagraph","Properties":{"id":"20241017112620-b6g0vj4"}},{"ID":"20241017112620-vqe17tu","Type":"NodeParagraph","Properties":{"id":"20241017112620-vqe17tu"}},{"ID":"20241017112620-3hy786w","Type":"NodeParagraph","Properties":{"id":"20241017112620-3hy786w"}},{"ID":"20241017112620-mb2xqq9","Type":"NodeParagraph","Properties":{"id":"20241017112620-mb2xqq9"}},{"ID":"20241017112620-1dc7twp","Type":"NodeParagraph","Properties":{"id":"20241017112620-1dc7twp"}},{"ID":"20241017112620-lx8yny4","Type":"NodeParagraph","Properties":{"id":"20241017112620-lx8yny4"}},{"ID":"20241017112620-30go40u","Type":"NodeParagraph","Properties":{"id":"20241017112620-30go40u"}},{"ID":"20241017112507-brlrlv9","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017112507-brlrlv9","updated":"20241017112829"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"cron -e -u root #给root用户创建计划任务\n***** echo \"hello\" \u003e\u003e /tmp/\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017112508-qff2337","Type":"NodeParagraph","Properties":{"id":"20241017112508-qff2337","updated":"20241017112638"},"Children":[{"Type":"NodeText","Data":"6.3删除计划任务"}]},{"ID":"20241017112522-nfhyyse","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017112522-nfhyyse","updated":"20241017112628"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"crontab -r -u root   #谨慎使用，会全部删除\ncrontab -l\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017112601-o8v28k3","Type":"NodeParagraph","Properties":{"id":"20241017112601-o8v28k3"}},{"ID":"20241017112602-3g9kkps","Type":"NodeParagraph","Properties":{"id":"20241017112602-3g9kkps","updated":"20241017112603"},"Children":[{"Type":"NodeText","Data":"思路："}]},{"ID":"20241017112604-qf3s7nf","Type":"NodeParagraph","Properties":{"id":"20241017112604-qf3s7nf","updated":"20241017112608"},"Children":[{"Type":"NodeText","Data":"重点排查 "}]},{"ID":"20241017112910-m8ofcif","Type":"NodeParagraph","Properties":{"id":"20241017112910-m8ofcif"}},{"ID":"20241017112911-6jh0mfn","Type":"NodeParagraph","Properties":{"id":"20241017112911-6jh0mfn"}},{"ID":"20241017112911-pywnpdj","Type":"NodeParagraph","Properties":{"id":"20241017112911-pywnpdj"}},{"ID":"20241017112911-glamg4e","Type":"NodeParagraph","Properties":{"id":"20241017112911-glamg4e","updated":"20241017112919"},"Children":[{"Type":"NodeText","Data":"检查服务"}]},{"ID":"20241017113244-04wgkkf","Type":"NodeParagraph","Properties":{"id":"20241017113244-04wgkkf","updated":"20241017113251"},"Children":[{"Type":"NodeText","Data":"服务自启动"}]},{"ID":"20241017113252-5t4bgdg","Type":"NodeParagraph","Properties":{"id":"20241017113252-5t4bgdg","updated":"20241017113255"},"Children":[{"Type":"NodeText","Data":"默认开启"}]},{"ID":"20241017113150-lwjfmhw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017113150-lwjfmhw","updated":"20241017113317"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"/etc/sysconfig/network-script/\n\ncd /etc/sysconfig/networking\nmore ./ifcfg-lo\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017144415-n4lc5a9","Type":"NodeParagraph","Properties":{"id":"20241017144415-n4lc5a9","updated":"20241017144415"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017144414-84r52iu.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017150303-ztnvy32","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20241017150303-ztnvy32","updated":"20241017150313"},"Children":[{"Type":"NodeText","Data":"常用工具"}]},{"ID":"20241017150317-paeff5n","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241017150317-paeff5n"},"Children":[{"Type":"NodeText","Data":"rootkit查杀"}]},{"ID":"20241017150322-bko24t8","Type":"NodeParagraph","Properties":{"id":"20241017150322-bko24t8"},"Children":[{"Type":"NodeText","Data":"rootkit是特殊恶意文件，功能是隐藏自身或者进程，文件，网络链接。。。。rootkit一般和木马后门联合使用"}]},{"ID":"20241017150334-88qg0wd","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241017150334-88qg0wd","updated":"20241017150351"},"Children":[{"Type":"NodeText","Data":"两种类型:"}]},{"ID":"20241017150353-a8ftbaf","Type":"NodeParagraph","Properties":{"id":"20241017150353-a8ftbaf"},"Children":[{"Type":"NodeText","Data":"文件级别的修改重要文件，隐藏在文件内。如:ipconfig find ls pa login等"}]},{"ID":"20241017150355-mnsyd1n","Type":"NodeParagraph","Properties":{"id":"20241017150355-mnsyd1n","updated":"20241017150358"},"Children":[{"Type":"NodeText","Data":"内核级别的修改系统的内同"}]},{"ID":"20241017150409-ug7wqf0","Type":"NodeParagraph","Properties":{"id":"20241017150409-ug7wqf0"}},{"ID":"20241017150410-i9a9k44","Type":"NodeParagraph","Properties":{"id":"20241017150410-i9a9k44"}},{"ID":"20241017150410-kb8ok2u","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241017150410-kb8ok2u","updated":"20241017150512"},"Children":[{"Type":"NodeText","Data":"chkrookit"}]},{"ID":"20241017152932-uo2po5y","Type":"NodeParagraph","Properties":{"id":"20241017152932-uo2po5y","updated":"20241017152935"},"Children":[{"Type":"NodeText","Data":"下载"}]},{"ID":"20241017152936-lsmyl09","Type":"NodeParagraph","Properties":{"id":"20241017152936-lsmyl09","updated":"20241017152948"},"Children":[{"Type":"NodeText","Data":"https://www.chkrootkit.org/download"}]},{"ID":"20241017152950-clpcfsh","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017152950-clpcfsh","updated":"20241017153010"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"下载命令:wget ftp://ftp.chkrootkit.org/pub/seg/pac/chkrootkit.tar.gz\ntar -zxvf chkrootkit.tar.gz\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017153236-wwnzww4","Type":"NodeParagraph","Properties":{"id":"20241017153236-wwnzww4","updated":"20241017153236"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017153236-c4pliao.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017153237-gl0cahf","Type":"NodeParagraph","Properties":{"id":"20241017153237-gl0cahf","updated":"20241017153247"},"Children":[{"Type":"NodeText","Data":"2.rkhunter"}]},{"ID":"20241017153247-nhzfz1u","Type":"NodeParagraph","Properties":{"id":"20241017153247-nhzfz1u","updated":"20241017153257"},"Children":[{"Type":"NodeText","Data":"https://sourceforge.net/projects/rkhunter/files/rkhunter/1.4.6/"}]},{"ID":"20241017153611-9w5n56h","Type":"NodeParagraph","Properties":{"id":"20241017153611-9w5n56h","updated":"20241017153611"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017153611-0sb861o.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017154004-0vhih8i","Type":"NodeParagraph","Properties":{"id":"20241017154004-0vhih8i"}},{"ID":"20241017160734-a949emw","Type":"NodeParagraph","Properties":{"id":"20241017160734-a949emw"}},{"ID":"20241017160734-esnvwlt","Type":"NodeParagraph","Properties":{"id":"20241017160734-esnvwlt","updated":"20241017160737"},"Children":[{"Type":"NodeText","Data":"安全脚本"}]},{"ID":"20241017160847-gxer28o","Type":"NodeParagraph","Properties":{"id":"20241017160847-gxer28o","updated":"20241017160852"},"Children":[{"Type":"NodeText","Data":"CheckList"}]}]}