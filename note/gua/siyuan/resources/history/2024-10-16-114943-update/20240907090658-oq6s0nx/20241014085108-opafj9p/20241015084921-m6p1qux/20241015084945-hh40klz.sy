{"ID":"20241015084945-hh40klz","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f4f6","id":"20241015084945-hh40klz","scroll":"\u0026#123;\u0026quot;rootId\u0026quot;:\u0026quot;20241015084945-hh40klz\u0026quot;,\u0026quot;startId\u0026quot;:\u0026quot;20241015141803-wkaamnc\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20241016114403-2l1hcdw\u0026quot;,\u0026quot;scrollTop\u0026quot;:5200,\u0026quot;focusId\u0026quot;:\u0026quot;20241016095941-maxiuu6\u0026quot;,\u0026quot;focusStart\u0026quot;:2,\u0026quot;focusEnd\u0026quot;:2\u0026#125;","title":"Linux日志分析","updated":"20241016114639"},"Children":[{"ID":"20241015141803-wkaamnc","Type":"NodeParagraph","Properties":{"id":"20241015141803-wkaamnc","updated":"20241015141820"},"Children":[{"Type":"NodeText","Data":"日志默认保存位置：/var/log/"}]},{"ID":"20241015141836-s59r3it","Type":"NodeParagraph","Properties":{"id":"20241015141836-s59r3it","updated":"20241015142243"},"Children":[{"Type":"NodeText","Data":"配置文件： /etc/rsyslog.conf"}]},{"ID":"20241015141719-8skmkbc","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241015141719-8skmkbc","updated":"20241015141722"},"Children":[{"Type":"NodeText","Data":"日志分类"}]},{"ID":"20241015141738-idtliy5","Type":"NodeList","ListData":{},"Properties":{"id":"20241015141738-idtliy5","updated":"20241015141753"},"Children":[{"ID":"20241015141753-gtz6tfi","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241015141753-gtz6tfi","updated":"20241015141753"},"Children":[{"ID":"20241015141753-2ze693r","Type":"NodeParagraph","Properties":{"id":"20241015141753-2ze693r","updated":"20241015141753"},"Children":[{"Type":"NodeText","Data":"内核及系统日志：由系统服务rsyslog统一进行管理，日志格式基本相似\n"}]}]},{"ID":"20241015141754-qodplji","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241015141754-qodplji"},"Children":[{"ID":"20241015141754-rq2s24w","Type":"NodeParagraph","Properties":{"id":"20241015141754-rq2s24w"},"Children":[{"Type":"NodeText","Data":"用户日志：记录系统用户登录及退出系统的相关信息\n"}]}]},{"ID":"20241015141755-rcivr2a","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241015141755-rcivr2a"},"Children":[{"ID":"20241015141755-2mypx9r","Type":"NodeParagraph","Properties":{"id":"20241015141755-2mypx9r"},"Children":[{"Type":"NodeText","Data":"程序日志：由相应的应用程序进行独立管理。如:web服务，ftp服务"}]}]}]},{"ID":"20241015141714-fbdr4y0","Type":"NodeParagraph","Properties":{"id":"20241015141714-fbdr4y0","updated":"20241015141714"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20241015141937-s3kok20","Type":"NodeTable","TableAligns":[0,0,0],"Properties":{"colgroup":"min-width: 60px;|min-width: 60px;|min-width: 60px;","id":"20241015141937-s3kok20","updated":"20241016114608"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"文件名称"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"说明"}]},{"Type":"NodeTableCell","Data":"th"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"/var/log/cron"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"记录系统定时任务"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"/var/log/cups"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"记录打印信息日志"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"/var/log/dmesg"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"开机内核自检信息"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"/var/log/maillog"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"记录邮件信息"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"/var/log/message"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"记录系统重要信息日志"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"包括系统中大多数重要的信息，首先检查"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"/var/log/btmp"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"错误登录日志，二进制格式；"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"查看方式：lastb /var/log/btmp"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"lastb"},{"Type":"NodeText","Data":"​​ 命令在类Unix系统中用于显示最后一次不成功的登录尝试的记录"},{"Type":"NodeBr","Data":"br"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 2%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241015142920-cazkkhz.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 2%;\"}"},{"Type":"NodeText","Data":"​"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"/var/log/lastlog"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"记录用户最后一次登录的时间，使用lastlog命令查看"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 4%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241015142804-ckytmlt.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 4%;\"}"},{"Type":"NodeText","Data":"​"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"/var/log/wtmp"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"永久记录用户登录、注销的信息，也会记录系统启动、重启、关机操作的"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"使用last命令查看"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 3%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241015143215-tkhzfks.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 3%;\"}"},{"Type":"NodeText","Data":"​"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"/var/log/utmp"},{"Type":"NodeBr","Data":"br"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"记录当前已经登录的用户，用户退出登录的变化，只记录登录用户。"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"使用w\\who\\users命令查看"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 3%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241015143840-o5h5xof.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 3%;\"}"},{"Type":"NodeText","Data":"​"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"/var/log/secure"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"记录验证和授权信息，只要涉及账号密码都会记录，如：ssh，su，sudo"}]},{"Type":"NodeTableCell","Data":"td"}]}]},{"ID":"20241015142953-xty4er1","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241015142953-xty4er1","updated":"20241015144243"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"utmp日志查看方式：\n\n[root@localhost log]# w     //显示当前登录到系统的用户以及他们正在做什么\n 22:36:28 up 16 min,  1 user,  load average: 0.00, 0.01, 0.05\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nroot     pts/0    192.168.134.1    22:20    4.00s  0.01s  0.00s w\n[root@localhost log]# who\nroot     pts/0        2024-10-15 22:20 (192.168.134.1)\n[root@localhost log]# users\nroot\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241015143432-xjwmopd","Type":"NodeParagraph","Properties":{"id":"20241015143432-xjwmopd","updated":"20241015143438"},"Children":[{"Type":"NodeText","Data":"查看历史记录命令："}]},{"ID":"20241015143438-yjaozmx","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241015143438-yjaozmx","updated":"20241015143442"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"history\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241015143444-dk3zmsf","Type":"NodeParagraph","Properties":{"id":"20241015143444-dk3zmsf","style":"color: var(--b3-font-color9);","updated":"20241016114622"},"Children":[{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-font-color9);","style":"color: var(--b3-font-color9);"},"TextMarkType":"strong text","TextMarkTextContent":"清理痕迹"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\" parent-style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241015143456-moy065z","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241015143456-moy065z","style":"color: var(--b3-font-color9);","updated":"20241015143620"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"\necho \u003e /var/log/btmp\necho \u003e /var/log/wtmp\necho \u003e /var/log/lastlog\nhistory -c #最后清理\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241015143701-1i8jps0","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241015143701-1i8jps0","updated":"20241015143708"},"Children":[{"Type":"NodeText","Data":"查看日志的命令"}]},{"ID":"20241015143711-r062mfe","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241015143711-r062mfe","updated":"20241015143716"},"Children":[{"Type":"NodeText","Data":"1.shell命令"}]},{"ID":"20241015143716-nd8nvn9","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241015143716-nd8nvn9","updated":"20241015144325"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"find grep egrep awk cat more sed\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241015144327-hrt49dn","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241015144327-hrt49dn","updated":"20241015144334"},"Children":[{"Type":"NodeText","Data":"文件相关"}]},{"ID":"20241015144338-7yutcq7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241015144338-7yutcq7","updated":"20241015144424"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"grep awk sed\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241015144428-4utbr2u","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20241015144428-4utbr2u","updated":"20241016093905"},"Children":[{"Type":"NodeText","Data":"1.grep显示前后几行的信息"}]},{"ID":"20241015144431-i76yo18","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241015144431-i76yo18","updated":"20241016093053"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"grep -C 5 68% cron-20210620    #查看文件cron-20210620中匹配68%字段及其后5排\ngrep -B 5 68% cron-20210620    #查看文件cron-20210620中匹配68%字段及其前5排\ngrep -C 5 68% cron-20210620    #查看文件cron-20210620中匹配68%字段及其前后5排\ngrep -rn \"cmdshell\"                #-r指递归查找目录或子目录下的文件，-n是显示匹配行的行号，这里在access_log找到了有SQL注入\n-R显示子目录，-i忽略大小写\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241016092426-av7mrod","Type":"NodeParagraph","Properties":{"id":"20241016092426-av7mrod","updated":"20241016092835"},"Children":[{"Type":"NodeText","Data":"PS：建议查询安全相关的语句，如,shell，cmdshell.php等相关语句去获取被攻击的位置和日志存放位置"}]},{"ID":"20241016092736-h1ypjjz","Type":"NodeParagraph","Properties":{"id":"20241016092736-h1ypjjz"},"Children":[{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241016092426-hxqbb5e.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241016093331-i54s3j3","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20241016093331-i54s3j3","updated":"20241016093900"},"Children":[{"Type":"NodeText","Data":"2.查看递归目录下的包含指定内容的文件，可以用来找webshell、日志的攻击痕迹"}]},{"ID":"20241016093347-1h39yez","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241016093347-1h39yez","updated":"20241016093534"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost log]# grep -Rn \"eval()\" /var/www/html\n/var/www/html/include/smarty/Smarty.class.php:1928:     * wrapper for eval() retaining $this\n[root@localhost log]# grep -Rn \"eval($\" /var/www/html\n[root@localhost log]# grep -Rn \"system(\" /var/www/html\n[root@localhost log]# grep -Rn \"assert(\" /var/www/html\n/var/www/html/phpmyadmin/js/jquery/src/jquery/sizzle/dist/sizzle.js:330:function assert( fn ) {\n/var/www/html/phpmyadmin/js/jquery/src/jquery/sizzle/dist/sizzle.js:502:\tsupport.attributes = assert(function( div ) {\n/var/www/html/phpmyadmin/js/jquery/src/jquery/sizzle/dist/sizzle.js:511:\tsupport.getElementsByTagName = assert(function( div ) {\n/var/www/html/phpmyadmin/js/jquery/src/jquery/sizzle/dist/sizzle.js:517:\tsupport.getElementsByClassName = rnative.test( doc.getElementsByClassName ) \u0026\u0026 assert(function( div ) {\n/var/www/html/phpmyadmin/js/jquery/src/jquery/sizzle/dist/sizzle.js:532:\tsupport.getById = assert(function( div ) {\n。。。。。\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241016093806-sc37a5b","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20241016093806-sc37a5b","updated":"20241016093856"},"Children":[{"Type":"NodeText","Data":"3.显示文件的某几行"}]},{"ID":"20241016093850-gs945ap","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241016093850-gs945ap","updated":"20241016094102"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost log]# cat  cron-20210620 | tail -n +0 | head -n 10   #查看文件第一行（tail -n +0）到第十行（head -n 10 ）\nJun 12 23:01:23 localhost crond[677]: (CRON) INFO (RANDOM_DELAY will be scaled with factor 98% if used.)\nJun 12 23:01:24 localhost crond[677]: (CRON) INFO (running with inotify support)\nJun 12 23:18:18 localhost crond[677]: (CRON) INFO (Shutting down)\nJun 12 23:18:34 localhost crond[652]: (CRON) INFO (RANDOM_DELAY will be scaled with factor 84% if used.)\nJun 12 23:18:34 localhost crond[652]: (CRON) INFO (running with inotify support)\nJun 12 23:38:22 localhost crond[650]: (CRON) INFO (RANDOM_DELAY will be scaled with factor 73% if used.)\nJun 12 23:38:22 localhost crond[650]: (CRON) INFO (running with inotify support)\nJun 12 23:52:36 localhost crond[647]: (CRON) INFO (RANDOM_DELAY will be scaled with factor 80% if used.)\nJun 12 23:52:36 localhost crond[647]: (CRON) INFO (running with inotify support)\nJun 13 00:01:01 localhost CROND[1644]: (root) CMD (run-parts /etc/cron.hourly)\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241016093807-qe00ocb","Type":"NodeParagraph","Properties":{"id":"20241016093807-qe00ocb"}},{"ID":"20241016093807-hluo1o9","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20241016093807-hluo1o9","updated":"20241016094217"},"Children":[{"Type":"NodeText","Data":"4.find找文件"}]},{"ID":"20241016094219-4axsyyf","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241016094219-4axsyyf","updated":"20241016094221"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost log]# find / -name *shell*\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241016094223-h7wlmbm","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20241016094223-h7wlmbm","updated":"20241016094725"},"Children":[{"Type":"NodeText","Data":"5.查找内容输出--查看有哪些用户"}]},{"ID":"20241016094336-2zowlue","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241016094336-2zowlue","updated":"20241016094742"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost log]# cat /etc/passwd | awk -F ':' '{print $1}'   \n#cat /etc/passwd读取文件内容，awk是文本处理工具，-F指使用:作为字段分隔符，'{print $1}'中$1代表每行的第一个字段---用户名\nroot\nbin\ndaemon\nadm\n。。。\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241016094741-xeh310a","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20241016094741-xeh310a","updated":"20241016095611"},"Children":[{"Type":"NodeText","Data":"6.清理/root/.bash_history文件的历史记录"}]},{"ID":"20241016095241-ntk3zru","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241016095241-ntk3zru","updated":"20241016095753"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost ~]# sed -i '10,$d' .bash_history  \n#删除历史记录，只保留10行\n[root@localhost ~]# cat .bash_history \nifconfig\nip address\nyum install vim\ndf\nclear\nyum install -y net-tools.x86_64\nifconfig\nnetstat -antlp\nclear\n[root@localhost ~]# history  #这里面的内容没删除掉，因为当前shell会话的命令历史仍然存储在内存中\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241016095327-budyfvg","Type":"NodeParagraph","Properties":{"id":"20241016095327-budyfvg","updated":"20241016095327"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241016095327-sphla0z.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241016095505-2zu0c3k","Type":"NodeParagraph","Properties":{"id":"20241016095505-2zu0c3k","updated":"20241016100622"},"Children":[{"Type":"NodeText","Data":"PS："},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"办法："},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"history -c"},{"Type":"NodeText","Data":"​ 清除当前会话的命令历史（过于危险）"}]},{"ID":"20241016100623-mr1li2b","Type":"NodeParagraph","Properties":{"id":"20241016100623-mr1li2b","updated":"20241016101007"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"strong text","TextMarkTextContent":"只删除部分"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"--清理痕迹"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241016100630-jrqkr6v","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241016100630-jrqkr6v","updated":"20241016100744"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"vim ./.bash_history  #进入vim编辑器，删除指定内容，保存并退出\nhistory -r           #使history的内容重新加载  \n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241016095941-maxiuu6","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241016095941-maxiuu6","updated":"20241016114639"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"技巧"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241016101046-m69jkny","Type":"NodeParagraph","Properties":{"id":"20241016101046-m69jkny","updated":"20241016114100"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"/var/log/secure  #安全日志"}]},{"ID":"20241016104758-e8lz7f1","Type":"NodeParagraph","Properties":{"id":"20241016104758-e8lz7f1","updated":"20241016105009"},"Children":[{"Type":"NodeText","Data":"1.有哪些ip在爆破主机的root账号"}]},{"ID":"20241016104700-obaru3z","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241016104700-obaru3z","updated":"20241016104856"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost log]# grep \"Failed password for root\" /var/log/secure |awk \"{print $11}\"\n[root@localhost log]# grep \"Failed password for root\" /var/log/secure |awk \"{print $11}\" | sort | uniq -c |sort -nr |more\n[root@localhost log]# grep \"Failed password for root\" /var/log/secure |awk '{print $11}' | sort | uniq -c |sort -nr |more\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241016104953-jd5xqab","Type":"NodeParagraph","Properties":{"id":"20241016104953-jd5xqab","updated":"20241016104954"},"Children":[{"Type":"NodeText","Data":"2、有哪些IP在爆破：罗列出所有IP地址"}]},{"ID":"20241016105002-ice81ww","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241016105002-ice81ww","updated":"20241016105002"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"\ngrep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]| [01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4] [0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241016104956-uaumi83","Type":"NodeParagraph","Properties":{"id":"20241016104956-uaumi83","updated":"20241016105026"},"Children":[{"Type":"NodeText","Data":"3.登录成功的IP"}]},{"ID":"20241016105028-bfr0kln","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241016105028-bfr0kln","updated":"20241016105150"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost home]# cat /var/log/secure |grep \"Accepted\"\t#使用cat查看\nOct 14 07:14:39 localhost sshd[3633]: Accepted password for root from 192.168.188.1 port 51323 ssh2\t#登录成功的特征\nOct 14 07:35:24 localhost sshd[4687]: Accepted password for root from 192.168.188.1 port 58697 ssh2\nOct 14 14:44:23 localhost sshd[26938]: Accepted password for root from 192.168.188.128 port 64137 ssh2\nOct 14 17:26:08 localhost sshd[35641]: Accepted password for root from 192.168.188.128 port 49478 ssh2\n\n #使用grep筛选查看\n[root@localhost home]# grep \"Accepted\" /var/log/secure |awk '{print $11}' | sort |uniq -c |sort -nr |more \n      2 192.168.188.128\n      2 192.168.188.1\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241016114113-6oxm6pq","Type":"NodeParagraph","Properties":{"id":"20241016114113-6oxm6pq"}},{"ID":"20241016114050-k7o5rom","Type":"NodeParagraph","Properties":{"id":"20241016114050-k7o5rom","updated":"20241016114119"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"/var/log/yum.log yum安装日志"}]},{"ID":"20241016114253-tg0p2s0","Type":"NodeParagraph","Properties":{"id":"20241016114253-tg0p2s0","updated":"20241016114309"},"Children":[{"Type":"NodeText","Data":"根据安装的yum去查看用意"}]},{"ID":"20241016114120-itkmvdu","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241016114120-itkmvdu","updated":"20241016114251"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost log]# more /var/log/yum.log-20241016\nJun 12 23:02:35 Installed: 1:perl-parent-0.225-244.el7.noarch\nJun 12 23:02:35 Installed: perl-HTTP-Tiny-0.033-3.el7.noarch\nJun 12 23:02:35 Installed: perl-podlators-2.5.1-3.el7.noarch\nJun 12 23:02:35 Installed: perl-Pod-Perldoc-3.20-4.el7.noarch\n。。。\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241016114355-inbh79p","Type":"NodeParagraph","Properties":{"id":"20241016114355-inbh79p"}},{"ID":"20241016114356-hxnowwx","Type":"NodeParagraph","Properties":{"id":"20241016114356-hxnowwx","updated":"20241016114402"},"Children":[{"Type":"NodeText","Data":"yum历史记录："}]},{"ID":"20241016114403-2l1hcdw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241016114403-2l1hcdw","updated":"20241016114444"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost log]# yum history info\nLoaded plugins: fastestmirror\nTransaction ID : 10\nBegin time     : Wed Jun 23 00:02:12 2021\nBegin rpmdb    : 388:b29a335784ff56787d8a2a396d0544f1028ff08c\nEnd time       :            00:02:13 2021 (1 seconds)\nEnd rpmdb      : 390:c4f6b01eb888626dba3d0fe63c7b95758c88a9c4\nUser           : root \u003croot\u003e\nReturn-Code    : Success\nCommand Line   : install -y redis\nTransaction performed with:\n    Installed     rpm-4.11.3-43.el7.x86_64                      @anaconda\n    Installed     yum-3.4.3-167.el7.centos.noarch               @anaconda\n    Installed     yum-plugin-fastestmirror-1.1.31-53.el7.noarch @anaconda\nPackages Altered:\n    Dep-Install jemalloc-3.6.0-1.el7.x86_64 @epel\n    Install     redis-3.2.12-2.el7.x86_64   @epel\nhistory info\n[root@localhost log]# \n\n\n#最后安装的redis服务\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}