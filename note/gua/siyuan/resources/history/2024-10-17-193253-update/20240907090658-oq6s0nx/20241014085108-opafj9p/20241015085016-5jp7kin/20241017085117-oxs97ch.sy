{"ID":"20241017085117-oxs97ch","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f695","id":"20241017085117-oxs97ch","scroll":"\u0026#123;\u0026quot;rootId\u0026quot;:\u0026quot;20241017085117-oxs97ch\u0026quot;,\u0026quot;startId\u0026quot;:\u0026quot;20241017085117-8tu4ksi\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20241017085117-8tu4ksi\u0026quot;,\u0026quot;scrollTop\u0026quot;:0,\u0026quot;focusId\u0026quot;:\u0026quot;20241017085117-8tu4ksi\u0026quot;,\u0026quot;focusStart\u0026quot;:0,\u0026quot;focusEnd\u0026quot;:0\u0026#125;","title":"Linux入侵排查","updated":"20241017193117"},"Children":[{"ID":"20241017091908-mjxfngr","Type":"NodeParagraph","Properties":{"id":"20241017091908-mjxfngr"}},{"ID":"20241017085117-8tu4ksi","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241017085117-8tu4ksi","updated":"20241017091903"},"Children":[{"Type":"NodeText","Data":"1.账号安全"}]},{"ID":"20241017182728-6exgas1","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017182728-6exgas1","updated":"20241017182734"},"Children":[{"Type":"NodeText","Data":"基本使用"}]},{"ID":"20241017091909-3d4mlee","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017091909-3d4mlee","updated":"20241017182452"},"Children":[{"Type":"NodeText","Data":"1)用户信息文件 /etc/passwd"}]},{"ID":"20241017092130-7h7n1pf","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092130-7h7n1pf","updated":"20241017092130"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017092130-fjdsjxf.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017092052-e9gl80h","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092052-e9gl80h","updated":"20241017092124"},"Children":[{"Type":"NodeText","Data":"用户：密码：用户ID：组ID：用户说明：用户家目录：登录shell"}]},{"ID":"20241017092132-nqr7eqh","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092132-nqr7eqh","updated":"20241017182625"},"Children":[{"Type":"NodeText","Data":"PS："},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"密码为空不能远程登录，只能本机登录"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，X是占位符，存在在shadow文件中"}]},{"ID":"20241017092125-c8p78lz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092125-c8p78lz"}},{"ID":"20241017092216-dnj8pkk","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092216-dnj8pkk","updated":"20241017182508"},"Children":[{"Type":"NodeText","Data":"2)/etc/shadow文件"}]},{"ID":"20241017092300-7f4f742","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092300-7f4f742","updated":"20241017092300"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017092300-46u6a92.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017092302-d5myvfz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092302-d5myvfz","updated":"20241017092529"},"Children":[{"Type":"NodeText","Data":"用户名：加密密码：密码最后一次修改日期：两次密码修改的间隔时间：密码有效期：密码到期警告天数：宽限天数：账号失效的时间：预留"}]},{"ID":"20241017092731-gbxxy3u","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092731-gbxxy3u"}},{"ID":"20241017092732-ms4tktf","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092732-ms4tktf","updated":"20241017092740"},"Children":[{"Type":"NodeText","Data":"查看当前登录用户状态"}]},{"ID":"20241017182545-gy98dbr","Type":"NodeBlockquote","Properties":{"fold":"1","heading-fold":"1","id":"20241017182545-gy98dbr","updated":"20241017182607"},"Children":[{"ID":"20241017182546-zakvrhh","Type":"NodeParagraph","Properties":{"id":"20241017182546-zakvrhh","updated":"20241017182607"},"Children":[{"Type":"NodeText","Data":"who 查看当前登录的用户    "},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"pts远程登录    pty本地登录"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241017182546-5l2tyci","Type":"NodeParagraph","Properties":{"id":"20241017182546-5l2tyci","updated":"20241017182546"},"Children":[{"Type":"NodeText","Data":"w 查看系统信息 记录用户登录时间和交互方式"}]},{"ID":"20241017182546-fwniw7m","Type":"NodeParagraph","Properties":{"id":"20241017182546-fwniw7m","updated":"20241017182546"},"Children":[{"Type":"NodeText","Data":"uptime 查看登录多久，有多少用户，系统负载状态"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241017092743-xk8ep7h","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092743-xk8ep7h","updated":"20241017092743"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017092743-nj3grov.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017092931-wn68xli","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017092931-wn68xli"}},{"ID":"20241017092935-hesi38x","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092935-hesi38x","updated":"20241017182854"},"Children":[{"Type":"NodeText","Data":"入侵排查"}]},{"ID":"20241017092947-mrqc8fw","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092947-mrqc8fw","updated":"20241017182903"},"Children":[{"Type":"NodeText","Data":"1）是否存在特权用户"}]},{"ID":"20241017093022-d3s4o42","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017093022-d3s4o42","updated":"20241017093234"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"awk -F: '$3==0{print $1}' /etc/passwd    #uid=0--》root\n关注root之外的用户\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017093155-o7gg0uc","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017093155-o7gg0uc","updated":"20241017093155"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017093155-unos5k7.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017092949-ovjxn07","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092949-ovjxn07","updated":"20241017182915"},"Children":[{"Type":"NodeText","Data":"2）是否有远程登录用户"}]},{"ID":"20241017093238-6pomzkb","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017093238-6pomzkb","updated":"20241017093639"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"awk '/\\$1|\\$6/{print $1}' /etc/shadow\n#关注密码字段的存储方式中指定$6的密码字段，$6是指可以远程登录的\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017093559-ich89v7","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017093559-ich89v7","updated":"20241017093559"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017093559-i3pcpky.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017092956-fhyees5","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017092956-fhyees5","updated":"20241017183007"},"Children":[{"Type":"NodeText","Data":"3）哪些用户可以访问sudo权限，普通用户非管理需要应删除sudo权限"}]},{"ID":"20241017094044-wtblo8a","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017094044-wtblo8a","updated":"20241017183121"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost ~]# more /etc/sudoers |grep -v \"^#\\|^$\" |grep \"ALL=(ALL)\"\nroot\tALL=(ALL) \tALL\n%wheel\tALL=(ALL)\tALL\n\n#正常情况来说，不能设置wheel组\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017094141-jsp6pn4","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017094141-jsp6pn4","updated":"20241017094141"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017094141-9f6sz3r.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017094225-k649ahr","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017094225-k649ahr"}},{"ID":"20241017093008-p1j31vt","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017093008-p1j31vt","updated":"20241017183035"},"Children":[{"Type":"NodeText","Data":"4）删除或禁用可以账号（注意:发现存在意思用户后，要先去禁用核查，然后在确定是否删除）"}]},{"ID":"20241017094303-awdiw8o","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017094303-awdiw8o","updated":"20241017183333"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"usermod -L username  #禁用username，在用户前添加！\nuserdel username     #仅删除用户\nuserdel -r username\t #删除用户及其家目录\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017183357-ijask18","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017183357-ijask18","updated":"20241017183357"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017183357-y7oyv1d.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017183356-0ciemt4","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017183356-0ciemt4"}},{"ID":"20241017094827-wfhsqoy","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241017094827-wfhsqoy","updated":"20241017183417"},"Children":[{"Type":"NodeText","Data":"2.历史命令"}]},{"ID":"20241017184423-1dlzzb1","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017184423-1dlzzb1","updated":"20241017184456"},"Children":[{"Type":"NodeText","Data":".bash history的文件记录着这个用户都执行过什么命令;主要分析"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"是否有账户执行过恶意操作"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241017183435-e3lyjdf","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017183435-e3lyjdf","updated":"20241017183437"},"Children":[{"Type":"NodeText","Data":"基本使用"}]},{"ID":"20241017094846-t68ahr2","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017094846-t68ahr2","updated":"20241017183446"},"Children":[{"Type":"NodeText","Data":"1）root用户的历史命令 /root/.bash_history"}]},{"ID":"20241017094830-tj75c5i","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017094830-tj75c5i","updated":"20241017094906"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"history 查看\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017094628-9yj7cxr","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017094628-9yj7cxr","updated":"20241017183817"},"Children":[{"Type":"NodeText","Data":"2）普通用户的历史命令，存在普通用户的/home目录下的.bash_history"}]},{"ID":"20241017095916-7cmnipo","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017095916-7cmnipo","updated":"20241017100103"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"history 普通用户权限查看\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017095903-i39l8h3","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017095903-i39l8h3","updated":"20241017183826"},"Children":[{"Type":"NodeText","Data":"2.1）给history配置记录多少条命令"}]},{"ID":"20241017100130-qbll2y8","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017100130-qbll2y8","updated":"20241017100132"},"Children":[{"Type":"NodeText","Data":"法一："}]},{"ID":"20241017100133-njdqfmg","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017100133-njdqfmg","updated":"20241017184313"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"\n[root@localhost ~]# sed -i 's/^HISTSIZE=1000/HISTSIZE=10000/g' /etc/profile\n[root@localhost ~]# cat /etc/profile |grep HISTSIZE\nHISTSIZE=10000\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017184948-5vowqts","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017184948-5vowqts","updated":"20241017184948"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017184948-7om095h.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017100111-newymon","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017100111-newymon","updated":"20241017184345"},"Children":[{"Type":"NodeText","Data":"法二：将以下内容加入/etc/profile即可"}]},{"ID":"20241017184327-kjmw307","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017184327-kjmw307","updated":"20241017184518"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"USER_IP=`who -u am i 2\u003e/dev/null | awk '{print $NF}' | sed -e 's/[()]//g'`\nif [ \"$USER_IP\" = \"\" ]\nthen\nUSER_IP=`hostname`\nfi\nexport HISTTIMEFORMAT=\"%F %T $USER_IP `whoami` \"\nshopt -s histappend\nexport PROMPT_COMMAND=\"history -a\"\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017101719-kqwnbg9","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017101719-kqwnbg9"}},{"ID":"20241017185133-r18pt41","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017185133-r18pt41","updated":"20241017185133"},"Children":[{"Type":"NodeText","Data":"入侵排查"}]},{"ID":"20241017185133-1g2ulqe","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017185133-1g2ulqe","updated":"20241017185133"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"将命令记录文件导出之后分析，导出方法如下："}]},{"ID":"20241017185122-390v5kc","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017185122-390v5kc","updated":"20241017185146"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"1、进入用户目录\ncat .bash_history \u003e\u003e history.txt \n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017185122-xs3ekl6","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241017185122-xs3ekl6","updated":"20241017185200"},"Children":[{"Type":"NodeText","Data":"3.异常端口"}]},{"ID":"20241017185211-3iesfes","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017185211-3iesfes","updated":"20241017185241"},"Children":[{"Type":"NodeText","Data":"查看端口装填，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"分析可疑"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"的端口和IP以及"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"PID追朔"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"其运行文件源头"}]},{"ID":"20241017190737-ah6mj5f","Type":"NodeList","ListData":{},"Properties":{"fold":"1","heading-fold":"1","id":"20241017190737-ah6mj5f","updated":"20241017190744"},"Children":[{"ID":"20241017190737-a89p71c","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241017190737-a89p71c","updated":"20241017190741"},"Children":[{"ID":"20241017190712-3qkzhsh","Type":"NodeParagraph","Properties":{"id":"20241017190712-3qkzhsh","updated":"20241017190741"},"Children":[{"Type":"NodeText","Data":"netstat 网络连接命令  查看服务器"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"是否有未被授权的端口被监听"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]}]},{"ID":"20241017190737-cmk9heh","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20241017190737-cmk9heh","updated":"20241017190744"},"Children":[{"ID":"20241017190731-1n39xvk","Type":"NodeParagraph","Properties":{"id":"20241017190731-1n39xvk","updated":"20241017190744"},"Children":[{"Type":"NodeText","Data":"检查服务器"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"是否存在恶意进程"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"，恶意进程往往会开启监听端口，与外部控制机器进行连接"}]}]}]},{"ID":"20241017101720-v88nq5j","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017101720-v88nq5j","updated":"20241017191411"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"netstat -antlp            #查看进程ID和端口状态\nls -l /proc/\u003cPID\u003e/exe\t  #定位其运行的文件路径\nfile /proc/\u003cPID\u003e/exe    \n\n判断文件路径是否是软链或bash文件\n根据获取的路径查看，如下图ls -al /user/bin/ |grep mongod\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017185743-g6xrpg9","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017185743-g6xrpg9","updated":"20241017185743"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017185743-fuuxez7.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017185741-g2iarcf","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017185741-g2iarcf"}},{"ID":"20241017185741-f1scmt3","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241017185741-f1scmt3","updated":"20241017185824"},"Children":[{"Type":"NodeText","Data":"4.检查进程"}]},{"ID":"20241017191426-qfh92s3","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017191426-qfh92s3","updated":"20241017191511"},"Children":[{"Type":"NodeText","Data":"如果发现有"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"名称不断变化"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"的"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"非授权"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"进程占用"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"大量系统CPU"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"或"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"内存资源"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"时，则可能为恶意程序\n确认该进程为恶意进程后，可以使用 "},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"kill -g 进程名"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":" 命令结束，或使用"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"防火墙"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"限制进程外联"}]},{"ID":"20241017185741-nejxym7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017185741-nejxym7","updated":"20241017185844"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"netstat -antlp  #获取进程ID\nps -aux | grep 《PID》\t#获取当前可疑进程使用的启动命令，可以定位路径\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017190507-mquwf02","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017190507-mquwf02","updated":"20241017190507"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017190507-pp9ts7i.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017185742-m4nrcjs","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017185742-m4nrcjs"}},{"ID":"20241017101720-unkj8m6","Type":"NodeHeading","HeadingLevel":3,"Properties":{"fold":"1","id":"20241017101720-unkj8m6","updated":"20241017191012"},"Children":[{"Type":"NodeText","Data":"5.开机启动项目"}]},{"ID":"20241017101840-dkt1ghh","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017101840-dkt1ghh","updated":"20241017101846"},"Children":[{"Type":"NodeText","Data":"基本姿势："}]},{"ID":"20241017101848-epswqx7","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017101848-epswqx7","updated":"20241017101852"},"Children":[{"Type":"NodeText","Data":"运行级别runlevel"}]},{"ID":"20241017101911-goo4uer","Type":"NodeTable","TableAligns":[0,0],"Properties":{"colgroup":"min-width: 60px;|min-width: 60px;","fold":"1","heading-fold":"1","id":"20241017101911-goo4uer","updated":"20241017102047"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"级别"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"定义"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"0"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"关机"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"1"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"单用户模式，相当与Windows安全模式"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"2"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"不完全的命令行模式，没有NFS"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"3"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"完全的命令行模式"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"4"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"系统保留"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"5"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"图形化"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"6"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"重启"}]}]}]},{"ID":"20241017102212-j2i95kt","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017102212-j2i95kt"}},{"ID":"20241017102213-kb0l8b4","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017102213-kb0l8b4","updated":"20241017191147"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"默认配置级别文件   /etc/inittab"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241017102221-txr169x","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017102221-txr169x","updated":"20241017191114"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost ~]# cat /etc/inittab\n# inittab is no longer used when using systemd.\n#\n# ADDING CONFIGURATION HERE WILL HAVE NO EFFECT ON YOUR SYSTEM.\n#\n# Ctrl-Alt-Delete is handled by /usr/lib/systemd/system/ctrl-alt-del.target\n#\n# systemd uses 'targets' instead of runlevels. By default, there are two main targets:\n#\n# multi-user.target: analogous to runlevel 3\n# graphical.target: analogous to runlevel 5\n#\n# To view current default target, run:\n# systemctl get-default\n#\n# To set a default target, run:\n# systemctl set-default TARGET.target\n#\n[root@localhost ~]# more /etc/rc.local\n#!/bin/bash\n# THIS FILE IS ADDED FOR COMPATIBILITY PURPOSES\n#\n# It is highly advisable to create own systemd services or udev rules\n# to run scripts during boot instead of using this file.\n#\n# In contrast to previous versions due to parallel execution during boot\n# this script will NOT be run after all other services.\n#\n# Please note that you must run 'chmod +x /etc/rc.d/rc.local' to ensure\n# that this script will be executed during boot.\n\ntouch /var/lock/subsys/local"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017102255-abgxykd","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017102255-abgxykd"}},{"ID":"20241017102259-kjthgd7","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017102259-kjthgd7","updated":"20241017191205"},"Children":[{"Type":"NodeText","Data":"开启自启动配置文件"}]},{"ID":"20241017191230-bwfca0q","Type":"NodeBlockquote","Properties":{"fold":"1","heading-fold":"1","id":"20241017191230-bwfca0q","updated":"20241017191241"},"Children":[{"ID":"20241017112507-14ptx5m","Type":"NodeParagraph","Properties":{"id":"20241017112507-14ptx5m","updated":"20241017191241"},"Children":[{"Type":"NodeText","Data":"默认位置："},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"/etc/rc.d"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"\t#0-6共计7个级别的启动文件，完全命令行默认在rc3.d文件内\n创建自启动文件方式：\n"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"ln -s /etc/init.d/tomcat /etc/rc.d/rc3.d/s100tomcat"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"\t#创建软链自启动tomcat\ns：自启动\nK：代表启动加载时会关闭"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241017191723-h45t736","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017191723-h45t736","updated":"20241017191723"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017191723-lgnv52x.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017112507-4lirx6u","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017112507-4lirx6u"}},{"ID":"20241017112619-2hhnxsl","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","heading-fold":"1","id":"20241017112619-2hhnxsl","updated":"20241017191800"},"Children":[{"Type":"NodeText","Data":"入侵排查"}]},{"ID":"20241017192034-swn5szz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017192034-swn5szz","updated":"20241017192205"},"Children":[{"Type":"NodeText","Data":"使用chkconfig --list（systemctl list-unit-files）和ls -alt /etc/init.d/ 命令查看开机启动项中是否有异常的启动服务"}]},{"ID":"20241017192140-wt5p5uz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017192140-wt5p5uz","updated":"20241017192141"},"Children":[{"Type":"NodeText","Data":"恶意程序往往会添加在系统的启动项，在用户关机重启后再次运行\n如果发现有恶意进程，可使用 chkconfig 服务名 off 命令关闭(CentOs7下为: systemctl disable postfix.service)"}]},{"ID":"20241017192120-lxh0i33","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017192120-lxh0i33","updated":"20241017192120"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017192120-cvrvu2y.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017192034-jzlgeeq","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017192034-jzlgeeq"}},{"ID":"20241017191818-zgd5g8l","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017191818-zgd5g8l","updated":"20241017191825"},"Children":[{"Type":"NodeText","Data":"启动文件"}]},{"ID":"20241017191830-d3nbu1l","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017191830-d3nbu1l","updated":"20241017191840"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"more /etc/rc.local\nls -al /etc/rc.d/rc[0,1,2,3,4,5,6].d\n\n#需要关注恶意的启动脚本或敏感路径\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017192309-xeibfdz","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017192309-xeibfdz","updated":"20241017192309"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017192309-wq00xst.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017112620-r1vjiks","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017112620-r1vjiks"}},{"ID":"20241017112620-30go40u","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241017112620-30go40u","updated":"20241017192344"},"Children":[{"Type":"NodeText","Data":"6.计划任务-定时启动"}]},{"ID":"20241017192659-gf2r8uf","Type":"NodeHeading","HeadingLevel":4,"Properties":{"fold":"1","id":"20241017192659-gf2r8uf","updated":"20241017192704"},"Children":[{"Type":"NodeText","Data":"基本使用"}]},{"ID":"20241017192347-gni2ho5","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017192347-gni2ho5","updated":"20241017192402"},"Children":[{"Type":"NodeText","Data":"1）查看方式"}]},{"ID":"20241017192405-bfxuodt","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017192405-bfxuodt","updated":"20241017192419"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"crontab -l\t#查看当前用户的计划任务\ncrontab -u username -l #查看指定的username用户的计划任务\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017192417-p1nd75m","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017192417-p1nd75m","updated":"20241017192429"},"Children":[{"Type":"NodeText","Data":"2）怎么创建"}]},{"ID":"20241017192432-dl4tpve","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017192432-dl4tpve","updated":"20241017192439"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"crontab -e -u root\t#给root用户创建\n* * * * * echo \"hello\" \u003e\u003e /tmp/1.txt\t#每分钟将hello输出在/tmp/1.txt\n[root@localhost cron]# crontab -l -u root\n* * * * * echo \"hello\" \u003e\u003e /tmp/1.txt\n[root@localhost cron]# cat /tmp/1.txt \nhello\nhello\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017192432-oqudp0a","Type":"NodeHeading","HeadingLevel":5,"Properties":{"fold":"1","heading-fold":"1","id":"20241017192432-oqudp0a","updated":"20241017192518"},"Children":[{"Type":"NodeText","Data":"3）删除计划任务"}]},{"ID":"20241017112522-nfhyyse","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"fold":"1","heading-fold":"1","id":"20241017112522-nfhyyse","updated":"20241017192529"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost cron]# crontab -r -u root\t#会删除所有计划任务，谨慎使用\n[root@localhost cron]# crontab -l\nno crontab for root\n[root@localhost cron]# "},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017112601-o8v28k3","Type":"NodeParagraph","Properties":{"fold":"1","heading-fold":"1","id":"20241017112601-o8v28k3"}},{"ID":"20241017192716-m49mbnk","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241017192716-m49mbnk","updated":"20241017192719"},"Children":[{"Type":"NodeText","Data":"入侵排查"}]},{"ID":"20241017192712-hwhe8tx","Type":"NodeParagraph","Properties":{"id":"20241017192712-hwhe8tx","updated":"20241017192732"},"Children":[{"Type":"NodeText","Data":"重点关注是否在以下目录中"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"存在恶意脚本"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"}]},{"ID":"20241017192811-1bdpdop","Type":"NodeBlockquote","Properties":{"id":"20241017192811-1bdpdop","updated":"20241017192812"},"Children":[{"ID":"20241017112910-m8ofcif","Type":"NodeParagraph","Properties":{"id":"20241017112910-m8ofcif","updated":"20241017192812"},"Children":[{"Type":"NodeText","Data":"进入 cron 文件目录，查看是否存在非法定时任务脚本\n注意查看:/etc/crontab /etc/cron.d /etc/cron.daily cron.hourly/ cron.monthly cron.weekly\n如果发现有不认识的计划任务，可以定位脚本确认是否是正常业务脚本\n如果是非正常业务脚本，直接注释掉任务内容或删除脚本"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20241017113150-lwjfmhw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017113150-lwjfmhw","updated":"20241017193046"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost cron]# ls /var/spool/cron/\t#关注用户的计划任务\n[root@localhost cron]# more /etc/crontab\t#命令内写入的计划任务\nSHELL=/bin/bash\nPATH=/sbin:/bin:/usr/sbin:/usr/bin\nMAILTO=root\n\n# For details see man 4 crontabs\n\n# Example of job definition:\n# .---------------- minute (0 - 59)\n# |  .------------- hour (0 - 23)\n# |  |  .---------- day of month (1 - 31)\n# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...\n# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat\n# |  |  |  |  |\n# *  *  *  *  * user-name  command to be executed\n\n\n[root@localhost cron]# ls -al /etc/cron.d/\t#计划任务目录\ntotal 16\ndrwxr-xr-x.  2 root root   21 Jun 12  2021 .\ndrwxr-xr-x. 77 root root 8192 Oct 14 23:32 ..\n-rw-r--r--.  1 root root  128 Aug  9  2019 0hourly\n[root@localhost cron]# ls -al /etc/cron.daily/\t\t#每天的计划任务列表目录\ntotal 20\ndrwxr-xr-x.  2 root root   42 Jun 12  2021 .\ndrwxr-xr-x. 77 root root 8192 Oct 14 23:32 ..\n-rwx------.  1 root root  219 Apr  1  2020 logrotate\n-rwxr-xr-x.  1 root root  618 Oct 30  2018 man-db.cron\n[root@localhost cron]# ls -al /etc/cron.hourly/\t\t#每个小时的计划任务列表目录\ntotal 16\ndrwxr-xr-x.  2 root root   22 Jun 10  2014 .\ndrwxr-xr-x. 77 root root 8192 Oct 14 23:32 ..\n-rwxr-xr-x.  1 root root  392 Aug  9  2019 0anacron\n[root@localhost cron]# ls -al /etc/cron.monthly/\t#每个月\ntotal 12\ndrwxr-xr-x.  2 root root    6 Jun 10  2014 .\ndrwxr-xr-x. 77 root root 8192 Oct 14 23:32 ..\n[root@localhost cron]# ls -al /etc/cron.weekly/\t#每周\ntotal 12\ndrwxr-xr-x.  2 root root    6 Jun 10  2014 .\ndrwxr-xr-x. 77 root root 8192 Oct 14 23:32 ..\n[root@localhost cron]# ls -al /etc/anacrontab \t#计划任务列表\n-rw-------. 1 root root 541 Aug  9  2019 /etc/anacrontab\t\t#计划任务列表\n[root@localhost cron]# ls -al /etc/spool/anacron/ \nls: cannot access /etc/spool/anacron/: No such file or directory\n[root@localhost cron]# \n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193056-1y23w52","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241017193056-1y23w52","updated":"20241017193056"},"Children":[{"Type":"NodeText","Data":"7 、检查服务"}]},{"ID":"20241017193056-k2o366z","Type":"NodeParagraph","Properties":{"id":"20241017193056-k2o366z","updated":"20241017193115"},"Children":[{"Type":"NodeText","Data":"​服务自启动​"}]},{"ID":"20241017193056-rytbg6e","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241017193056-rytbg6e","updated":"20241017193117"},"Children":[{"Type":"NodeText","Data":"默认的以下服务的配置文件："}]},{"ID":"20241017193056-s5g5l2g","Type":"NodeParagraph","Properties":{"id":"20241017193056-s5g5l2g","updated":"20241017193157"},"Children":[{"Type":"NodeText","Data":"网卡的配置文件：/etc/sysconfig/network-scripts/ifcfg-eth0​​"}]},{"ID":"20241017193054-hskpznr","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193054-hskpznr","updated":"20241017193127"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost network-scripts]# pwd\n/etc/sysconfig/network-scripts/ifcfg-eth0\t\t#eth0网卡配置\n\n\n[root@localhost network-scripts]# more ./ifcfg-eth0 \nTYPE=Ethernet\nPROXY_METHOD=none\nBROWSER_ONLY=no\nBOOTPROTO=static\t\t#或者是dhcp\nDEFROUTE=yes\nIPV4_FAILURE_FATAL=no\nIPV6INIT=yes\nIPV6_AUTOCONF=yes\nIPV6_DEFROUTE=yes\nIPV6_FAILURE_FATAL=no\nIPV6_ADDR_GEN_MODE=stable-privacy\nNAME=eth0\nUUID=bc62cee8-5ab3-43fc-aa8e-381dac793a3b\nDEVICE=eth0\nONBOOT=yes\nIPADDR=172.16.12.2\nNETMASK=255.255.255.0\nGETWAY=172.16.12.1\nDNS1=114.114.114.114\nDNS2=8.8.8.8\nPREFIX=24\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193055-zbj0e84","Type":"NodeParagraph","Properties":{"id":"20241017193055-zbj0e84"}},{"ID":"20241017193132-eahw2pv","Type":"NodeParagraph","Properties":{"id":"20241017193132-eahw2pv","updated":"20241017193147"},"Children":[{"Type":"NodeText","Data":"DNS配置文件路径/etc/resolv.conf"}]},{"ID":"20241017193138-4yvyj35","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193138-4yvyj35","updated":"20241017193142"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost network-scripts]# more /etc/resolv.conf \n#Generated by NetworkManager\nnameserver 114.114.114.114\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193206-par7q5e","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241017193206-par7q5e","updated":"20241017193211"},"Children":[{"Type":"NodeText","Data":"修改自启动"}]},{"ID":"20241017193212-ql2adj4","Type":"NodeParagraph","Properties":{"id":"20241017193212-ql2adj4"},"Children":[{"Type":"NodeText","Data":"方法1："}]},{"ID":"20241017193130-sy5561j","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193130-sy5561j","updated":"20241017193214"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost network-scripts]# chkconfig --level 2345 httpd.service on\t#指定级别，默认2345\nNote: Forwarding request to 'systemctl enable httpd.service'.\n\nchkconfig  httpd on#其他写法，不指定级别\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193130-u24pqfb","Type":"NodeParagraph","Properties":{"id":"20241017193130-u24pqfb","updated":"20241017193221"},"Children":[{"Type":"NodeText","Data":"法2"}]},{"ID":"20241017193222-xoxkkez","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193222-xoxkkez","updated":"20241017193226"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"修改：/etc/rc.d/rc.local\n添加服务启动：\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193130-5fquihs","Type":"NodeParagraph","Properties":{"id":"20241017193130-5fquihs","updated":"20241017193232"},"Children":[{"Type":"NodeText","Data":"其他"}]},{"ID":"20241017193233-43za5us","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017193233-43za5us","updated":"20241017193237"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"[root@localhost network-scripts]# ntsysv\n-bash: ntsysv: command not fou\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017193230-h60nji5","Type":"NodeParagraph","Properties":{"id":"20241017193230-h60nji5"}},{"ID":"20241017193230-2f64z9x","Type":"NodeParagraph","Properties":{"id":"20241017193230-2f64z9x"}},{"ID":"20241017193230-7msfkkw","Type":"NodeParagraph","Properties":{"id":"20241017193230-7msfkkw"}},{"ID":"20241017144415-n4lc5a9","Type":"NodeParagraph","Properties":{"id":"20241017144415-n4lc5a9","updated":"20241017144415"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017144414-84r52iu.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017150303-ztnvy32","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20241017150303-ztnvy32","updated":"20241017150313"},"Children":[{"Type":"NodeText","Data":"常用工具"}]},{"ID":"20241017150317-paeff5n","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241017150317-paeff5n"},"Children":[{"Type":"NodeText","Data":"rootkit查杀"}]},{"ID":"20241017150322-bko24t8","Type":"NodeParagraph","Properties":{"id":"20241017150322-bko24t8"},"Children":[{"Type":"NodeText","Data":"rootkit是特殊恶意文件，功能是隐藏自身或者进程，文件，网络链接。。。。rootkit一般和木马后门联合使用"}]},{"ID":"20241017150334-88qg0wd","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241017150334-88qg0wd","updated":"20241017150351"},"Children":[{"Type":"NodeText","Data":"两种类型:"}]},{"ID":"20241017150353-a8ftbaf","Type":"NodeParagraph","Properties":{"id":"20241017150353-a8ftbaf"},"Children":[{"Type":"NodeText","Data":"文件级别的修改重要文件，隐藏在文件内。如:ipconfig find ls pa login等"}]},{"ID":"20241017150355-mnsyd1n","Type":"NodeParagraph","Properties":{"id":"20241017150355-mnsyd1n","updated":"20241017150358"},"Children":[{"Type":"NodeText","Data":"内核级别的修改系统的内同"}]},{"ID":"20241017150409-ug7wqf0","Type":"NodeParagraph","Properties":{"id":"20241017150409-ug7wqf0"}},{"ID":"20241017150410-i9a9k44","Type":"NodeParagraph","Properties":{"id":"20241017150410-i9a9k44"}},{"ID":"20241017150410-kb8ok2u","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20241017150410-kb8ok2u","updated":"20241017150512"},"Children":[{"Type":"NodeText","Data":"chkrookit"}]},{"ID":"20241017152932-uo2po5y","Type":"NodeParagraph","Properties":{"id":"20241017152932-uo2po5y","updated":"20241017152935"},"Children":[{"Type":"NodeText","Data":"下载"}]},{"ID":"20241017152936-lsmyl09","Type":"NodeParagraph","Properties":{"id":"20241017152936-lsmyl09","updated":"20241017152948"},"Children":[{"Type":"NodeText","Data":"https://www.chkrootkit.org/download"}]},{"ID":"20241017152950-clpcfsh","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017152950-clpcfsh","updated":"20241017153010"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"下载命令:wget ftp://ftp.chkrootkit.org/pub/seg/pac/chkrootkit.tar.gz\ntar -zxvf chkrootkit.tar.gz\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017153236-wwnzww4","Type":"NodeParagraph","Properties":{"id":"20241017153236-wwnzww4","updated":"20241017153236"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017153236-c4pliao.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017153237-gl0cahf","Type":"NodeParagraph","Properties":{"id":"20241017153237-gl0cahf","updated":"20241017153247"},"Children":[{"Type":"NodeText","Data":"2.rkhunter"}]},{"ID":"20241017153247-nhzfz1u","Type":"NodeParagraph","Properties":{"id":"20241017153247-nhzfz1u","updated":"20241017153257"},"Children":[{"Type":"NodeText","Data":"https://sourceforge.net/projects/rkhunter/files/rkhunter/1.4.6/"}]},{"ID":"20241017153611-9w5n56h","Type":"NodeParagraph","Properties":{"id":"20241017153611-9w5n56h","updated":"20241017153611"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241017153611-0sb861o.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241017154004-0vhih8i","Type":"NodeParagraph","Properties":{"id":"20241017154004-0vhih8i"}},{"ID":"20241017160734-a949emw","Type":"NodeParagraph","Properties":{"id":"20241017160734-a949emw"}},{"ID":"20241017160734-esnvwlt","Type":"NodeParagraph","Properties":{"id":"20241017160734-esnvwlt","updated":"20241017160737"},"Children":[{"Type":"NodeText","Data":"安全脚本"}]},{"ID":"20241017160847-gxer28o","Type":"NodeParagraph","Properties":{"id":"20241017160847-gxer28o","updated":"20241017160852"},"Children":[{"Type":"NodeText","Data":"CheckList"}]}]}