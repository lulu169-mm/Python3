{"ID":"20240920090247-t1pxuuy","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240920090247-t1pxuuy","scroll":"\u0026#123;\u0026quot;rootId\u0026quot;:\u0026quot;20240920090247-t1pxuuy\u0026quot;,\u0026quot;startId\u0026quot;:\u0026quot;20240920090247-sgt7nwt\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20240920160120-96xyzuh\u0026quot;,\u0026quot;scrollTop\u0026quot;:4584\u0026#125;","title":"框架漏洞","updated":"20241007155411"},"Children":[{"ID":"20240920090247-sgt7nwt","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240920090247-sgt7nwt","updated":"20240920090313"},"Children":[{"Type":"NodeText","Data":"ThinkPHP"}]},{"ID":"20240920090350-coefryf","Type":"NodeParagraph","Properties":{"id":"20240920090350-coefryf","updated":"20240920090619"},"Children":[{"Type":"NodeText","Data":"特征"}]},{"ID":"20240920090621-befjor0","Type":"NodeParagraph","Properties":{"id":"20240920090621-befjor0","updated":"20241007155411"},"Children":[{"Type":"NodeText","Data":"1.ico图标"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240920090648-81at5s5.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240920090623-2fw1atg","Type":"NodeParagraph","Properties":{"id":"20240920090623-2fw1atg","updated":"20240920090916"},"Children":[{"Type":"NodeText","Data":"2.报错页面--错误传参"}]},{"ID":"20240920090743-qdqotwh","Type":"NodeParagraph","Properties":{"id":"20240920090743-qdqotwh","updated":"20240920090821"},"Children":[{"Type":"NodeText","Data":"3.\\页面的html里存有特征：thinkphp 十年磨一剑"}]},{"ID":"20240920090927-0z59o3o","Type":"NodeParagraph","Properties":{"id":"20240920090927-0z59o3o","updated":"20240920090927"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240920090927-mdydoot.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240920090936-rwjua3l","Type":"NodeParagraph","Properties":{"id":"20240920090936-rwjua3l"}},{"ID":"20240920090937-hru9ql5","Type":"NodeParagraph","Properties":{"id":"20240920090937-hru9ql5","updated":"20240920091025"},"Children":[{"Type":"NodeText","Data":"漏洞总结"}]},{"ID":"20240920093040-fiorhar","Type":"NodeParagraph","Properties":{"id":"20240920093040-fiorhar"}},{"ID":"20240920093041-99bp5f7","Type":"NodeParagraph","Properties":{"id":"20240920093041-99bp5f7"}},{"ID":"20240920093041-yvysyth","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240920093041-yvysyth","updated":"20240920093754"},"Children":[{"Type":"NodeText","Data":"6.0.12"}]},{"ID":"20240920093901-20nuydx","Type":"NodeParagraph","Properties":{"id":"20240920093901-20nuydx","updated":"20240920094021"},"Children":[{"Type":"NodeText","Data":"​"}]},{"ID":"20240920094724-w953t8n","Type":"NodeParagraph","Properties":{"id":"20240920094724-w953t8n"}},{"ID":"20240920094724-2kptr1z","Type":"NodeParagraph","Properties":{"id":"20240920094724-2kptr1z"}},{"ID":"20240920094724-1qkbnkk","Type":"NodeParagraph","Properties":{"id":"20240920094724-1qkbnkk"}},{"ID":"20240920094724-dscu5t3","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240920094724-dscu5t3","updated":"20240920111600"},"Children":[{"Type":"NodeText","Data":"Laravel框架--php"}]},{"ID":"20240920093042-pecgk7y","Type":"NodeParagraph","Properties":{"id":"20240920093042-pecgk7y","updated":"20240920094755"},"Children":[{"Type":"NodeText","Data":"开源PHP框架"}]},{"ID":"20240920095002-xsfe50j","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240920095002-xsfe50j","updated":"20240920095621"},"Children":[{"Type":"NodeText","Data":"漏洞总结"}]},{"ID":"20240920095002-r35bzmy","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240920095002-r35bzmy","updated":"20240920095030"},"Children":[{"Type":"NodeText","Data":"Laravel漏洞CVE 2021-3129"}]},{"ID":"20240920095033-1mf4hyi","Type":"NodeParagraph","Properties":{"id":"20240920095033-1mf4hyi","updated":"20240920095107"},"Children":[{"Type":"NodeText","Data":"自带的lgnition组件对file_get_contens"}]},{"ID":"20240920095606-7ejgz0l","Type":"NodeParagraph","Properties":{"id":"20240920095606-7ejgz0l","updated":"20240920095645"}},{"ID":"20240920095646-30b04h8","Type":"NodeParagraph","Properties":{"id":"20240920095646-30b04h8"}},{"ID":"20240920095646-tbapr9i","Type":"NodeParagraph","Properties":{"id":"20240920095646-tbapr9i"}},{"ID":"20240920095646-bh6xqxg","Type":"NodeParagraph","Properties":{"id":"20240920095646-bh6xqxg"}},{"ID":"20240920095647-1kwlglt","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240920095647-1kwlglt","updated":"20240920100420"},"Children":[{"Type":"NodeText","Data":"工具 "}]},{"ID":"20240920100421-jztfwkh","Type":"NodeParagraph","Properties":{"id":"20240920100421-jztfwkh","updated":"20240920100429"},"Children":[{"Type":"NodeText","Data":"python CVE-2021-3129.py"}]},{"ID":"20240920100430-p3b59x3","Type":"NodeParagraph","Properties":{"id":"20240920100430-p3b59x3","updated":"20240920100440"},"Children":[{"Type":"NodeText","Data":"检测"}]},{"ID":"20240920100442-ycp5ieq","Type":"NodeParagraph","Properties":{"id":"20240920100442-ycp5ieq","updated":"20240920100442"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240920100442-xrs8gro.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240920100629-jaufh9o","Type":"NodeParagraph","Properties":{"id":"20240920100629-jaufh9o","updated":"20240920100629"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240920100629-8x9mg30.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240920095644-e60tylh","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240920095644-e60tylh","updated":"20240920100116"},"Children":[{"Type":"NodeText","Data":"漏洞整体思路"}]},{"ID":"20240920100118-8wg5nzr","Type":"NodeParagraph","Properties":{"id":"20240920100118-8wg5nzr","updated":"20240920100243"},"Children":[{"Type":"NodeText","Data":"\t利用核心方法：将laravel.log日志的内容亲昵，然后利用伪协议"}]},{"ID":"20240920100640-koq3fqu","Type":"NodeParagraph","Properties":{"id":"20240920100640-koq3fqu","updated":"20240920100640"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240920100640-jo1shrv.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240920104809-1ifsl1y","Type":"NodeParagraph","Properties":{"id":"20240920104809-1ifsl1y"}},{"ID":"20240920105214-wqm9aqf","Type":"NodeParagraph","Properties":{"id":"20240920105214-wqm9aqf"}},{"ID":"20240920105215-dm1izwh","Type":"NodeParagraph","Properties":{"id":"20240920105215-dm1izwh"}},{"ID":"20240920105215-035rut8","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240920105215-035rut8","updated":"20240920111547"},"Children":[{"Type":"NodeText","Data":"STRUTS2框架漏洞-jsp"}]},{"ID":"20240920105311-6e6aund","Type":"NodeParagraph","Properties":{"id":"20240920105311-6e6aund","updated":"20240920105311"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240920105311-wpoi5jo.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240920105313-boofmzo","Type":"NodeParagraph","Properties":{"id":"20240920105313-boofmzo"}},{"ID":"20240920105439-o3rrn06","Type":"NodeParagraph","Properties":{"id":"20240920105439-o3rrn06"}},{"ID":"20240920105439-vjunxz7","Type":"NodeParagraph","Properties":{"id":"20240920105439-vjunxz7","updated":"20240920105440"},"Children":[{"Type":"NodeText","Data":"判断"}]},{"ID":"20240920105441-k9mb3lu","Type":"NodeParagraph","Properties":{"id":"20240920105441-k9mb3lu","updated":"20240920105650"},"Children":[{"Type":"NodeText","Data":"构造报错（403、404、500）--乱输入参数"}]},{"ID":"20240920105616-txo4rle","Type":"NodeParagraph","Properties":{"id":"20240920105616-txo4rle","updated":"20240920105825"},"Children":[{"Type":"NodeText","Data":"后缀名--index.cation 、index.do--大概率"}]},{"ID":"20240920105627-dqfs1pz","Type":"NodeParagraph","Properties":{"id":"20240920105627-dqfs1pz","updated":"20240920105836"},"Children":[{"Type":"NodeText","Data":"自带路径--/struts/webconsole.html"}]},{"ID":"20240920105840-t7p8kcm","Type":"NodeParagraph","Properties":{"id":"20240920105840-t7p8kcm","updated":"20240920105948"},"Children":[{"Type":"NodeText","Data":"本身调用类特性？actionErrors"}]},{"ID":"20240920105913-ss094s2","Type":"NodeParagraph","Properties":{"id":"20240920105913-ss094s2","updated":"20240920105913"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240920105913-npbqdb2.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240920110159-6kobd6z","Type":"NodeParagraph","Properties":{"id":"20240920110159-6kobd6z","updated":"20240920110201"},"Children":[{"Type":"NodeText","Data":"抓包"}]},{"ID":"20240920110202-4uz3t4y","Type":"NodeParagraph","Properties":{"id":"20240920110202-4uz3t4y","updated":"20240920110202"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240920110202-riohm4l.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240920110453-a4w8fe8","Type":"NodeParagraph","Properties":{"id":"20240920110453-a4w8fe8","updated":"20240920110456"},"Children":[{"Type":"NodeText","Data":"payload"}]},{"ID":"20240920110457-5igkjzg","Type":"NodeParagraph","Properties":{"id":"20240920110457-5igkjzg","updated":"20240920110458"},"Children":[{"Type":"NodeText","Data":"效果"}]},{"ID":"20240920110459-ym2fvju","Type":"NodeParagraph","Properties":{"id":"20240920110459-ym2fvju","updated":"20240920110500"},"Children":[{"Type":"NodeText","Data":"工具"}]},{"ID":"20240920111531-xnxjxk7","Type":"NodeParagraph","Properties":{"id":"20240920111531-xnxjxk7"}},{"ID":"20240920111532-nvo017i","Type":"NodeParagraph","Properties":{"id":"20240920111532-nvo017i"}},{"ID":"20240920111532-3pz3j32","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240920111532-3pz3j32","updated":"20240920113750"},"Children":[{"Type":"NodeText","Data":"shiro框架--java"}]},{"ID":"20240920113747-lrc95w5","Type":"NodeParagraph","Properties":{"id":"20240920113747-lrc95w5"},"Children":[{"Type":"NodeText","Data":"兼容JavaSE、JavaEE环境"}]},{"ID":"20240920111611-s31p8n2","Type":"NodeParagraph","Properties":{"id":"20240920111611-s31p8n2","updated":"20240920112117"},"Children":[{"Type":"NodeText","Data":"特征"}]},{"ID":"20240920112204-xiddz8g","Type":"NodeParagraph","Properties":{"id":"20240920112204-xiddz8g","updated":"20240920112212"},"Children":[{"Type":"NodeText","Data":"1.记住密码功能"}]},{"ID":"20240920112214-z6fodta","Type":"NodeParagraph","Properties":{"id":"20240920112214-z6fodta","updated":"20240920112220"},"Children":[{"Type":"NodeText","Data":"2.抓包响应值"}]},{"ID":"20240920112118-qufsm1a","Type":"NodeParagraph","Properties":{"id":"20240920112118-qufsm1a","updated":"20240920112118"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240920112118-f2isc93.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240920112222-ew1vqdc","Type":"NodeParagraph","Properties":{"id":"20240920112222-ew1vqdc"}},{"ID":"20240920112223-9dgknxz","Type":"NodeParagraph","Properties":{"id":"20240920112223-9dgknxz","updated":"20240920112230"},"Children":[{"Type":"NodeText","Data":"shiro反序列化 550"}]},{"ID":"20240920112307-mj4nt4w","Type":"NodeParagraph","Properties":{"id":"20240920112307-mj4nt4w","updated":"20240920112432"},"Children":[{"Type":"NodeText","Data":"登陆成功后生成的经过加密的和编码的cookie，在服务端内对rememberMe带的cookie值先进行base64编码，解密后在进行反序列化---反序列化漏洞"}]},{"ID":"20240920112550-chm1poh","Type":"NodeParagraph","Properties":{"id":"20240920112550-chm1poh"}},{"ID":"20240920112508-ny6z1sb","Type":"NodeParagraph","Properties":{"id":"20240920112508-ny6z1sb","updated":"20240920112533"},"Children":[{"Type":"NodeText","Data":"加密方式AES非对称加密 key--》用户无需知道，存在默认密钥"}]},{"ID":"20240920112547-tju2vtp","Type":"NodeParagraph","Properties":{"id":"20240920112547-tju2vtp","updated":"20240920112559"},"Children":[{"Type":"NodeText","Data":"1.检测是否使用默认密钥"}]},{"ID":"20240920112608-9f8rqy5","Type":"NodeParagraph","Properties":{"id":"20240920112608-9f8rqy5","updated":"20240920112628"},"Children":[{"Type":"NodeText","Data":"2.检测使用了哪一个POP链"}]},{"ID":"20240920112629-6ueogec","Type":"NodeParagraph","Properties":{"id":"20240920112629-6ueogec","updated":"20240920112636"},"Children":[{"Type":"NodeText","Data":"3.发送payload"}]},{"ID":"20240920113921-4qao8e8","Type":"NodeParagraph","Properties":{"id":"20240920113921-4qao8e8"}},{"ID":"20240920113941-1etqw3x","Type":"NodeParagraph","Properties":{"id":"20240920113941-1etqw3x","updated":"20240920113953"},"Children":[{"Type":"NodeText","Data":"shiro721反序列化"}]},{"ID":"20240920113956-33bou8f","Type":"NodeParagraph","Properties":{"id":"20240920113956-33bou8f","updated":"20240920114006"}},{"ID":"20240920114234-v4u5s3o","Type":"NodeParagraph","Properties":{"id":"20240920114234-v4u5s3o","updated":"20240920114242"},"Children":[{"Type":"NodeText","Data":"漏洞流程"}]},{"ID":"20240920114230-2c85sem","Type":"NodeParagraph","Properties":{"id":"20240920114230-2c85sem"},"Children":[{"Type":"NodeText","Data":"需要获取cookie值"}]},{"ID":"20240920114245-jlo0a6g","Type":"NodeParagraph","Properties":{"id":"20240920114245-jlo0a6g","updated":"20240920114317"},"Children":[{"Type":"NodeText","Data":"使用rememberMe字段进行Padding Oracle Attack 获取intermediary"}]},{"ID":"20240920114318-e7s1aia","Type":"NodeParagraph","Properties":{"id":"20240920114318-e7s1aia","updated":"20240920114334"},"Children":[{"Type":"NodeText","Data":"利用这个构造恶意的反序列化密文作为cookie"}]},{"ID":"20240920114334-azqfprf","Type":"NodeParagraph","Properties":{"id":"20240920114334-azqfprf","updated":"20240920114345"},"Children":[{"Type":"NodeText","Data":"使用新的cookie"}]},{"ID":"20240920115234-4hdaljy","Type":"NodeParagraph","Properties":{"id":"20240920115234-4hdaljy"}},{"ID":"20240920115235-0czusit","Type":"NodeParagraph","Properties":{"id":"20240920115235-0czusit"}},{"ID":"20240920115236-damzr7w","Type":"NodeParagraph","Properties":{"id":"20240920115236-damzr7w","updated":"20240920115236"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240920115236-q0506uc.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240920152520-um3xla1","Type":"NodeParagraph","Properties":{"id":"20240920152520-um3xla1"}},{"ID":"20240920152521-gq0w2fk","Type":"NodeParagraph","Properties":{"id":"20240920152521-gq0w2fk"}},{"ID":"20240920152521-b3va1t3","Type":"NodeParagraph","Properties":{"id":"20240920152521-b3va1t3","updated":"20240920152550"}},{"ID":"20240920152526-ihz1ymj","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240920152526-ihz1ymj","updated":"20240920152548"},"Children":[{"Type":"NodeText","Data":"Tomcat中间件"}]},{"ID":"20240920152603-32s4xte","Type":"NodeParagraph","Properties":{"id":"20240920152603-32s4xte","updated":"20240920152626"},"Children":[{"Type":"NodeText","Data":"1.cve 2017-12615通过put方法写文件"}]},{"ID":"20240920152633-w6juh1f","Type":"NodeParagraph","Properties":{"id":"20240920152633-w6juh1f","updated":"20240920152635"},"Children":[{"Type":"NodeText","Data":"Linux"}]},{"ID":"20240920152626-hfgjknn","Type":"NodeParagraph","Properties":{"id":"20240920152626-hfgjknn"}},{"ID":"20240920155820-93es2hi","Type":"NodeParagraph","Properties":{"id":"20240920155820-93es2hi"}},{"ID":"20240920155820-oj9aqow","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240920155820-oj9aqow","updated":"20240920155826"},"Children":[{"Type":"NodeText","Data":"Jboss中间件"}]},{"ID":"20240920155828-4k6y59r","Type":"NodeParagraph","Properties":{"id":"20240920155828-4k6y59r","updated":"20240920160125"},"Children":[{"Type":"NodeText","Data":"开源应用服务器，轻便简介，可以和Tomcat联合使用，还能集群部署"}]},{"ID":"20240920160125-7tkgoh0","Type":"NodeParagraph","Properties":{"id":"20240920160125-7tkgoh0","updated":"20240920160137"},"Children":[{"Type":"NodeText","Data":"1.反序列化漏洞2017-12149"}]},{"ID":"20240920160137-3bsix3n","Type":"NodeParagraph","Properties":{"id":"20240920160137-3bsix3n","updated":"20240920160139"},"Children":[{"Type":"NodeText","Data":"特征"}]},{"ID":"20240920160140-230yzjl","Type":"NodeParagraph","Properties":{"id":"20240920160140-230yzjl","updated":"20240920160143"},"Children":[{"Type":"NodeText","Data":"默认页面"}]},{"ID":"20240920160143-yq9ra6x","Type":"NodeParagraph","Properties":{"id":"20240920160143-yq9ra6x","updated":"20240920160149"},"Children":[{"Type":"NodeText","Data":"图标、log"}]},{"ID":"20240920160120-96xyzuh","Type":"NodeParagraph","Properties":{"id":"20240920160120-96xyzuh"}}]}